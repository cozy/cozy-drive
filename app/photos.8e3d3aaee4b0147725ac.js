!function(e){function t(t){for(var r,i,c=t[0],s=t[1],l=t[2],d=0,p=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={1:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(){return Promise.resolve()},i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;a.push([6,0]),n()}({0:function(e,t){},"0yyf":function(e,t,n){e.exports={"pho-sidebar":"pho-sidebar--1JZDr","pho-content":"pho-content--6vy4r","pho-content-wrapper":"pho-content-wrapper--1u34M",spin:"spin--OsM9y",shake:"shake--V0phk"}},1:function(e,t){},2:function(e,t){},"2OO4":function(e){e.exports=JSON.parse('{"Nav":{"photos":"Photos","albums":"Albums","shared":"Shared by me","trash":"Trash","btn-client":"Get Cozy Drive for desktop","btn-client-web":"Get Cozy","btn-client-mobile":"Get Cozy Drive on your mobile!","banner-txt-client":"Get Cozy Drive for Desktop and synchronise your files safely to make them accessible at all times.","banner-btn-client":"Download","link-client":"https://cozy.io/en/download/","link-client-desktop":"https://nuts.cozycloud.cc/download/channel/stable/","link-client-android":"https://play.google.com/store/apps/details?id=io.cozy.drive.mobile","link-client-ios":"https://itunes.apple.com/us/app/cozy-drive/id1224102389?mt=8","link-client-web":"https://cozy.io/fr/try-it?from=albumsharing"},"empty":{"timeline_photos_title":"You don\'t have any photos yet.","timeline_photos_text":"Click the \\"Upload\\" button to add photos.","albums_title":"You don\'t have any album yet.","albums_text":"Start by clicking \\"New album\\" to create your first album.","album_photos_title":"There is no photo in this album yet.","album_photos_text":"Start by clicking \\"Add photos to album\\" to add some.","shared_album_photos_title":"There is no photo in this album yet.","shared_album_photos_text":"Come back later"},"Error":{"albums_title":"An error occurred while retrieving the albums list. Please try again later.","album_photos_title":"An error occurred while retrieving the album\'s photos list. Please try again later.","timeline_photos_title":"An error occurred while retrieving the photos list. Please try again later.","public_album_error_title":"An error occurred while retrieving the photos list. Please try again later.","public_album_unshared_title":"Sorry, this link is no longer available.","public_album_unshared_text":"One lost, ten found... or just check out with the owner for help. This file might not be lost.","refresh":"Refresh now","generic":"An error occurred, please try again.","album_rename_abort":"The album name can not be empty."},"Toolbar":{"photo_upload":"Upload","album_new":"New album","album_delete":"Delete","album_quit":"Leave & delete shared album","album_download":"Download","more":"More","menu":{"select_items":"Select photos","photo_upload":"Upload photos","rename_album":"Rename album","album_delete":"Delete album","album_quit":"Leave & delete shared album","download_album":"Download album","add_photos":"Add photos to album"}},"loading":{"photos_indexing":"Your photos are currently being indexed. Please wait.","albums_indexing":"Your albums are currently being indexed. Please wait.","photos_fetching":"Loading","albums_fetching":"Loading","photos_upload":"Uploading"},"Board":{"load_more":"Load more photos","select_all":"Select all","unselect_all":"Unselect all"},"Alerter":{"photos":{"fetching_error":"An error occurred during photos fetching.","already_added_photo":"This album already contains this photo."}},"SelectionBar":{"selected_count":"item selected |||| items selected","delete":"Delete","trash":"Delete","album-add":"Add to album","album-remove":"Remove from album","download":"Download","close":"Close"},"Share":{"status":{"pending":"Pending","accepted":"Accepted","refused":"Refused","error":"Error","unregistered":"Error","mail-not-sent":"Error","revoked":"Error"},"type":{"one-way":"Can View (coming soon)","two-way":"Can Change"},"create-cozy":"Create my cozy"},"Albums":{"album_item_description":"%{smart_count} photo |||| %{smart_count} photos","album_item_shared_ro":"Shared (read only)","album_item_shared_rw":"Shared (read/write)","load_more":"Load more albums","add_photos":{"title":"Add to album","success":"Album %{name} has been updated with %{smart_count} photo. |||| Album %{name} has been updated with %{smart_count} photos.","error":{"generic":"An error occurred when updating the album, please try again.","reference":"Some photos has not been added to the album. Please check and try again.","response":{"Forbidden":"Application does not have permission to update albums."}}},"share":{"cta":"Share","title":"Share with others","details":{"title":"Sharing details","createdAt":"On %{date}","ro":"Read only","rw":"Read/write"},"sharedByMe":"Shared","sharedWithMe":"Shared with me","shareByLink":{"subtitle":"By public link","desc":"Anyone with the provided link can see and download your photos.","fetchFailed":"Woops! It seems your connectivity is limited, try again later when it gets better.","creating":"Creating your link...","copy":"Copy link","copied":"Link has been copied to clipboard","failed":"Unable to copy to clipboard"},"shareByEmail":{"title":"By email","subtitle":"By email","email":"email","emailPlaceholder":"Enter the email address or name of the recipient","send":"Send","genericSuccess":"You sent an invite to %{count} contacts.","success":"You sent an invite to %{email}.","comingsoon":"Coming soon! You will be able to share documents and photos in a single click with your family, your friends, and even your coworkers. Don\'t worry, we\'ll let you know when it\'s ready!"},"unshare":{"title":"Remove from album","success":"You removed this shared album from %{email}."},"sharingLink":{"title":"Link to share","copy":"Copy","copied":"Copied"},"whoHasAccess":{"title":"Who has access"},"protectedShare":{"title":"Coming soon!","desc":"Share anything by email with your family and friends!"},"close":"Close","gettingLink":"Getting your link...","error":{"generic":"An error occurred when creating the album share link, please try again.","revoke":"An error occurred when revoking the album share link, please try again."}},"create":{"panel_form":{"label":"Add a name to your new album","placeholder":"Untitled album","cancel":"Cancel","submit":"Create new album","update":"Add photos to album"},"inline_form":{"placeholder":"New album name","create_label":"Create a new album","create_button":"Create"},"success":"Album %{name} has been created with %{smart_count} photo. |||| Album %{name} has been created with %{smart_count} photos.","error":{"generic":"An error occurred when creating the album, please try again.","already_exists":"The album %{name} already exists, please pick another one.","name_missing":"You have to give a name to your album."}},"fetchAlbums":{"error":{"index_missing":"An albums index must be provided to fetch albums."}},"remove_photos":{"success":"The photo has been removed from album %{album_name}","error":{"generic":"An error occured while removing the photo, please try again."}},"remove_album":{"success":"Album %{name} was deleted.","error":{"generic":"An error occured while removing the album, please try again."}},"quit_album":{"success":"Album %{name} was deleted.","error":{"generic":"An error occured while leaving the album, please try again."}}},"Viewer":{"close":"Close","noviewer":{"title":"The viewer doesn\'t know how to read this type of file yet.","download":"Download this file","openWith":"Open with..."},"actions":{"download":"Download"},"loading":{"error":"This file could not be loaded. Do you have a working internet connection right now?","retry":"Retry"}},"destroyconfirmation":{"title":"Permanently delete this album?","cancel":"Cancel","delete":"Delete permanently","forbidden":"You won\'t be able to access this album or selection anymore.","eye":"Your photos won\'t be deleted.","link":"If you have shared it, people won\'t be able to access it."},"timeline":{"DeleteConfirm":{"title":"Delete this element? |||| Delete these elements?","trash":"It will be moved to the Trash. |||| They will be moved to the Trash.","restore":"You can still restore it whenever you want. |||| You can still restore them whenever you want.","shared":"If you have shared it, people won\'t be able to access it. |||| If you have shared them, people won\'t be able to access them.","related":"Some of the photos within the selection are related to an album. They will be removed from it if you proceed to trash them.","cancel":"Cancel","delete":"Remove"}},"UploadQueue":{"path_photos":"Photos","path_upload":"Uploaded from Cozy Photos","header":"Uploading %{smart_count} photo to Cozy Photos |||| Uploading %{smart_count} photos to Cozy Photos","header_mobile":"Uploading %{done} of %{total}","header_done":"Uploaded %{done} out of %{total} successfully","close":"close","item":{"pending":"Pending"},"alert":{"success":"%{smart_count} photo uploaded with success. |||| %{smart_count} photos uploaded with success.","success_conflicts":"%{smart_count} photo uploaded with %{conflictNumber} conflict(s). |||| %{smart_count} photos uploaded with %{conflictNumber} conflict(s).","errors":"Errors occurred during the photos upload."}},"quotaalert":{"title":"Your disk space is full :(","desc":"Please remove files, empty your trash or increase your disk space before uploading files again.","confirm":"OK","increase":"Increase your disk space"},"button":{"back":"Back"}}')},"2lpW":function(e,t,n){"use strict";n.d(t,"a",(function(){return De}));var r=n("pVnL"),o=n.n(r),a=n("QILm"),i=n.n(a),c=n("o0o1"),s=n.n(c),l=n("yXPU"),u=n.n(l),d=n("q1tI"),p=n.n(d),m=n("SH7X"),h=n("lwsE"),f=n.n(h),b=n("W8MJ"),y=n.n(b),v=n("PJYZ"),g=n.n(v),_=n("7W2i"),E=n.n(_),w=n("a1gu"),x=n.n(w),O=n("Nsbk"),k=n.n(O),j=n("lSNA"),C=n.n(j),S=n("buk/"),P=n("17x9"),A=n.n(P),R=n("0yyf"),z=n.n(R),D=n("jDpt"),N=n("eKCf"),T=n("t0Aa"),q=n.n(T),M=n("TSYQ"),U=n.n(M),I=n("zzwF"),L=n("y6ex"),F=n("1soK"),B=n("/NT0"),W=n("asgm"),Y=function(e){var t=e.label,n=e.inMenu,r=e.disabled,o=e.onUpload,a=e.className;return p.a.createElement(W.a,{accept:"image/*",className:U()(a,C()({},"".concat(q.a["c-btn"]),!n)),"data-testid":"upload-btn",disabled:r,multiple:!0,onChange:o,value:[]},p.a.createElement("span",null,!n&&p.a.createElement(L.a,{icon:F.a}),p.a.createElement("span",null,t)))};Y.propTypes={label:A.a.string.isRequired,disabled:A.a.bool,inMenu:A.a.bool,onUpload:A.a.func.isRequired,className:A.a.string.isRequired},Y.defaultProps={disabled:!1,inMenu:!1};var V=Y,G=n("SvPG"),H=function(e){var t=e.t,n=e.disabled,r=e.uploadPhotos,o=e.selectItems;return p.a.createElement(I.b,{disabled:n,position:"right",className:q.a["pho-toolbar-menu"],component:p.a.createElement(G.b,null)},p.a.createElement(I.a,{icon:p.a.createElement(L.a,{icon:F.a}),className:"u-hide--desk"},p.a.createElement(V,{onUpload:r,disabled:n,label:t("Toolbar.menu.photo_upload"),inMenu:!0,className:U()("u-hide--tablet",q.a["pho-action-upload"])})),p.a.createElement("hr",{className:"u-hide--desk"}),p.a.createElement(I.a,{onSelect:o,icon:p.a.createElement(L.a,{icon:B.a})},t("Toolbar.menu.select_items")))};H.propTypes={disabled:A.a.bool,uploadPhotos:A.a.func.isRequired,selectItems:A.a.func.isRequired,t:A.a.func.isRequired};var Q=function(e){var t=e.t,n=e.disabled,r=void 0!==n&&n,o=e.uploadPhotos,a=e.selectItems;return p.a.createElement("div",{className:q.a["pho-toolbar"],role:"toolbar"},p.a.createElement(V,{className:"u-hide--mob",onUpload:o,disabled:r,label:t("Toolbar.photo_upload")}),p.a.createElement(H,{t:t,disabled:r,uploadPhotos:o,selectItems:a}))};Q.propTypes={disabled:A.a.bool,uploadPhotos:A.a.func.isRequired,selectItems:A.a.func.isRequired,t:A.a.func.isRequired};var Z=Q,J=n("2sk9"),K=n.n(J),X=n("e5eR"),$=n("KXWi"),ee=function(e){var t=e.t,n=e.count,r=e.confirm,o=e.onClose,a=["trash","restore","shared"];!0===e.related&&a.push("related");var i=a.map((function(e){return p.a.createElement("p",{className:U()(K.a["fil-confirm-text"],K.a["icon-".concat(e)]),key:"key_delet_".concat(e)},t("timeline.DeleteConfirm.".concat(e),n))}));return p.a.createElement(X.a,{open:!0,onClose:o,title:t("timeline.DeleteConfirm.title",n),content:i,actions:p.a.createElement(p.a.Fragment,null,p.a.createElement($.c,{theme:"secondary",onClick:o,label:t("timeline.DeleteConfirm.cancel")}),p.a.createElement($.c,{theme:"danger",label:t("timeline.DeleteConfirm.delete"),onClick:r}))})},te=n("TtgU"),ne=n("BDb7"),re=n("SRpc"),oe=n("q/Uw"),ae=n("z6Q1"),ie="".concat(ae.b,"/photos"),ce="".concat(ae.b,"/photos/upload"),se=("".concat(ae.b,"/photos/mobile"),function(){var e=u()(s.a.mark((function e(t,n){var r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.collection(ae.c).findReferencedBy({_type:ae.b,_id:n});case 2:return r=e.sent,o=r.included,e.abrupt("return",o.filter((function(e){return!1===/^\/\.cozy_trash/.test(e.attributes.path)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),le=function(){var e=u()(s.a.mark((function e(t,n,r){var o,a,i,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(t,r);case 2:if(!(o=e.sent).length){e.next=7;break}return e.abrupt("return",o[0]);case 7:return a=t.collection(ae.c),e.next=10,a.ensureDirectoryExists(n);case 10:return i=e.sent,e.next=13,a.addReferencesTo({_id:r,_type:ae.b},[{_id:i}]);case 13:return e.next=15,a.get(i);case 15:return c=e.sent,l=c.data,e.abrupt("return",l);case 18:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var o=k()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return x()(this,n)}}var me=function(){var e=u()(s.a.mark((function e(t,n){var r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(t,ce);case 2:if(!((r=e.sent).length>0)){e.next=7;break}return e.abrupt("return",r[0]._id);case 7:return e.next=9,le(t,"/".concat(n("UploadQueue.path_photos")),ie);case 9:return e.next=11,le(t,"/".concat(n("UploadQueue.path_photos"),"/").concat(n("UploadQueue.path_upload")),ce);case 11:return o=e.sent,e.abrupt("return",o._id);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),he=function(e){E()(n,e);var t=pe(n);function n(){var e;f()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),C()(g()(e),"state",{showAddAlbumModal:!1}),C()(g()(e),"showAddAlbumModal",(function(){e.setState((function(e){return de(de({},e),{},{showAddAlbumModal:!0})}))})),C()(g()(e),"hideAddAlbumModal",(function(){e.setState((function(e){return de(de({},e),{},{showAddAlbumModal:!1})}))})),C()(g()(e),"uploadPhotos",function(){var t=u()(s.a.mark((function t(n){var r,o,a,i,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.uploadPhoto,o=e.props,a=o.client,i=o.t,t.next=4,me(a,i);case 4:c=t.sent,e.dispatch(Object(ne.b)(n,(function(e){return r(e,c)})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),C()(g()(e),"downloadPhotos",(function(t){e.props.client.collection("io.cozy.files").downloadArchive(t.map((function(e){return e._id})),"selected")})),C()(g()(e),"closeModal",(function(){e.setState({displayModal:!1,selected:null,clearSelection:null})})),C()(g()(e),"showDeleteConfirm",(function(){var t=e.state,n=t.selected,r=t.clearSelection;return p.a.createElement(ee,{t:e.props.t,count:n.length,related:Object(re.f)(n),onClose:e.closeModal,confirm:u()(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.map((function(t){return e.props.deletePhoto(t)}))).then(r);case 2:e.closeModal();case 3:case"end":return t.stop()}}),t)})))})})),C()(g()(e),"deletePhotos",(function(t,n){e.setState({displayModal:!0,selected:t,clearSelection:n})})),e}return y()(n,[{key:"dispatch",value:function(e){return this.context.store.dispatch(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.lists,o=t.fetchStatus,a=t.hasMore,i=t.fetchMore,c=t.lastFetch;return p.a.createElement(oe.a,{actions:function(t){return{"album-add":e.showAddAlbumModal,download:e.downloadPhotos,trash:function(n){return e.deletePhotos(n,t.clear)}}}},(function(t,s,l){return p.a.createElement("div",{"data-testid":"timeline-pho-content-wrapper",className:z.a["pho-content-wrapper"]},p.a.createElement(N.a,{viewName:"photos"},p.a.createElement(Z,{disabled:s,uploadPhotos:e.uploadPhotos,selectItems:l.show,t:n})),p.a.createElement(D.a,null,e.state.displayModal&&e.showDeleteConfirm(),e.state.showAddAlbumModal&&p.a.createElement(re.b,{onDismiss:e.hideAddAlbumModal,onSuccess:l.clear,photos:t}),p.a.createElement(te.a,{lists:r,selected:t,photosContext:"timeline",showSelection:s,onPhotoToggle:l.toggle,onPhotosSelect:l.select,onPhotosUnselect:l.unselect,fetchStatus:o,hasMore:a,fetchMore:i,lastFetch:c})),e.renderViewer(e.props.children))}))}},{key:"renderViewer",value:function(e){var t=this;return e?p.a.Children.map(e,(function(e){return p.a.cloneElement(e,{photos:t.props.data||[]})})):null}}]),n}(d.Component);C()(he,"contextTypes",{store:A.a.object.isRequired});var fe=Object(S.translate)()(Object(m.withClient)(he)),be=n("J4zp"),ye=n.n(be),ve=n("NAv5"),ge=function(e,t,n){var r=t.substr(0,10).split("-"),o=ye()(r,3),a=o[0],i=o[1],c=o[2],s=t.length>10?t.substr(11,8).split(":"):[0,0,0],l=ye()(s,3),u=l[0],d=l[1],p=l[2];return e(new Date(a,i-1,c,u,d,p),n)},_e=function(e,t){return ge(e,t,"HH")},Ee=function(e,t){return ge(e,t,"DD MMMM")+we(e,t)},we=function(e,t){return Object(ve.isThisYear)(t)?"":ge(e,t," YYYY")},xe=function(e,t,n){var r=ge(e,t),o=ge(e,n);return 0===Object(ve.differenceInCalendarDays)(r,o)},Oe=["data"],ke=["selection"],je=["data"],Ce=function(e){return e.find("io.cozy.files").where({class:"image","metadata.datetime":{$gt:null}}).partialIndex({trashed:!1}).indexFields(["class","metadata.datetime"]).select(["dir_id","name","size","updated_at","metadata","metadata.datetime","trashed","class"]).sortBy([{class:"desc"},{"metadata.datetime":"desc"}]).include(["albums"])},Se=function(e){return{uploadPhoto:(t=u()(s.a.mark((function t(n,r){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.mutate({mutationType:"UPLOAD_PHOTO",execute:function(){var t=u()(s.a.mark((function t(){var o,a,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.chrome){t.next=10;break}return t.next=3,e.getStackClient().fetchJSON("GET","/settings/disk-usage");case 3:if(o=t.sent,!(a=o.data).attributes.quota){t.next=10;break}if(!(parseInt(a.attributes.used)+parseInt(n.size)>parseInt(a.attributes.quota))){t.next=10;break}throw(i=new Error("Payload Too Large")).status=413,i;case 10:return t.abrupt("return",e.collection("io.cozy.files").createFile(n,{dirId:r}));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}));case 1:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)}),deletePhoto:function(t){return e.destroy(t)}};var t},Pe=function(e,t){if(e.period){var n=e.period.start,r=e.period.end;return function(e,t,n){var r=ge(e,t),o=ge(e,n);return 0===Object(ve.differenceInCalendarMonths)(r,o)}(t,r,n)?xe(t,r,n)?Ee(t,n):function(e,t){return ge(e,t,"DD")}(t,n)+"-"+Ee(t,r):Ee(t,n)+" - "+Ee(t,r)}return Ee(t,e.name)},Ae=function(e,t,n,r){if(n.album&&(t>0&&xe(r,e[t-1],e[t])||t<e.length-1&&xe(r,e[t],e[t+1]))){var o=n.album.period.start,a=n.album.period.end,i=n.title+" · "+_e(r,o)+"h";return function(e,t,n){var r=ge(e,t),o=ge(e,n);return 0===Object(ve.differenceInHours)(r,o)}(r,a,o)||(i+="-"+_e(r,a)+"h"),i}return n.title},Re=function(e,t,n){return Object.keys(e).find((function(r){if(e[r].album){var o=e[r].album.period.start,a=e[r].album.period.end;return(i=t,c=o,Object(ve.compareAsc)(i,c)>=0&&function(e,t){return Object(ve.compareAsc)(e,t)<=0}(t,a))||xe(n,t,a)}return xe(n,t,r);var i,c}))},ze=function(e,t){var n={},r=[];e.forEach((function(e){var o=(e.albums?e.albums.data:[]).find((function(e){return e.auto}));if(o){var a=o.name;if(!n.hasOwnProperty(a)){var i=Pe(o,t);n[a]={photos:[],title:i,album:o}}n[a].photos.push(e)}else r.push(e)})),r.forEach((function(e){var r=e.metadata&&e.metadata.datetime?e.metadata.datetime:e.created_at,o=Re(n,r,t);if(o)n[o].photos.push(e);else{var a=function(e,t){return ge(e,t,"YYYY-MM-DD")}(t,r);n[a]={title:Ee(t,r),photos:[e]}}}));var o=Object.keys(n);return o.sort((function(e,t){return new Date(t).getTime()-new Date(e).getTime()})),o.map((function(e,r){return{title:Ae(o,r,n[e],t),photos:n[e].photos}}))},De=(t.b=Object(S.translate)()((function(e){return p.a.createElement(m.Query,{query:Ce,as:"timeline",mutations:Se},(function(t,n){var r=t.data,a=i()(t,Oe);return p.a.createElement(fe,o()({lists:r?ze(r,e.f):[],data:r},n,a,e))}))})),Object(S.translate)()((function(e){var t=e.selection,n=i()(e,ke);return p.a.createElement(m.Query,{query:Ce},(function(e){var r=e.data,a=i()(e,je);return p.a.createElement(te.a,o()({lists:r?ze(r,n.f):[],photosContext:"timeline",onPhotoToggle:t.toggle,onPhotosSelect:t.select,onPhotosUnselect:t.unselect},a,n))}))})))},"2sk9":function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--b7sc9","CozyTheme--normal":"CozyTheme--normal--1PFeN","u-card":"u-card--1LMvZ","u-debug":"u-debug--Dvf4q","u-shake":"u-shake--301R8",shake:"shake--Hx9aG","u-elevation-1":"u-elevation-1--_bAw8","u-filter-gray-100":"u-filter-gray-100--1mFsr","u-o-100":"u-o-100--1l6_J","u-o-90":"u-o-90--Vl2PX","u-o-80":"u-o-80--1iZh6","u-o-70":"u-o-70--1Orn8","u-o-60":"u-o-60--29A2S","u-o-50":"u-o-50--1vWRz","u-o-40":"u-o-40--23WHb","u-o-30":"u-o-30--C42_r","u-o-20":"u-o-20--Wp1zJ","u-o-10":"u-o-10--1yTAG","u-o-05":"u-o-05--1IKgP","u-o-025":"u-o-025--2gpCh","u-o-0":"u-o-0--2YnvF","fil-confirm-text":"fil-confirm-text--3OV-5","icon-trash":"icon-trash--2L617","icon-restore":"icon-restore--qTvX6","icon-shared":"icon-shared--2ytpg","icon-related":"icon-related--3HRWq","icon-eye":"icon-eye--2EIWz","icon-link":"icon-link--2hb-A","icon-forbidden":"icon-forbidden--23UiV",spin:"spin--3SvvM"}},3:function(e,t){},4:function(e,t){},"59mS":function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--2YC9P","CozyTheme--normal":"CozyTheme--normal--11Mk6","u-card":"u-card--2A4F_","u-debug":"u-debug--239uE","u-shake":"u-shake--jsFDP",shake:"shake--3-Vkv","u-elevation-1":"u-elevation-1--2nz2m","u-filter-gray-100":"u-filter-gray-100--3z1C_","u-o-100":"u-o-100--3NgxQ","u-o-90":"u-o-90--1HDpO","u-o-80":"u-o-80--1I9nb","u-o-70":"u-o-70--3QV-j","u-o-60":"u-o-60--1QLxy","u-o-50":"u-o-50--jArI6","u-o-40":"u-o-40--3Q8vH","u-o-30":"u-o-30--3LyB0","u-o-20":"u-o-20--3Aqqq","u-o-10":"u-o-10--3v5K_","u-o-05":"u-o-05--2aGws","u-o-025":"u-o-025--2bvm8","u-o-0":"u-o-0--h266O",spin:"spin--2CdRK"}},"5ZYL":function(e,t,n){e.exports={"pho-loading":"pho-loading--2vILC","pho-empty":"pho-empty--2ISCA"}},6:function(e,t,n){n("55Il"),e.exports=n("oGE2")},"6qED":function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--1b8qa","CozyTheme--normal":"CozyTheme--normal--1C24e","pho-album-list":"pho-album-list--3W0t6","pho-album-list--thumbnails":"pho-album-list--thumbnails--3FASv","pho-album":"pho-album--nBuXk","pho-album-link":"pho-album-link--1J30Z","pho-album-photo-item":"pho-album-photo-item--18xZx","pho-album-title":"pho-album-title--1N0Rf","pho-album-description":"pho-album-description--3z6S7","pho-album-shared":"pho-album-shared--2T6ed","pho-album-list--selectable":"pho-album-list--selectable--1eSpV","pho-album-link--disabled":"pho-album-link--disabled--309dC"}},AzIT:function(e,t,n){e.exports={"coz-banner-client":"coz-banner-client--xEL17"}},BDb7:function(e,t,n){"use strict";n.d(t,"a",(function(){return H})),n.d(t,"b",(function(){return te})),n.d(t,"g",(function(){return ne})),n.d(t,"f",(function(){return se})),n.d(t,"d",(function(){return le})),n.d(t,"e",(function(){return ue}));var r=n("o0o1"),o=n.n(r),a=n("yXPU"),i=n.n(a),c=n("RIqP"),s=n.n(c),l=n("q1tI"),u=n.n(l),d=n("fvjX"),p=n("OTOu"),m=n("67rm"),h=n("lwsE"),f=n.n(h),b=n("W8MJ"),y=n.n(b),v=n("PJYZ"),g=n.n(v),_=n("7W2i"),E=n.n(_),w=n("a1gu"),x=n.n(w),O=n("Nsbk"),k=n.n(O),j=n("lSNA"),C=n.n(j),S=n("TSYQ"),P=n.n(S),A=n("Vg22"),R=n("buk/"),z=n("V2U0"),D=n("y6ex"),N=n("yoMi"),T=n("JL3L"),q=n("s2wB"),M=n("hE6O"),U=n("OjRq"),I=n("lEMr"),L=n.n(I);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k()(e);if(t){var o=k()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return x()(this,n)}}var B=Object(R.translate)()((function(e){return u.a.createElement("span",{className:L.a["item-pending"]},e.t("UploadQueue.item.pending"))})),W=Object(R.translate)()((function(e){var t,n,r=e.file,o=e.status,a=U.b.splitFilename(r),i=a.filename,c=a.extension;switch(o){case"loading":n=u.a.createElement(z.b,{className:"u-ml-half",color:N.dodgerBlue});break;case"cancel":n=u.a.createElement(D.a,{className:"u-ml-half u-warning",icon:T.a});break;case"failed":case"conflict":case"network":n=u.a.createElement(D.a,{className:"u-ml-half u-warning",icon:q.a});break;case"loaded":n=u.a.createElement(D.a,{className:"u-ml-half u-success",icon:M.a});break;case"pending":default:n=u.a.createElement(B,null)}return u.a.createElement("div",{className:P()(L.a["upload-queue-item"],(t={},C()(t,L.a["upload-queue-item--done"],"loaded"===o),C()(t,L.a["upload-queue-item--error"],"failed"===o||"conflict"===o),t))},u.a.createElement("div",{className:P()(L.a["item-cell"],L.a["item-file"],L.a["item-image"])},u.a.createElement("div",null,i,c&&u.a.createElement("span",{className:L.a["item-ext"]},c))),u.a.createElement("div",{className:L.a["item-status"]},n))})),Y=Object(R.translate)()((function(e){var t=e.t,n=e.total,r=e.done;return u.a.createElement("div",{className:L.a["upload-queue-header-inner"]},u.a.createElement("span",{className:"coz-desktop"},t("UploadQueue.header",{smart_count:n})),u.a.createElement("span",{className:"u-hide--desk"},t("UploadQueue.header_mobile",{done:r,total:n})))})),V=Object(R.translate)()((function(e){var t=e.t,n=e.total,r=e.successful,o=e.onClose;return u.a.createElement("div",{"data-testid":"upload-queue-success",className:L.a["upload-queue-header-inner"]},u.a.createElement("span",null,t("UploadQueue.header_done",{done:r,total:n})),u.a.createElement("button",{className:P()(L.a["btn-close"]),onClick:o},t("UploadQueue.close")))})),G=function(e){E()(n,e);var t=F(n);function n(){var e;f()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),C()(g()(e),"state",{collapsed:!1}),C()(g()(e),"toggleCollapsed",(function(){e.setState((function(e){return{collapsed:!e.collapsed}}))})),e}return y()(n,[{key:"render",value:function(){var e,t=this.props,n=t.queue,r=t.doneCount,o=t.successCount,a=t.purgeQueue,i=this.state.collapsed;return u.a.createElement("div",{"data-testid":"upload-queue",className:P()(L.a["upload-queue"],(e={},C()(e,L.a["upload-queue--visible"],0!==n.length),C()(e,L.a["upload-queue--collapsed"],i),e))},u.a.createElement("h4",{className:L.a["upload-queue-header"],onDoubleClick:this.toggleCollapsed},r<n.length?u.a.createElement(Y,{total:n.length,done:r}):u.a.createElement(V,{total:n.length,successful:o,onClose:a})),u.a.createElement("progress",{className:L.a["upload-queue-progress"],value:r,max:n.length}),u.a.createElement("div",{className:L.a["upload-queue-content"]},u.a.createElement("div",{className:L.a["upload-queue-list"]},n.map((function(e,t){return u.a.createElement(W,{file:e.file,status:e.status,key:"file_".concat(t)})})))))}}]),n}(l.Component),H=Object(R.translate)()(Object(A.connect)((function(e){return{queue:se(e),doneCount:le(e).length,successCount:ue(e).length}}),(function(e){return{purgeQueue:function(){return e(ne())}}}))(G)),Q=n("Yo2A"),Z=n("owKQ"),J=function(e){var t=e.onClose;return u.a.createElement(Z.a,{onClose:t})},K=function(e){return{file:e,status:"pending"}},X=function(e){switch(e.type){case"UPLOAD_FILE":return"loading";case"RECEIVE_UPLOAD_SUCCESS":return"loaded";default:return e.status}},$=function(e,t){return Object.assign({},e,{status:X(t)})},ee=(t.c=Object(d.combineReducers)({queue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TO_UPLOAD_QUEUE":return[].concat(s()(e),s()(t.files.map((function(e){return K(e)}))));case"PURGE_UPLOAD_QUEUE":return[];case"UPLOAD_FILE":case"RECEIVE_UPLOAD_SUCCESS":case"RECEIVE_UPLOAD_ERROR":return e.map((function(e){return e.file.name!==t.file.name?e:$(e,t)}));default:return e}}}),function e(t){return function(){var n=i()(o.a.mark((function n(r,a){var i,c,s;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=se(a()).find((function(e){return"pending"===e.status}))){n.next=3;break}return n.abrupt("return",r(re()));case 3:return c=i.file,n.prev=4,r({type:"UPLOAD_FILE",file:c}),n.next=8,t(c);case 8:r({type:"RECEIVE_UPLOAD_SUCCESS",file:c}),n.next=18;break;case 11:n.prev=11,n.t0=n.catch(4),p.a.log(n.t0),s={409:"conflict",413:"quota"}[n.t0.status]||/Failed to fetch$/.exec(n.t0.toString())||"failed",r({type:"RECEIVE_UPLOAD_ERROR",file:c,status:"conflict"===s?"conflict":"failed"}),"quota"===s&&r(Object(Q.d)(u.a.createElement(J,{t:function(){}})));case 18:r(e(t));case 19:case"end":return n.stop()}}),n,null,[[4,11]])})));return function(e,t){return n.apply(this,arguments)}}()}),te=function(e,t){return function(){var n=i()(o.a.mark((function n(r){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r({type:"ADD_TO_UPLOAD_QUEUE",files:e}),r(ee(t));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},ne=function(){return{type:"PURGE_UPLOAD_QUEUE"}},re=function(){return function(e,t){var n=se(t()),r=ae(n),o=ie(n),a=ce(n);r.length||o.length?r.length&&!o.length?m.a.info("UploadQueue.alert.success_conflicts",{smart_count:a.length,conflictNumber:r.length}):m.a.error("UploadQueue.alert.errors"):m.a.success("UploadQueue.alert.success",{smart_count:a.length})}},oe=function(e,t){return e.filter((function(e){return e.status===t}))},ae=function(e){return oe(e,"conflict")},ie=function(e){return oe(e,"failed")},ce=function(e){return oe(e,"loaded")},se=function(e){return e.upload.queue},le=function(e){return se(e).filter((function(e){return"pending"!==e.status}))},ue=function(e){return ce(se(e))}},"C/eS":function(e,t,n){e.exports={"pho-panel-form":"pho-panel-form--1S6en","coz-form":"coz-form--cCo_s","coz-form-group":"coz-form-group--1I069","coz-form-desc":"coz-form-desc--3FnDz","coz-form-label":"coz-form-label--385WH","coz-form-label--error":"coz-form-label--error--1Kr_k","coz-form-errors":"coz-form-errors--1RCYk",error:"error--3qEb3","CozyTheme--inverted":"CozyTheme--inverted--1gTN-","CozyTheme--normal":"CozyTheme--normal--1I94S","pho-panel":"pho-panel--vFzlq","pho-panel-header":"pho-panel-header--2aCpb","pho-panel-footer":"pho-panel-footer--2Ynjt","pho-panel-controls":"pho-panel-controls--1UDSQ","pho-panel-content":"pho-panel-content--2OXQJ","pho-panel-wrap":"pho-panel-wrap--1OkG3",spin:"spin--t2Bmx",shake:"shake--2MjHG"}},D575:function(e,t,n){e.exports={"coz-select-album":"coz-select-album--20TzS"}},FKqX:function(e){e.exports=JSON.parse('{"promoteDesktop":{"isActivated":true}}')},"G0/2":function(e,t,n){var r={"./en.json":"6wRk","./fr.json":"wNxD"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="G0/2"},Gofk:function(e,t,n){var r={"./en":"2OO4","./en.json":"2OO4"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="Gofk"},IFYe:function(e,t,n){"use strict";var r=n("9jFK");n("ZsPO");t.a=r},KOJc:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("pVnL"),o=n.n(r),a=n("q1tI"),i=n.n(a),c=n("buk/"),s=n("GoJ1"),l=n("o+ty"),u=n("46CF"),d=n("7Zso"),p=function(e){return i.a.createElement("svg",o()({viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),i.a.createElement("path",{opacity:"0.34",fillRule:"evenodd",clipRule:"evenodd",d:"M12.9657 1C13.5206 1 14.2876 1.3125 14.6803 1.6995L16 3H30.0059C31.1072 3 32 3.89498 32 4.997V27.003C32 28.1059 31.1107 29 29.9983 29H2.00174C0.896211 29 0 28.1001 0 27.0088V1.99653C0 1.44616 0.448999 1 1.00472 1H12.9657Z",fill:"#297EF2"}),i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 1C0.447715 1 0 1.44772 0 2V6C0 6.55228 0.447716 7 1 7H13.5858C13.851 7 14.1054 6.89464 14.2929 6.70711L15.7071 5.29289C15.8946 5.10536 16.149 5 16.4142 5H32C32 3.89543 31.1046 3 30 3H16.4142C16.149 3 15.8946 2.89464 15.7071 2.70711L14.2929 1.29289C14.1054 1.10536 13.851 1 13.5858 1H1ZM10 15.9954V24.0046C10 24.5543 10.4558 25 11.0025 25H20.9975C21.5512 25 22 24.5443 22 24.0046V15.9954C22 15.4457 21.5561 15 21 15H20V13C20 10.794 18.2053 9 16 9C13.794 9 12 10.794 12 13V15H11C10.4477 15 10 15.4557 10 15.9954ZM16 11C14.8968 11 14 12.1215 14 13.5V15H18V13.5C18 12.1215 17.1028 11 16 11ZM17.5 19C17.5 18.172 16.8265 17.5 16 17.5C15.172 17.5 14.5 18.172 14.5 19C14.5 19.552 14.803 20.032 15.25 20.29V22.75C15.25 23.1625 15.586 23.5 16 23.5C16.4125 23.5 16.75 23.1625 16.75 22.75V20.29C17.1955 20.032 17.5 19.552 17.5 19Z",fill:"#297EF2"}))},m=n("lJfM"),h=n.n(m),f={drive:l.a,encrypted:p,photos:d.a,trash:u.a},b=function(e){var t=e.type,n=e.canUpload,r=e.localeKey,o=Object(c.useI18n)().t;return i.a.createElement(s.a,{"data-testid":"empty-folder",icon:f[t],title:o(r?"empty.".concat(r,"_title"):"empty.title"),text:r&&o("empty.".concat(r,"_text"))||n&&o("empty.text"),className:h.a.empty})},y=function(e){return i.a.createElement(b,o()({type:"photos"},e))}},NqoY:function(e,t,n){"use strict";var r=n("lwsE"),o=n.n(r),a=n("W8MJ"),i=n.n(a),c=n("7W2i"),s=n.n(c),l=n("a1gu"),u=n.n(l),d=n("Nsbk"),p=n.n(d),m=n("z6Q1"),h=n("Le8U"),f=n("SH7X");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u()(this,n)}}var y=function(e){s()(n,e);var t=b(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,[{key:"data",get:function(){var e=this,t=this.target.relationships.referenced_by.data;return t?t.map((function(t){return e.get(t.type,t.id)})).filter(Boolean):[]}}],[{key:"query",value:function(e,t,n){if(!e.relationships||!e.relationships.referenced_by||!e.relationships.referenced_by.data)return null;var r=e.relationships.referenced_by.data.filter((function(e){return e.type===n.doctype})).map((function(e){return e.id}));return new f.QueryDefinition({doctype:n.doctype,ids:r})}}]),n}(f.HasMany);t.a={albums:{doctype:m.a,attributes:{name:{type:"string"}},relationships:{photos:{type:"has-many",doctype:m.c}}},files:{doctype:m.c,relationships:{albums:{type:y,doctype:m.a}}},contacts:{doctype:h.Contact.doctype}}},OTOu:function(e,t,n){"use strict";var r=n("btPC"),o=n.n(r),a=o()("cozy-".concat("photos"));o.a.enable(),o.a.suggest.allow("cozy-".concat("photos"),"log"),o.a.suggest.allow("cozy-".concat("photos"),"info"),t.a=a},OjRq:function(e,t,n){"use strict";n.d(t,"b",(function(){return r.CozyFile})),n.d(t,"c",(function(){return r.Group})),n.d(t,"a",(function(){return b}));var r=n("Le8U"),o=n("lwsE"),a=n.n(o),i=n("W8MJ"),c=n.n(i),s=n("7W2i"),l=n.n(s),u=n("a1gu"),d=n.n(u),p=n("Nsbk"),m=n.n(p),h=n("FiiU");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var b=function(e){l()(n,e);var t=f(n);function n(){return a()(this,n),t.apply(this,arguments)}return c()(n,null,[{key:"getInitials",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(n.isContact(e))return Object(h.getInitials)(e);var r=e.public_name||e.name||e.email;return r&&r[0].toUpperCase()||t}},{key:"getDisplayName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return n.isContact(e)?Object(h.getDisplayName)(e):e.public_name||e.name||e.email||t}}]),n}(r.Contact)},RPnM:function(e,t,n){"use strict";var r=n("lwsE"),o=n.n(r),a=n("W8MJ"),i=n.n(a),c=n("7W2i"),s=n.n(c),l=n("a1gu"),u=n.n(l),d=n("Nsbk"),p=n.n(d),m=n("kKu1"),h=n.n(m),f=n("q1tI"),b=n.n(f),y=n("KXWi"),v=n("V2U0"),g=n("yoMi");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u()(this,n)}}var E=function(e){s()(n,e);var t=_(n);function n(e){var r;return o()(this,n),(r=t.call(this,e)).state={fetching:!1},r}return i()(n,[{key:"handleClick",value:function(){var e=this;this.setState({fetching:!0}),this.props.onClick().then((function(){return e.setState({fetching:!1})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.width,o=void 0===r?"100%":r,a=this.state.fetching;return b.a.createElement("div",{style:{width:o},className:h.a["pho-list-morebutton"]},a&&b.a.createElement(y.a,{disabled:!0,theme:"secondary",label:b.a.createElement(v.b,{color:g.dodgerBlue,nomargin:!0})}),!a&&b.a.createElement(y.a,{theme:"secondary",onClick:function(){return e.handleClick()},label:n}))}}]),n}(f.Component);t.a=E},SRpc:function(e,t,n){"use strict";n.d(t,"a",(function(){return bt})),n.d(t,"d",(function(){return _t})),n.d(t,"e",(function(){return Ot})),n.d(t,"c",(function(){return wt})),n.d(t,"b",(function(){return Et})),n.d(t,"f",(function(){return kt}));var r=n("QILm"),o=n.n(r),a=n("pVnL"),i=n.n(a),c=n("RIqP"),s=n.n(c),l=n("o0o1"),u=n.n(l),d=n("yXPU"),p=n.n(d),m=n("q1tI"),h=n.n(m),f=n("dtw8"),b=n("SH7X"),y=n("67rm"),v=n("lwsE"),g=n.n(v),_=n("W8MJ"),E=n.n(_),w=n("7W2i"),x=n.n(w),O=n("a1gu"),k=n.n(O),j=n("Nsbk"),C=n.n(j),S=n("0yyf"),P=n.n(S),A=n("buk/"),R=n("TSYQ"),z=n.n(R),D=n("KXWi"),N=n("zzwF"),T=n("y6ex"),q=n("YJMV"),M=n("SvPG"),U=n("t0Aa"),I=n.n(U),L=function(e){var t=e.t,n=e.router;return h.a.createElement("div",{"data-testid":"pho-toolbar-albums",className:I.a["pho-toolbar"],role:"toolbar"},h.a.createElement("div",{className:"u-hide--mob"},h.a.createElement(D.b,{"data-testid":"album-add",theme:"secondary",href:"#/albums/new",icon:q.a,label:t("Toolbar.album_new")})),h.a.createElement(N.b,{className:z()(I.a["pho-toolbar-menu"],"u-hide--desk"),component:h.a.createElement(M.b,null),position:"right"},h.a.createElement(N.a,{onSelect:function(){return n.push("/albums/new")},icon:h.a.createElement(T.a,{icon:q.a})},t("Toolbar.album_new"))))},F=n("6qED"),B=n.n(F),W=n("jDpt"),Y=n("KOJc"),V=n("RPnM"),G=n("6se/"),H=n("H/9E"),Q=n("AJ6E");function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var o=C()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k()(this,n)}}var J=Object(f.g)((function(e){var t=e.router,n=e.album,r=e.image,o=e.title,a=e.desc,i=t.location.pathname;return h.a.createElement(f.a,{to:"".concat(i,"/").concat(n._id),className:B.a["pho-album-link"]},r,o,a)})),K=function(e){var t=e.album,n=e.image,r=e.title,o=e.desc,a=e.onClick;return e.disabled?h.a.createElement("div",{className:z()(B.a["pho-album-link"],B.a["pho-album-link--disabled"])},n,h.a.createElement("div",null,r,o)):h.a.createElement("div",{onClick:function(){return a(t)},className:B.a["pho-album-link"]},n,h.a.createElement("div",null,r,o))},X=Object(A.translate)()((function(e){var t=e.t,n=e.photoCount,r=e.album;return h.a.createElement("h4",{className:B.a["pho-album-description"]},h.a.createElement(H.a,{docId:r.id,className:B.a["pho-album-shared"],xsmall:!0}),h.a.createElement(Q.a,{docId:r.id},(function(e){var r=e.isSharedWithMe,o=e.isSharedByMe,a=e.hasWriteAccess;return h.a.createElement("span",null,t("Albums.album_item_description",{smart_count:n}),(r||o)&&" - ".concat(t("Albums.album_item_shared_".concat(a?"rw":"ro"))))})))})),$=function(e){x()(n,e);var t=Z(n);function n(){return g()(this,n),t.apply(this,arguments)}return E()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.album,r=e.shared,o=void 0===r?{}:r,a=e.onClick,i=e.thumbnail,c=o.readOnly,s=n.photos.data[0]||null,l=s?h.a.createElement(G.a,{file:s,linkType:"small",render:function(e){return h.a.createElement("img",{src:e,className:B.a["pho-album-photo-item"],alt:"".concat(n.name," album cover")})}}):h.a.createElement("div",{className:B.a["pho-album-photo-item"]}),u=h.a.createElement(X,{t:t,album:n,shared:o,thumbnail:i,photoCount:n.photos.count}),d=h.a.createElement("h2",{className:B.a["pho-album-title"]},n.name);return h.a.createElement("div",{"data-testid":"pho-album","data-test-name":n.name,className:B.a["pho-album"]},a?h.a.createElement(K,{album:n,image:l,title:d,desc:u,onClick:a,disabled:c}):h.a.createElement(J,{album:n,image:l,title:d,desc:u}))}}]),n}(m.Component),ee=function(e,t){return new Date(t.created_at||null)-new Date(e.created_at||null)},te=Object(A.translate)()((function(e){var t=e.data,n=e.hasMore,r=e.fetchMore,o=e.t;return 0===t.length?h.a.createElement(Y.a,{localeKey:"albums"}):h.a.createElement(W.a,null,h.a.createElement("div",{className:B.a["pho-album-list"]},t.sort(ee).map((function(e){return h.a.createElement($,{album:e,key:e.id})})),n&&h.a.createElement(V.a,{label:o("Albums.load_more"),onClick:r})))})),ne=n("ZFPb"),re=n("SvWF"),oe=n("eKCf");function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var o=C()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k()(this,n)}}var ie=function(e){var t=e.list,n=t.fetchStatus;return t.lastFetch||"pending"!==n&&"loading"!==n?"failed"===n?h.a.createElement(re.a,{errorType:"albums"}):h.a.createElement(te,t):h.a.createElement(ne.a,{loadingType:"albums_fetching"})},ce=function(e){x()(n,e);var t=ae(n);function n(){return g()(this,n),t.apply(this,arguments)}return E()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.router;return this.props.children?this.props.children:this.props.albums?h.a.createElement("div",{"data-testid":"album-pho-content-wrapper",className:P.a["pho-content-wrapper"]},h.a.createElement(oe.a,{viewName:"albums"},h.a.createElement(L,{t:t,router:n})),h.a.createElement(ie,{list:this.props.albums})):null}}]),n}(m.Component),se=Object(A.translate)()(Object(f.g)(ce)),le=n("PJYZ"),ue=n.n(le),de=n("lSNA"),pe=n.n(de),me=n("Vg22"),he=n("17x9"),fe=n.n(he),be=n("Yo2A"),ye=n("DA+R"),ve=n("56YH"),ge=n.n(ve),_e=n("FFOw"),Ee=n("9jN0"),we=n("2QaW"),xe=n("ufaa"),Oe=n("lXO7"),ke=n("sbrb"),je=n("Tgut"),Ce=n("46CF"),Se=n("/NT0");function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var o=C()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k()(this,n)}}var Ae=function(e){x()(n,e);var t=Pe(n);function n(){return g()(this,n),t.apply(this,arguments)}return E()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.router,r=e.album,o=e.sharedWithMe,a=e.readOnly,i=e.disabled,c=void 0!==i&&i,s=e.downloadAlbum,l=e.deleteAlbum,u=e.selectItems,d=e.onRename,p=e.breakpoints.isMobile,m=e.shareAlbum;return h.a.createElement("div",{"data-testid":"pho-toolbar-album",className:I.a["pho-toolbar"],role:"toolbar"},!p&&h.a.createElement(h.a.Fragment,null,h.a.createElement(_e.a,{docId:r.id,onClick:function(){return m(r)}}),h.a.createElement(Ee.a,{disabled:c,label:t("Albums.share.cta"),onClick:function(){return m(r)},docId:r.id})),h.a.createElement(N.b,{"data-testid":"more-button",disabled:c,className:I.a["pho-toolbar-menu"],component:h.a.createElement(M.b,null),position:"right"},!o&&h.a.createElement(N.a,{className:"u-hide--desk",icon:h.a.createElement(T.a,{icon:Oe.a}),onSelect:function(){return m(r)}},h.a.createElement(Q.a,{docId:r.id},(function(e){var n=e.isSharedWithMe,r=e.recipients,o=e.link;return h.a.createElement(h.a.Fragment,null,t(n?"Albums.share.sharedWithMe":"Albums.share.cta"),h.a.createElement(we.a,{className:I.a["fil-toolbar-menu-recipients"],recipients:r,link:o,size:"small"}))}))),h.a.createElement(N.a,{"data-testid":"menu-download-album",onSelect:s,icon:h.a.createElement(T.a,{icon:ke.a})},t("Toolbar.menu.download_album")),h.a.createElement(N.a,{"data-testid":"menu-rename-album",icon:h.a.createElement(T.a,{icon:je.a}),onSelect:d},t("Toolbar.menu.rename_album")),!a&&h.a.createElement(N.a,{"data-testid":"menu-add-photos-to-album",icon:h.a.createElement(T.a,{icon:q.a}),onSelect:function(){return n.push("".concat(n.location.pathname,"/edit"))}},t("Toolbar.menu.add_photos")),h.a.createElement("hr",{className:"u-hide--desk"}),h.a.createElement(N.a,{className:"u-hide--desk",icon:h.a.createElement(T.a,{icon:Se.a}),onSelect:u},t("Toolbar.menu.select_items")),h.a.createElement("hr",null),!o&&h.a.createElement(N.a,{"data-testid":"menu-delete-album",className:I.a["pho-action-delete"],icon:h.a.createElement(T.a,{icon:Ce.a}),onSelect:l},t("Toolbar.menu.album_delete"))))}}]),n}(m.Component),Re=Object(xe.a)()(Ae),ze=n("TtgU"),De=n("2sk9"),Ne=n.n(De),Te=n("e5eR"),qe=function(e){var t=e.t,n=e.confirm,r=e.onClose,o=["forbidden","eye","link"].map((function(e){return h.a.createElement("p",{className:z()(Ne.a["fil-confirm-text"],Ne.a["icon-".concat(e)]),key:e},t("destroyconfirmation.".concat(e)))}));return h.a.createElement(Te.a,{open:!0,onClose:r,title:t("destroyconfirmation.title"),content:o,actions:h.a.createElement(h.a.Fragment,null,h.a.createElement(D.c,{theme:"secondary",onClick:r,label:t("destroyconfirmation.cancel")}),h.a.createElement(D.c,{theme:"danger",label:t("destroyconfirmation.delete"),onClick:n}))})},Me=n("q/Uw");function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){pe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var o=C()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k()(this,n)}}var Fe=function(e){x()(n,e);var t=Le(n);function n(){var e;g()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),pe()(ue()(e),"state",{editing:!1,showAddAlbumModal:!1}),pe()(ue()(e),"showAddAlbumModal",(function(){e.setState((function(e){return Ie(Ie({},e),{},{showAddAlbumModal:!0})}))})),pe()(ue()(e),"hideAddAlbumModal",(function(){e.setState((function(e){return Ie(Ie({},e),{},{showAddAlbumModal:!1})}))})),pe()(ue()(e),"editAlbumName",(function(){e.setState((function(e){return Ie(Ie({},e),{},{editing:!0})}))})),pe()(ue()(e),"renameAlbum",(function(t){if(""!==t.trim())if(t!==e.props.album.name){var n=Ie(Ie({},e.props.album),{},{name:t});e.props.updateAlbum(n).then((function(){e.setState({editing:!1})})).catch((function(){y.a.error("Error.generic")}))}else e.setState({editing:!1});else y.a.error("Error.album_rename_abort")})),pe()(ue()(e),"downloadAlbum",p()(u.a.mark((function t(){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.album,t.next=3,e.props.client.getStackClient().collection("io.cozy.files").findReferencedBy({_type:"io.cozy.photos.albums",_id:n.id},{limit:99999});case 3:r=t.sent,e.props.client.collection("io.cozy.files").downloadArchive(r.data.map((function(e){return e._id})),n.name);case 5:case"end":return t.stop()}}),t)})))),pe()(ue()(e),"downloadPhotos",(function(t){e.props.client.collection("io.cozy.files").downloadArchive(t.map((function(e){return e._id})),"selected")})),pe()(ue()(e),"closeDestroyConfirmModal",(function(){e.setState({displayDestroyConfirmModal:!1})})),pe()(ue()(e),"renderDestroyConfirm",(function(){var t=e.props,n=t.t,r=t.router,o=t.album,a=t.deleteAlbum;return h.a.createElement(qe,{t:n,albumName:o.name,onClose:e.closeDestroyConfirmModal,confirm:function(){return a(o).then((function(){r.replace("albums"),y.a.success("Albums.remove_album.success",{name:o.name})})).catch((function(){return y.a.error("Albums.remove_album.error.generic")}))}})})),pe()(ue()(e),"deleteAlbum",(function(){e.setState({displayDestroyConfirmModal:!0})})),e}return E()(n,[{key:"render",value:function(){var e=this;if(!this.props.album||!this.props.photos)return null;var t=this.props,n=t.t,r=t.router,o=t.album,a=t.shareAlbum,i=t.photos,c=t.hasMore,s=t.fetchMore,l=t.lastFetch,u=this.state.editing,d={};return h.a.createElement(Me.a,{actions:function(t){return{"album-add":e.showAddAlbumModal,download:e.downloadPhotos,"album-remove":function(n){return e.props.removePhotos(o,n,t.clear)}}}},(function(t,p,m){return h.a.createElement("div",{"data-testid":"album-pho-content-wrapper",className:P.a["pho-content-wrapper"]},o.name&&o.photos.data&&h.a.createElement(oe.a,{viewName:"albumContent",albumName:o.name,editing:u,onEdit:e.renameAlbum},h.a.createElement(Re,{t:n,router:r,album:o,sharedWithMe:d.withMe,sharedByMe:d.byMe,readOnly:d.readOnly,onRename:e.editAlbumName,downloadAlbum:e.downloadAlbum,deleteAlbum:e.deleteAlbum,shareAlbum:a})),e.state.displayDestroyConfirmModal&&e.renderDestroyConfirm(),e.state.showAddAlbumModal&&h.a.createElement(Et,{onDismiss:e.hideAddAlbumModal,onSuccess:m.clear,photos:t}),i&&h.a.createElement(ze.a,{lists:[{photos:i}],selected:t,photosContext:"timeline",showSelection:p,onPhotoToggle:m.toggle,onPhotosSelect:m.select,onPhotosUnselect:m.unselect,fetchStatus:i.fetchStatus,hasMore:c,fetchMore:s,lastFetch:l}),e.renderViewer(e.props.children))}))}},{key:"renderViewer",value:function(e){var t=this;return e?h.a.Children.map(e,(function(e){return h.a.cloneElement(e,{photos:t.props.photos})})):null}},{key:"componentWillUnmount",value:function(){void 0!==this.props.selection&&this.props.selection.clear()}}]),n}(m.Component);Fe.propTypes={hasMore:fe.a.bool.isRequired,fetchMore:fe.a.func.isRequired,album:fe.a.object.isRequired,shareAlbum:fe.a.func,photos:fe.a.array.isRequired,t:fe.a.func.isRequired,router:fe.a.object.isRequired,lastFetch:fe.a.string};var Be=ge()(Object(me.connect)(null,(function(e){return{shareAlbum:function(t){return e(Object(be.d)(h.a.createElement(ye.a,{document:t,sharingDesc:t.name})))}}})),f.g,b.withClient,Object(A.translate)())(Fe),We=n("2lpW"),Ye=n("C/eS"),Ve=n.n(Ye);function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var o=C()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k()(this,n)}}var He=function(e){x()(n,e);var t=Ge(n);function n(e){var r;return g()(this,n),r=t.call(this,e),pe()(ue()(r),"onNameChange",(function(e){r.setState({name:e.target.value})})),pe()(ue()(r),"onCancel",(function(){r.props.router.goBack()})),pe()(ue()(r),"onCreate",(function(e){var t=r.state.name;r.props.createAlbum(t,e).then((function(e){return r.props.router.push("/albums/".concat(e.id))})).catch((function(){r.input.focus(),r.input.select()}))})),pe()(ue()(r),"onUpdate",(function(e){var t=r.props.album;r.props.addPhotos(t,e).then((function(){return r.props.router.push("/albums/".concat(t.id))}))})),r.state={name:e.t("Albums.create.panel_form.placeholder")},r}return E()(n,[{key:"componentDidMount",value:function(){this.props.album||(this.input.focus(),this.input.select())}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.album,o=this.state.name,a=!r;return h.a.createElement(Me.a,null,(function(t,i,c){return h.a.createElement("div",{className:Ve.a["pho-panel"]},h.a.createElement("div",{className:Ve.a["pho-panel-form"]},h.a.createElement("header",{className:Ve.a["pho-panel-header"]},h.a.createElement("div",{className:Ve.a["pho-panel-wrap"]},a&&h.a.createElement("div",null,h.a.createElement("label",{className:Ve.a["coz-form-label"]},n("Albums.create.panel_form.label")),h.a.createElement("input",{"data-testid":"input-album-name",type:"text",ref:function(t){e.input=t},value:o,onChange:e.onNameChange})),!a&&h.a.createElement("h3",{"data-testid":"pho-picker-album-name"},r.name))),h.a.createElement("div",{className:Ve.a["pho-panel-content"]},h.a.createElement("div",{"data-testid":"picker-panel",className:Ve.a["pho-panel-wrap"]},h.a.createElement(We.a,{selected:t,showSelection:!0,selection:c}))),h.a.createElement("footer",{className:Ve.a["pho-panel-footer"]},h.a.createElement("div",{className:Ve.a["pho-panel-wrap"]},h.a.createElement("div",{className:Ve.a["pho-panel-controls"]},h.a.createElement(D.a,{theme:"secondary",onClick:e.onCancel,label:n("Albums.create.panel_form.cancel")}),h.a.createElement(D.a,{"data-testid":"validate-album",onClick:function(){return a?e.onCreate(t):e.onUpdate(t)},label:n(a?"Albums.create.panel_form.submit":"Albums.create.panel_form.update")}))))))}))}}]),n}(m.Component),Qe=Object(A.translate)()(Object(f.g)(He)),Ze=n("D575"),Je=n.n(Ze),Ke=n("qFRD"),Xe=n("MSWZ"),$e=n("luXY"),et=n.n($e);function tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var o=C()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k()(this,n)}}var nt=function(e){x()(n,e);var t=tt(n);function n(){var e;return g()(this,n),(e=t.call(this)).state={name:"",isSubmitDisabled:!0,isBusy:!1,hasError:!1},e}return E()(n,[{key:"reset",value:function(){this.setState({name:"",isSubmitDisabled:!0,isBusy:!1,hasError:!1})}},{key:"onSubmit",value:function(e,t){var n=this;return e.preventDefault(),this.setState({isBusy:!0}),t(this.state.name).then((function(){return n.reset()}),(function(){return n.setState({hasError:!0,isBusy:!1})}))}},{key:"onNameChange",value:function(e){var t=e.target.value;this.setState({name:t,isSubmitDisabled:!t.trim().length,hasError:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.onSubmitNewAlbum;return h.a.createElement("form",{className:et.a["pho-create-album-form"],onSubmit:function(t){return e.onSubmit(t,r)}},h.a.createElement("label",{className:et.a["coz-create-album-label"]},n("Albums.create.inline_form.create_label")),h.a.createElement("div",{className:et.a["coz-inline-form"]},h.a.createElement("input",{className:z()(et.a["coz-input-text"],this.state.hasError&&et.a.error),type:"text",name:"album-name",onInput:function(t){return e.onNameChange(t)},disabled:this.state.isBusy,placeholder:n("Albums.create.inline_form.placeholder"),value:this.state.name}),h.a.createElement(D.a,{className:et.a["create-button"],disabled:this.state.isSubmitDisabled||this.state.isBusy,"aria-busy":this.state.isBusy,label:n("Albums.create.inline_form.create_button")})))}}]),n}(m.Component),rt=Object(A.translate)()(nt),ot=void 0,at=function(e){return 0===e.albums.data.length?h.a.createElement(Y.a,{localeKey:"albums"}):h.a.createElement("div",{className:z()(B.a["pho-album-list"],B.a["pho-album-list--thumbnails"],B.a["pho-album-list--selectable"])},e.albums.data.map((function(t){return h.a.createElement($,{album:t,key:t.id,thumbnail:!0,onServerError:e.onServerError,onClick:e.onSubmitSelectedAlbum})})))},it=Object(re.b)((function(e){return e.error}),"albums",(function(e){return h.a.createElement("div",null,h.a.createElement(at,e))})),ct=function(e){if(!e.albums)return null;var t="failed"===e.albums.fetchStatus;return h.a.createElement(it,i()({error:t,onServerError:function(){return ot.handleError(t)}},e))};function st(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C()(e);if(t){var o=C()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k()(this,n)}}var lt=function(e){x()(n,e);var t=st(n);function n(){return g()(this,n),t.apply(this,arguments)}return E()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.photos,r=e.data,o=e.fetchStatus,a=e.createAlbum,i=e.addPhotos,c=e.onDismiss,s=e.onSuccess,l=void 0===s?function(){}:s,u="pending"===o||"loading"===o;return h.a.createElement(Ke.a,{open:!0,onClose:c,title:t("Albums.add_photos.title"),content:h.a.createElement("div",null,h.a.createElement("div",null,h.a.createElement(rt,{onSubmitNewAlbum:function(e){return a(e,n).then(c).then(l)}}),h.a.createElement(Xe.a,{className:"u-ml-0 u-maw-100 u-mt-1"}),u&&h.a.createElement(ne.a,{loadingType:"albums_fetching"}),!u&&r&&r.length>0&&h.a.createElement("div",{className:z()(Je.a["coz-select-album"])},h.a.createElement(ct,{albums:{data:r,fetchStatus:o},onSubmitSelectedAlbum:function(e){return i(e,n).then(c).then(l)}}))))})}}]),n}(m.Component),ut=Object(A.translate)()(lt),dt=n("z6Q1"),pt=["params"];function mt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ft=function(e){return e.find(dt.a,{created_at:{$gt:null}}).where({auto:{$exists:!1}}).indexFields(["created_at"]).include(["photos"]).sortBy([{created_at:"desc"}])},bt=function(e,t){return Object(b.Q)(dt.a).getById(t.router.params.albumId).include(["photos"])},yt=function(){var e=p()(u.a.mark((function e(t,n){var r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.photos.data.length,e.next=4,t.photos.addById(n.map((function(e){return e._id})));case 4:o=t.photos.data.length,r+n.length!==o?y.a.info("Alerter.photos.already_added_photo"):y.a.success("Albums.add_photos.success",{name:t.name,smart_count:n.length}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),y.a.error("Albums.add_photos.error.reference");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),vt=function(e){return{updateAlbum:(n=p()(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.collection(dt.a).checkUniquenessOf("name",n.name);case 2:if(!0===t.sent){t.next=8;break}return y.a.error("Albums.create.error.already_exists",{name:name}),t.abrupt("return");case 8:return t.abrupt("return",e.save(n));case 9:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)}),deleteAlbum:function(t){return e.destroy(t)},addPhotos:yt,removePhotos:(t=p()(u.a.mark((function e(t,n,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.photos.removeById(n.map((function(e){return e._id})));case 3:y.a.success("Albums.remove_photos.success",{album_name:t.name}),r(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),y.a.error("Albums.remove_photos.error.generic");case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e,n,r){return t.apply(this,arguments)})};var t,n},gt=function(e){return{addPhotos:yt,createAlbum:(t=p()(u.a.mark((function t(n,r){var o,a,i,c=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=c.length>2&&void 0!==c[2]?c[2]:new Date,t.prev=1,n){t.next=5;break}return y.a.error("Albums.create.error.name_missing"),t.abrupt("return");case 5:return a={_type:dt.a,name:n,created_at:o},t.next=8,e.collection(dt.a).checkUniquenessOf("name",a.name);case 8:if(!0===t.sent){t.next=12;break}return y.a.error("Albums.create.error.already_exists",{name:n}),t.abrupt("return");case 12:return t.next=14,e.create(dt.a,a,{photos:r},{updateQueries:{albums:function(e,t){return[t.data].concat(s()(e))}}});case 14:return i=t.sent,y.a.success("Albums.create.success",{name:a.name,smart_count:r.length}),t.abrupt("return",i.data);case 19:t.prev=19,t.t0=t.catch(1),y.a.error("Albums.create.error.generic");case 22:case"end":return t.stop()}}),t,null,[[1,19]])}))),function(e,n){return t.apply(this,arguments)})};var t},_t=function(e){return h.a.createElement(b.Query,{query:ft},(function(t){return h.a.createElement(se,i()({albums:t},e))}))},Et=function(e){return h.a.createElement(b.Query,{query:ft,as:"albums",mutations:gt},(function(t,n){var r=n.createAlbum,o=n.addPhotos;return h.a.createElement(ut,i()({},t,{createAlbum:r,addPhotos:o},e))}))},wt=Object(f.g)((function(e){return h.a.createElement(b.Query,i()({query:bt},e,{mutations:vt}),(t={children:e.children},n=t.children,function(e,t){var r=e.data,o=e.fetchStatus,a=e.lastFetch,i=t.updateAlbum,c=t.deleteAlbum,s=t.removePhotos;return r&&"loaded"===o?h.a.createElement(Be,{album:r,photos:r.photos.data,updateAlbum:i,deleteAlbum:c,removePhotos:s,hasMore:r.photos.hasMore,fetchMore:r.photos.fetchMore.bind(r.photos),lastFetch:a},n):h.a.createElement(ne.a,{size:"xxlarge",loadingType:"photos_fetching",middle:!0})}));var t,n})),xt=Object(b.withMutations)(gt)(Qe),Ot=Object(f.g)((function(e){var t=e.params,n=o()(e,pt);return t.albumId?h.a.createElement(b.Query,i()({query:bt,mutations:gt},n),(function(e,t){var n=e.data,r=t.addPhotos;return h.a.createElement(Qe,{album:n,addPhotos:r})})):h.a.createElement(xt,null)})),kt=function(e){if(!e)return!1;var t,n=mt(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.relationships&&r.relationships.referenced_by&&r.relationships.referenced_by.data&&r.relationships.referenced_by.data.length>0){var o,a=mt(r.relationships.referenced_by.data);try{for(a.s();!(o=a.n()).done;){if(o.value.type===dt.a)return!0}}catch(i){a.e(i)}finally{a.f()}}}}catch(i){n.e(i)}finally{n.f()}return!1}},SvPG:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return m}));var r=n("q1tI"),o=n.n(r),a=n("buk/"),i=n("KXWi"),c=n("Pxjx"),s=n("swni"),l=n.n(s),u=function(e){var t=e.disabled,n=e.onClick,r=Object(a.useI18n)().t;return o.a.createElement(i.a,{"data-testid":"more-button",className:l.a["dri-btn--more"],theme:"secondary",disabled:t,onClick:n,extension:"narrow",icon:c.a,iconOnly:!0,label:r("Toolbar.more")})},d=n("17x9"),p=function(e){var t=e.className,n=Object(a.useI18n)().t;return o.a.createElement(i.b,{label:n("Share.create-cozy"),icon:"cloud",className:t,href:"https://manager.cozycloud.cc/cozy/create",size:"normal"})};p.propTypes={from:n.n(d).a.string},p.defaultProps={from:""};var m=p},SvWF:function(e,t,n){"use strict";n.d(t,"b",(function(){return f}));var r=n("q1tI"),o=n.n(r),a=n("buk/"),i=n("GoJ1"),c=n("KXWi"),s=n("4BeY"),l=n.n(s),u=n("IaFt"),d=n.n(u),p=new l.a({id:"icon-image-broken_a4fd70a7dc9c96a1d21491390660382c",use:"icon-image-broken_a4fd70a7dc9c96a1d21491390660382c-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="icon-image-broken_a4fd70a7dc9c96a1d21491390660382c">\n  <g fill="none" fill-rule="evenodd" transform="translate(0 2)">\n    <rect width="32" height="28" fill="#FDD5D5" rx="2" />\n    <path fill="#F52D2D" d="M24,20 L13,15 L19.2902805,8.70971949 C19.6822478,8.31775224 20.3203148,8.32031476 20.7062149,8.7062149 L29,17 L24,20 Z" />\n    <path fill="#F52D2D" d="M0,22 L6.29028051,15.7097195 C6.68224776,15.3177522 7.31387329,15.3138733 7.70591205,15.7059121 L11,19 L15.0233154,14.9766846 L24,19 L27.2486572,17.2486572 L32,22 L32,26.0020869 C32,27.1055038 31.1107383,28 29.9982567,28 L2.00174332,28 C0.89621101,28 0,27.1017394 0,26.0020869 L0,22 Z" />\n    <circle cx="8" cy="7" r="3" fill="#FFFFFF" />\n    <path stroke="#FDD5D5" d="M11,18.3000031 L5.5,23.8000031 L11,18.3000031 Z" stroke-linecap="round" stroke-linejoin="round" />\n    <polyline stroke="#FFFFFF" stroke-width="2" points="0 17 8 13 24 20 32 16" stroke-linecap="round" stroke-linejoin="round" />\n  </g>\n</symbol>'}),m=(d.a.add(p),p),h=Object(a.translate)()((function(e){var t=e.t,n=e.errorType;return o.a.createElement(i.a,{title:t("Error.".concat(n,"_title")),icon:m},o.a.createElement(c.c,{onClick:function(){return window.location.reload()},label:t("Error.refresh")}))})),f=function(e,t,n){return function(r){return e(r)?o.a.createElement(h,{errorType:t}):o.a.createElement(n,r)}};t.a=h},TtgU:function(e,t,n){"use strict";var r=n("lwsE"),o=n.n(r),a=n("W8MJ"),i=n.n(a),c=n("7W2i"),s=n.n(c),l=n("a1gu"),u=n.n(l),d=n("Nsbk"),p=n.n(d),m=n("kKu1"),h=n.n(m),f=n("q1tI"),b=n.n(f),y=n("CMvH"),v=n("buk/"),g=n("sIaW"),_=n.n(g),E=n("TSYQ"),w=n.n(E),x=n("lSNA"),O=n.n(x),k=n("dtw8"),j=n("6se/"),C=Object(k.g)((function(e){var t=e.photo,n=e.box,r=e.selected,o=void 0!==r&&r,a=e.onToggle,i=e.router,c=function(e){var t={};return e&&(e.width&&(t.width="".concat(e.width,"px")),e.height&&(t.height="".concat(e.height,"px")),e.top&&(t.top="".concat(e.top,"px")),e.left&&(t.left="".concat(e.left,"px"))),t}(n);return b.a.createElement("div",{style:c,"data-test-item":t.name,className:w()(h.a["pho-photo"],O()({},h.a["pho-photo--selected"],o))},b.a.createElement("div",null,b.a.createElement("span",{className:h.a["pho-photo-select"],"data-input":"checkbox",onClick:function(e){e.stopPropagation(),a(t,o)}},b.a.createElement("input",{type:"checkbox",checked:o,onChange:function(){}}),b.a.createElement("label",null)),b.a.createElement(k.a,{to:{pathname:"".concat(i.location.pathname,"/").concat(t.id),query:i.location.query}},b.a.createElement(j.a,{file:t,linkType:"small",render:function(e){return b.a.createElement("img",{"data-testid":"pho-photo-item",src:e,className:h.a["pho-photo-item"],style:c})}}))))}));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u()(this,n)}}var P={width:1,height:1},A=function(e){return 180+(e||1800)/30},R=function(e){s()(n,e);var t=S(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,[{key:"isPhotoSelected",value:function(e,t){return-1!==t.map((function(e){return e._id})).indexOf(e._id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.key,o=t.title,a=t.photos,i=t.selected,c=t.showSelection,s=t.onPhotoToggle,l=t.onPhotosSelect,u=t.onPhotosUnselect,d=t.containerWidth;if(!d)return null;var p=d>=768?{spacing:16,padding:32}:{spacing:8,padding:0},m=_()(a.map((function(e){var t=e.metadata||e.attributes.metadata;return t&&t.width&&t.height?function(e){return e.orientation&&e.orientation>4?{width:e.height,height:e.width}:e}(t):P})),{containerWidth:d,targetRowHeight:A(d),boxSpacing:{horizontal:p.spacing,vertical:p.spacing},containerPadding:{top:0,right:p.padding,bottom:0,left:p.padding}}),f=i.map((function(e){return e._id})),y=a.every((function(e){return-1!==f.indexOf(e._id)})),v=m.boxes[0].top,g=m.boxes.findIndex((function(e){return e.top!==v})),E=-1===g?m.boxes[m.boxes.length-1]:m.boxes[g-1],x=d-E.left-E.width-p.padding;return b.a.createElement("div",{"data-testid":"photo-section",className:w()(h.a["pho-section"],c&&h.a["pho-section--has-selection"]),key:r,style:{width:"".concat(d,"px")}},b.a.createElement("div",{className:h.a["pho-section-header"]},b.a.createElement("h3",null,o),c&&a.length>1&&y&&b.a.createElement("a",{style:{marginRight:"".concat(x,"px")},onClick:function(){return u(a)}},n("Board.unselect_all")),c&&a.length>1&&!y&&b.a.createElement("a",{style:{marginRight:"".concat(x,"px")},onClick:function(){return l(a)}},n("Board.select_all"))),b.a.createElement("div",{className:h.a["pho-photo-wrapper"],style:{width:"".concat(d,"px"),height:"".concat(m.containerHeight,"px")}},a.map((function(t,n){return b.a.createElement(C,{photo:t,box:m.boxes[n],key:t.id+n,selected:e.isPhotoSelected(t,i),onToggle:s})}))))}}]),n}(f.Component),z=Object(v.translate)()(R),D=n("KOJc"),N=n("ZFPb"),T=n("SvWF"),q=n("RPnM");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u()(this,n)}}var U=function(e){s()(n,e);var t=M(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.f,r=e.lists,o=e.selected,a=e.photosContext,i=e.showSelection,c=e.onPhotoToggle,s=e.onPhotosSelect,l=e.onPhotosUnselect,u=e.fetchStatus,d=e.hasMore,p=e.fetchMore,m=e.measureRef,f=e.contentRect.entry.width,y=e.lastFetch,v=("pending"===u||"loading"===u)&&!y;return"failed"===u?b.a.createElement(T.a,{errorType:"".concat(a,"_photos")}):v?b.a.createElement(N.a,{loadingType:"photos_fetching"}):v||0!==r.length&&0!==r[0].photos.length?b.a.createElement("div",{className:i?h.a["pho-list-selection"]:"",ref:m},r.map((function(e,t){return b.a.createElement(z,{key:t,title:e.title||(e.month?n(e.month,"MMMM YYYY"):""),photos:e.photos,selected:o,showSelection:i,onPhotoToggle:c,onPhotosSelect:s,onPhotosUnselect:l,containerWidth:f})})),d&&b.a.createElement(q.a,{label:t("Board.load_more"),width:f,onClick:p})):b.a.createElement(D.a,{localeKey:"".concat(a,"_photos")})}}]),n}(f.Component);t.a=Object(v.translate)()(Object(y.a)()(U))},VZRP:function(e,t,n){e.exports={"pho-content-title":"pho-content-title--3Yt9z",error:"error--2qbV5","pho-content-header":"pho-content-header--1M4IS","--hide-bar":"_--hide-bar--lrytb","pho-content-album-previous":"pho-content-album-previous--3BqBh",spin:"spin--1ZeSG",shake:"shake--3WZrZ"}},"XA+M":function(e,t){e.exports={name:"Drive",name_prefix:"Cozy",slug:"drive",version:"1.49.0",type:"webapp",licence:"AGPL-3.0",icon:"public/app-icon.svg",categories:["cozy"],source:"https://github.com/cozy/cozy-drive",editor:"Cozy",developer:{name:"Cozy Cloud",url:"https://cozy.io"},locales:{en:{short_description:"Cozy Drive helps you to save, sync and secure your files on your Cozy.",long_description:"With Cozy Drive, you can easily:\n- Store your important files and keep them secure in your Cozy\n- Access to all your documents online & offline, from your desktop, and on your smartphone or tablet\n- Share links to files ans folders with who you like;\n- Automatically retrieve bills, payrolls, tax notices and other data from your main online services (internet, energy, retail, mobile, energy, travel...)\n- Upload files to your Cozy from your Android",screenshots:["screenshots/en/screenshot01.png","screenshots/en/screenshot02.png","screenshots/en/screenshot03.png","screenshots/en/screenshot04.png"]},fr:{short_description:"Cozy Drive est l’application de sauvegarde, de synchronisation et de sécurisation de tous vos fichiers sur Cozy.",long_description:"Avec Cozy Drive vous pourrez :\n- Sauvegarder et synchroniser gratuitement tous vos documents importants (carte d’identité, photos de vacances, avis d’imposition, fiches de salaires…);\n- Accéder à vos documents n’importe quand, n’importe ou même en mode avion depuis votre bureau, votre smartphone ou tablette;\n- Partager vos fichiers et dossiers par lien avec qui vous le souhaitez;\n- Récupérer automatiquement vos documents administratifs de vos principaux fournisseurs de service (opérateur mobile, fournisseur d’énergie, assureur, internet, santé…);\n- Rester synchronisé·e lors de vos voyages et déplacements professionnels avec nos applications mobiles.",screenshots:["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png","screenshots/fr/screenshot03.png","screenshots/fr/screenshot04.png"]}},screenshots:["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png","screenshots/fr/screenshot03.png","screenshots/fr/screenshot04.png"],langs:["en","fr"],platforms:[{type:"ios",url:"https://itunes.apple.com/us/app/cozy-drive/id1224102389?mt=8"},{type:"android",url:"https://play.google.com/store/apps/details?id=io.cozy.drive.mobile"}],routes:{"/":{folder:"/",index:"index.html",public:!1},"/intents":{folder:"/intents",index:"index.html",public:!1},"/public":{folder:"/public",index:"index.html",public:!0},"/preview":{folder:"/public",index:"index.html",public:!0}},intents:[{action:"OPEN",type:["io.cozy.files"],href:"/intents"},{action:"GET_URL",type:["io.cozy.files"],href:"/intents"},{action:"OPEN",type:["io.cozy.suggestions"],href:"/intents"}],services:{qualificationMigration:{type:"node",file:"services/qualificationMigration/drive.js",trigger:"@event io.cozy.files:CREATED,UPDATED",debounce:"24h"},dacc:{type:"node",file:"services/dacc/drive.js",trigger:"@monthly on the 5-7 between 2pm and 7pm"}},permissions:{files:{description:"Required to access the files",type:"io.cozy.files",verbs:["ALL"]},allFiles:{description:"Required to access the files",type:"io.cozy.files.*",verbs:["ALL"]},apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET"]},sharings:{description:"Required to have access to the sharings in realtime",type:"io.cozy.sharings",verbs:["GET"]},albums:{description:"Required to manage photos albums",type:"io.cozy.photos.albums",verbs:["PUT","GET"]},contacts:{type:"io.cozy.contacts",verbs:["GET","POST"]},groups:{type:"io.cozy.contacts.groups",verbs:["GET"]},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]},oauth:{description:"Required to display the cozy-desktop banner",type:"io.cozy.oauth.clients",verbs:["GET"]},errorsreporting:{description:"Allow to report unexpected errors to the support team",type:"cc.cozycloud.errors",verbs:["POST"]},mail:{description:"Send feedback emails to the support team",type:"io.cozy.jobs",verbs:["POST"],selector:"worker",values:["sendmail"]},konnectors:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.konnectors",verbs:["GET"]},accounts:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.accounts",verbs:["GET"]},triggers:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.triggers",verbs:["GET"]},dacc:{type:"cc.cozycloud.dacc_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized measures to the DACC shared among mycozy.cloud's Cozy."},"dacc-eu":{type:"eu.mycozy.dacc_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized measures to the DACC shared among mycozy.eu's Cozy."}}}},Yo2A:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b}));var r=n("fvjX"),o=n("lSNA"),a=n.n(o),i=n("q1tI"),c=n.n(i),s=n("Vg22");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1,component:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODAL":return{show:!0,component:t.component};case"HIDE_MODAL":return{show:!1,component:null};default:return e}},d=function(e){return{type:"SHOW_MODAL",component:e,meta:{hideActionMenu:!0}}},p=Object(s.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.ui.modal)}))((function(e){var t=e.show,n=e.component,r=e.dispatch;return t?c.a.cloneElement(n,{onClose:function(e){return r(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"HIDE_MODAL",meta:e}}(e))}}):null})),m=n("J4zp"),h=n.n(m),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=h()(t,2),r=n[0],o=n[1],a=void 0===o||o;return e[r]=decodeURIComponent(a),e},b=function(){return window.location.search.substring(1).split("&").map((function(e){return e.split("=")})).reduce(f,{})};t.b=Object(r.combineReducers)({modal:u})},ZFPb:function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=n("TSYQ"),i=n.n(a),c=n("buk/"),s=n("V2U0"),l=n("7jrE"),u=n.n(l),d=n("5ZYL"),p=n.n(d);t.a=Object(c.translate)()((function(e){var t=e.size,n=void 0===t?"xxlarge":t,r=e.loadingType,a=e.noMargin,c=void 0!==a&&a,l=e.middle,d=void 0===l||l;return o.a.createElement("div",{"data-testid":"loading",className:i()(p.a["pho-loading"])},o.a.createElement(s.b,{size:n,loadingType:r,color:u.a.dodgerBlue,noMargin:c,middle:d}))}))},cwrA:function(e,t,n){"use strict";var r=n("lwsE"),o=n.n(r),a=n("W8MJ"),i=n.n(a),c=n("7W2i"),s=n.n(c),l=n("a1gu"),u=n.n(l),d=n("Nsbk"),p=n.n(d),m=n("q1tI"),h=n.n(m),f=n("dtw8"),b=n("B9Y0"),y=n("s0VD"),v=n("TBZM"),g=n("/dzn"),_=n("EhdM");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u()(this,n)}}var w=function(e){var t=e.location.pathname;return t.substring(0,t.lastIndexOf("/"))},x=function(e){s()(n,e);var t=E(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.photos,n=e.params,r=e.router,o=t.findIndex((function(e){return e.id===n.photoId}));return h.a.createElement(b.a,null,h.a.createElement(y.a,{files:t,currentIndex:o,onChangeRequest:function(e){return r.push({pathname:"".concat(w(r),"/").concat(e.id),query:r.location.query})},onCloseRequest:function(){return r.push({pathname:w(r),query:r.location.query})}},h.a.createElement(v.a,null,h.a.createElement(_.a,null),h.a.createElement(g.a,null))))}}]),n}(m.Component);t.a=Object(f.g)(x)},dBw4:function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=(n("59mS"),n("3FT0"),n("xIbs"));t.a=function(e){var t=e.children;return o.a.createElement(a.a,null,t)}},eKCf:function(e,t,n){"use strict";var r=n("lwsE"),o=n.n(r),a=n("W8MJ"),i=n.n(a),c=n("PJYZ"),s=n.n(c),l=n("7W2i"),u=n.n(l),d=n("a1gu"),p=n.n(d),m=n("Nsbk"),h=n.n(m),f=n("lSNA"),b=n.n(f),y=n("VZRP"),v=n.n(y),g=n("q1tI"),_=n.n(g),E=n("buk/"),w=n("yDJO"),x=n("ufaa"),O=n("SH7X"),k=n("dtw8"),j=n("17x9"),C=n.n(j),S=n("56YH"),P=n.n(S),A=n("UmWK"),R=n("z6Q1"),z=n("yFc8"),D=n("TSYQ"),N=n.n(D),T=n("IFYe"),q=function(e,t){return function(n){var r=n.children;return _.a.createElement(e,null,_.a.createElement(z.a,{className:N()("u-flex u-flex-items-center",t),variant:"normal"},r))}},M=q(T.a.BarCenter,"u-ellipsis"),U=q(T.a.BarRight),I=q(T.a.BarLeft);q(T.a.BarSearch,"u-flex-grow");function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var o=h()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var F=function(e){u()(n,e);var t=L(n);function n(e){var r;return o()(this,n),r=t.call(this,e),b()(s()(r),"handleBlur",(function(e){!r.ignoreBlurEvent&&r.props.onEdit&&r.props.onEdit(""!==e.target.value.trim()?e.target.value:r.props.albumName)})),b()(s()(r),"handleKeyDown",(function(e){13===e.keyCode&&r.props.onEdit?(r.ignoreBlurEvent=!0,r.props.onEdit(e.target.value)):27===e.keyCode&&r.props.onEdit&&(r.ignoreBlurEvent=!0,r.props.onEdit(r.props.albumName))})),r.ignoreBlurEvent=!1,r.inputElement=null,r}return i()(n,[{key:"componentDidMount",value:function(){null!==this.inputElement&&(this.inputElement.focus(),this.inputElement.select())}},{key:"render",value:function(){var e=this,t=this.props.albumName;return _.a.createElement("input",{type:"text",defaultValue:t,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,ref:function(t){e.inputElement=t}})}}]),n}(g.Component);F.propTypes={albumName:C.a.string,onEdit:C.a.func.isRequired};var B=function(e){var t=e.children;return _.a.createElement("h2",{"data-testid":"pho-content-title",className:v.a["pho-content-title"]},t)},W=function(e){var t=e.onClick;return _.a.createElement("div",{role:"button","data-testid":"pho-content-album-previous",className:v.a["pho-content-album-previous"],onClick:t})};W.propTypes={onClick:C.a.func.isRequired};var Y=function(e){u()(n,e);var t=L(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props.router.location.pathname;this.parentUrl=e.substring(0,e.lastIndexOf("/"))}},{key:"renderTitle",value:function(){var e=this.props,t=e.t,n=e.viewName,r=e.albumName,o=void 0===r?"":r,a=e.onEdit,i=e.editing;return"albumContent"===n?void 0!==i&&i?_.a.createElement(F,{albumName:o,onEdit:a}):o:t("Nav.".concat(n))}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.viewName,o=t.breakpoints.isMobile,a=t.router,i=t.client,c=t.t,s="albumContent"===r,l=_.a.createElement(B,null,this.renderTitle()),u=o?_.a.createElement(M,null,l):l,d=o?_.a.createElement(U,null,_.a.createElement(w.a,{client:i,store:this.context.store,t:c},_.a.createElement(A.a,{doctype:R.a,documentType:"Albums"},n))):n,p=_.a.createElement(W,{onClick:function(){return a.push(e.parentUrl)}}),m=o?_.a.createElement(I,null,p):p;return _.a.createElement("div",{className:v.a["pho-content-header"]},s&&m,u,d)}}]),n}(g.Component);b()(Y,"contextTypes",{store:C.a.object.isRequired}),Y.propTypes={viewName:C.a.string.isRequired,albumName:C.a.string,t:C.a.func.isRequired,editing:C.a.bool,onEdit:C.a.func,breakpoints:C.a.object.isRequired,router:C.a.object.isRequired,children:C.a.node},Y.defaultProps={editing:!1,onEdit:function(){}};t.a=P()(k.g,O.withClient,Object(x.a)(),Object(E.translate)())(Y)},kGy0:function(e,t,n){var r={"./en.json":"8WAw","./fr.json":"H488"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="kGy0"},kKu1:function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--lQY3Q","CozyTheme--normal":"CozyTheme--normal--21hb4","pho-section":"pho-section--aOGQ8","pho-photo-wrapper":"pho-photo-wrapper--34Af_","pho-section-header":"pho-section-header--3xCwP","pho-photo":"pho-photo--1RccV","pho-photo-item":"pho-photo-item--1uvPt","pho-photo-select":"pho-photo-select--2_YlY","pho-photo--selected":"pho-photo--selected--3CHFZ","pho-section--has-selection":"pho-section--has-selection--2A-rj","pho-list-morebutton":"pho-list-morebutton--1HHd8",spin:"spin--3HNuy",shake:"shake--p49Dg"}},lEMr:function(e,t,n){e.exports={"upload-queue":"upload-queue--2RXFj","CozyTheme--inverted":"CozyTheme--inverted--3LpFU","CozyTheme--normal":"CozyTheme--normal--3194H","upload-queue--visible":"upload-queue--visible--frmGj","upload-queue-header":"upload-queue-header--Vz871","upload-queue-header-inner":"upload-queue-header-inner--1AQpy","btn-close":"btn-close--32K_q","upload-queue-progress":"upload-queue-progress--2O2Rw","upload-queue-content":"upload-queue-content--UNBUz","upload-queue--collapsed":"upload-queue--collapsed--nIVVP","upload-queue-list":"upload-queue-list--2dzTR","upload-queue-item--error":"upload-queue-item--error--3UNkr","upload-queue-item--done":"upload-queue-item--done--23Ps1","upload-queue-item":"upload-queue-item--2oTRx","item-cell":"item-cell--1mZJx","item-file":"item-file--24emt","item-ext":"item-ext--3vgYK","item-image":"item-image--wp0ZG","item-status":"item-status--2Azg6","item-pending":"item-pending--wp4pw",spin:"spin--3291m",shake:"shake--eSk8B"}},lJfM:function(e,t,n){e.exports={empty:"empty--18MhH"}},luXY:function(e,t,n){e.exports={"pho-create-album-form":"pho-create-album-form--xgUhP",error:"error--2VcpR","CozyTheme--inverted":"CozyTheme--inverted--YSD9X","CozyTheme--normal":"CozyTheme--normal--knWRd","coz-create-album-label":"coz-create-album-label--2zpY4","coz-inline-form":"coz-inline-form--3COco","coz-input-text":"coz-input-text--ZuuYG","create-button":"create-button--1cJgR",spin:"spin--1T4Vk",shake:"shake--3cnvd"}},nw0P:function(e,t,n){var r={"./_lib/build_formatting_tokens_reg_exp/index.js":"kOWh","./ar/build_distance_in_words_locale/index.js":"XxX6","./ar/build_format_locale/index.js":"alis","./ar/index.js":"EDRf","./be/build_distance_in_words_locale/index.js":"LQ09","./be/build_format_locale/index.js":"kj7F","./be/index.js":"YEhR","./bg/build_distance_in_words_locale/index.js":"7K3h","./bg/build_format_locale/index.js":"RrdL","./bg/index.js":"isx8","./ca/build_distance_in_words_locale/index.js":"wqqj","./ca/build_format_locale/index.js":"qcV0","./ca/index.js":"Vwa+","./cs/build_distance_in_words_locale/index.js":"ZKDM","./cs/build_format_locale/index.js":"ipyF","./cs/index.js":"dvhP","./da/build_distance_in_words_locale/index.js":"2Mgc","./da/build_format_locale/index.js":"Gned","./da/index.js":"7ur/","./de/build_distance_in_words_locale/index.js":"5IWf","./de/build_format_locale/index.js":"THCn","./de/index.js":"bgw5","./el/build_distance_in_words_locale/index.js":"o/GB","./el/build_format_locale/index.js":"8T9h","./el/index.js":"dH0v","./en/build_distance_in_words_locale/index.js":"LZbM","./en/build_format_locale/index.js":"6DAA","./en/index.js":"Us+F","./eo/build_distance_in_words_locale/index.js":"qrnn","./eo/build_format_locale/index.js":"Bl15","./eo/index.js":"UB7v","./es/build_distance_in_words_locale/index.js":"GEfZ","./es/build_format_locale/index.js":"O+zC","./es/index.js":"/S0t","./fi/build_distance_in_words_locale/index.js":"VHtQ","./fi/build_format_locale/index.js":"Oydx","./fi/index.js":"ndVD","./fil/build_distance_in_words_locale/index.js":"uq4p","./fil/build_format_locale/index.js":"d7hw","./fil/index.js":"pNfm","./fr/build_distance_in_words_locale/index.js":"IzMR","./fr/build_format_locale/index.js":"I3Zg","./fr/index.js":"LKA2","./hr/build_distance_in_words_locale/index.js":"DPvn","./hr/build_format_locale/index.js":"puw3","./hr/index.js":"L9Jq","./hu/build_distance_in_words_locale/index.js":"w2RQ","./hu/build_format_locale/index.js":"/0iD","./hu/index.js":"Nm+E","./id/build_distance_in_words_locale/index.js":"JbvB","./id/build_format_locale/index.js":"0wlw","./id/index.js":"A6C3","./is/build_distance_in_words_locale/index.js":"qzMC","./is/build_format_locale/index.js":"S3yD","./is/index.js":"N4bE","./it/build_distance_in_words_locale/index.js":"MDEp","./it/build_format_locale/index.js":"aUJd","./it/index.js":"hmb4","./ja/build_distance_in_words_locale/index.js":"nNvt","./ja/build_format_locale/index.js":"buui","./ja/index.js":"uAXs","./ko/build_distance_in_words_locale/index.js":"oEw+","./ko/build_format_locale/index.js":"9SQf","./ko/index.js":"iW8+","./mk/build_distance_in_words_locale/index.js":"nmwZ","./mk/build_format_locale/index.js":"htxJ","./mk/index.js":"GzBU","./nb/build_distance_in_words_locale/index.js":"SL1f","./nb/build_format_locale/index.js":"CJ5F","./nb/index.js":"73vv","./nl/build_distance_in_words_locale/index.js":"Uyu0","./nl/build_format_locale/index.js":"doCD","./nl/index.js":"hCQt","./pl/build_distance_in_words_locale/index.js":"FUBD","./pl/build_format_locale/index.js":"nOYf","./pl/index.js":"B6yL","./pt/build_distance_in_words_locale/index.js":"aTPA","./pt/build_format_locale/index.js":"TTT0","./pt/index.js":"gdks","./ro/build_distance_in_words_locale/index.js":"gI+A","./ro/build_format_locale/index.js":"njjO","./ro/index.js":"r2yp","./ru/build_distance_in_words_locale/index.js":"KmPx","./ru/build_format_locale/index.js":"UUBw","./ru/index.js":"nz/o","./sk/build_distance_in_words_locale/index.js":"q2Bs","./sk/build_format_locale/index.js":"9sxn","./sk/index.js":"Wqan","./sl/build_distance_in_words_locale/index.js":"mlv2","./sl/build_format_locale/index.js":"vHkZ","./sl/index.js":"KYSo","./sr/build_distance_in_words_locale/index.js":"LlkS","./sr/build_format_locale/index.js":"RhjJ","./sr/index.js":"7mU3","./sv/build_distance_in_words_locale/index.js":"UNBN","./sv/build_format_locale/index.js":"zTNB","./sv/index.js":"hxgj","./th/build_distance_in_words_locale/index.js":"XAGa","./th/build_format_locale/index.js":"We2s","./th/index.js":"Pk+z","./tr/build_distance_in_words_locale/index.js":"aFZF","./tr/build_format_locale/index.js":"jh7A","./tr/index.js":"3ZWG","./zh_cn/build_distance_in_words_locale/index.js":"KdB7","./zh_cn/build_format_locale/index.js":"l4EP","./zh_cn/index.js":"8tMq","./zh_tw/build_distance_in_words_locale/index.js":"vyyr","./zh_tw/build_format_locale/index.js":"uYH7","./zh_tw/index.js":"QPlQ"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="nw0P"},oGE2:function(e,t,n){"use strict";n.r(t);var r=n("lSNA"),o=n.n(r),a=(n("/8/d"),n("q1tI")),i=n.n(a),c=n("i8i4"),s=n("Vg22"),l=n("fvjX"),u=n("sINF"),d=n("1mXj"),p=n("dtw8"),m=n("SH7X"),h=n.n(m),f=n("oJ5p"),b=n("1I/2"),y=n("buk/"),v=n("UmWK"),g=n("qvEe"),_=n("z6Q1"),E=n("BDb7"),w=n("Yo2A"),x={upload:E.c,ui:w.b},O=n("0yyf"),k=n.n(O),j=n("jDpt"),C=n("9VR2"),S=n("fSd/"),P=n("o0o1"),A=n.n(P),R=n("yXPU"),z=n.n(R),D=n("lwsE"),N=n.n(D),T=n("W8MJ"),q=n.n(T),M=n("PJYZ"),U=n.n(M),I=n("7W2i"),L=n.n(I),F=n("a1gu"),B=n.n(F),W=n("Nsbk"),Y=n.n(W),V=n("oAJy"),G=n.n(V),H=n("GnT2"),Q=n("snfs"),Z=n("mwIZ"),J=n.n(Z),K=function(){return window.navigator&&-1===window.navigator.appVersion.indexOf("Win")&&-1===window.navigator.appVersion.indexOf("Mac")},X=function(){return window.navigator.userAgent&&window.navigator.userAgent.indexOf("Android")>=0},$=function(){return window.navigator.userAgent&&/iPad|iPhone|iPod/.test(window.navigator.userAgent)},ee=function(){var e=z()(A.a.mark((function e(t){var n,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.query(Object(m.Q)("io.cozy.settings").getById("clients"),{as:"io.cozy.settings/clients",fetchPolicy:h.a.fetchPolicies.olderThan(3e4)});case 2:return n=e.sent,r=n.data,e.abrupt("return",Object.values(r).some((function(e){return"github.com/cozy-labs/cozy-desktop"===J()(e,"attributes.software_id")})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=n("FKqX");function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Y()(e);if(t){var o=Y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return B()(this,n)}}var ae=function(e){L()(r,e);var t,n=oe(r);function r(){var e;N()(this,r);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e=n.call.apply(n,[this].concat(a)),o()(U()(e),"state",{mustShow:!1}),e}return q()(r,[{key:"UNSAFE_componentWillMount",value:(t=z()(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===te.promoteDesktop.isActivated&&!Object(Q.isFlagshipApp)()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,G.a.getItem("desktop_banner");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=!1;case 7:if(!e.t0){e.next=13;break}return e.next=11,ee(this.props.client);case 11:!e.sent&&this.setState((function(e){return re(re({},e),{},{mustShow:!0})}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){if(!0!==te.promoteDesktop.isActivated||!this.state.mustShow||Object(Q.isFlagshipApp)())return null;var e=this.props.t;return i.a.createElement(H.a,{label:e("Nav.btn-client"),href:e(K()?"Nav.link-client":"Nav.link-client-desktop"),className:"u-m-1 u-dn-m"})}}]),r}(a.Component),ie=Object(y.translate)()(Object(m.withClient)(ae)),ce=n("56YH"),se=n.n(ce),le=n("dexL"),ue=n("KXWi"),de=n("y6ex"),pe=n("7jrE"),me=n.n(pe),he=n("eY+3"),fe=n("sbrb"),be=n("AzIT"),ye=n.n(be);function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Y()(e);if(t){var o=Y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return B()(this,n)}}var ge=function(e){L()(r,e);var t,n=ve(r);function r(e){var t;return N()(this,r),t=n.call(this,e),o()(U()(t),"state",{mustShow:!1}),t.willUnmount=!1,t}return q()(r,[{key:"componentDidMount",value:(t=z()(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.willUnmount=!1,e.next=3,G.a.getItem("desktop_banner");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=!1;case 6:if(e.t0){e.next=12;break}return e.next=10,ee(this.props.client);case 10:!e.sent&&!this.willUnmount&&this.setState({mustShow:!0});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.willUnmount=!0}},{key:"markAsSeen",value:function(){G.a.setItem("desktop_banner",!0),this.setState({mustShow:!1})}},{key:"render",value:function(){var e=this;if(!0!==te.promoteDesktop.isActivated||!this.state.mustShow)return null;var t=this.props.t,n=$()?"Nav.link-client-ios":X()?"Nav.link-client-android":K()?"Nav.link-client":"Nav.link-client-desktop",r=$()||X()?"Nav.btn-client-mobile":"Nav.banner-txt-client";return i.a.createElement("div",{className:ye.a["coz-banner-client"]},i.a.createElement(le.a,{inline:!0,icon:i.a.createElement(de.a,{icon:he.a,size:"100%"}),text:t(r),bgcolor:me.a.paleGrey,buttonOne:i.a.createElement(ue.b,{href:t(n),theme:"text",icon:fe.a,label:t("Nav.banner-btn-client"),onClick:function(){return e.markAsSeen("banner")}}),buttonTwo:i.a.createElement(ue.c,{theme:"text",label:t("SelectionBar.close"),onClick:function(){e.markAsSeen("close")}})}))}}]),r}(a.Component),_e=se()(Object(y.translate)(),m.withClient)(ge),Ee=n("67rm"),we=n("le8I"),xe=Object(S.e)(p.a),Oe=Object(y.translate)()((function(e){var t=e.t,n=e.children;return i.a.createElement(j.b,null,i.a.createElement(C.a,{className:k.a["pho-sidebar"]},i.a.createElement(S.d,null,i.a.createElement(S.b,null,i.a.createElement(xe,{to:"/photos"},i.a.createElement(S.a,{icon:"image"}),i.a.createElement(S.c,null,t("Nav.photos")))),i.a.createElement(S.b,{"data-testid":"nav-to-albums"},i.a.createElement(xe,{to:"/albums"},i.a.createElement(S.a,{icon:"album"}),i.a.createElement(S.c,null,t("Nav.albums"))))),!Object(Q.isFlagshipApp)()&&i.a.createElement(ie,null)),i.a.createElement(Ee.a,{t:t}),i.a.createElement(E.a,null),i.a.createElement(j.c,{className:k.a["pho-content"]},!Object(Q.isFlagshipApp)()&&i.a.createElement(_e,null),n),i.a.createElement(w.a,null),i.a.createElement(we.a,null))})),ke=n("2lpW"),je=n("SRpc"),Ce=n("cwrA"),Se=i.a.createElement(p.c,{component:Oe},i.a.createElement(p.c,{path:"photos",component:ke.b},i.a.createElement(p.c,{path:":photoId",component:Ce.a})),i.a.createElement(p.c,{path:"albums",component:je.d},i.a.createElement(p.c,{path:"new",component:je.e}),i.a.createElement(p.c,{path:":albumId",component:je.c},i.a.createElement(p.c,{path:"edit",component:je.e}),i.a.createElement(p.c,{path:":photoId",component:Ce.a}))),i.a.createElement(p.b,{from:"/*",to:"photos"})),Pe=n("dBw4"),Ae=n("44Ds"),Re=n.n(Ae),ze=n("qxHO"),De=n("yZiV"),Ne=n("NqoY"),Te=n("IFYe");function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue=Object(d.createLogger)(),Ie=Re()((function(){var e=document.querySelector("[role=application]"),t=JSON.parse(e.dataset.cozy),n=document.documentElement.getAttribute("lang")||"en",r=window.location?window.location.protocol:"https:",o="".concat(r,"//").concat(t.domain),a=new h.a({uri:o,token:t.token,appMetadata:De.a,schema:Ne.a,store:!1});a.registerPlugin(f.RealtimePlugin),cozy.client.init({cozyURL:o,token:t.token}),Object(ze.a)(),Object(ze.b)(o);var i=p.e,c=[u.default,Ue],s=l.compose,d=Object(l.createStore)(Object(l.combineReducers)(Me(Me({},x),{},{cozy:a.reducer()})),s(l.applyMiddleware.apply(void 0,c)));a.setStore(d);var m=t.locale;return Te.a.init({appName:t.app.name,appEditor:t.app.editor,cozyClient:a,iconPath:t.app.icon,lang:n,replaceTitleOnMobile:!0,appSlug:t.app.slug,appNamePrefix:t.app.prefix}),{store:d,locale:m,client:a,history:i,root:e}})),Le=function(e){return i.a.createElement(g.WebviewIntentProvider,null,i.a.createElement(s.Provider,{store:e.store},i.a.createElement(y.I18n,{lang:e.locale,dictRequire:function(e){return n("Gofk")("./".concat(e))}},i.a.createElement(m.CozyProvider,{client:e.client},i.a.createElement(b.a,null,i.a.createElement(Pe.a,null,i.a.createElement(v.a,{doctype:_.a,documentType:"Albums"},e.children)))))))},Fe=function(e){return i.a.createElement(Le,e,i.a.createElement(p.d,{history:e.history,routes:Se}))};document.addEventListener("DOMContentLoaded",(function(){var e,t,n,r,o,a;e=Ie(),t=e.store,n=e.locale,r=e.client,o=e.history,a=e.root,Object(c.render)(i.a.createElement(Fe,{store:t,locale:n,client:r,history:o}),a)}))},"q/Uw":function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var r=n("lwsE"),o=n.n(r),a=n("W8MJ"),i=n.n(a),c=n("PJYZ"),s=n.n(c),l=n("7W2i"),u=n.n(l),d=n("a1gu"),p=n.n(d),m=n("Nsbk"),h=n.n(m),f=n("lSNA"),b=n.n(f),y=n("RIqP"),v=n.n(y),g=n("q1tI"),_=n.n(g),E=n("+MCZ");function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var o=h()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var k=_.a.createContext([]),j=function(e,t){return{type:t?"UNSELECT_ITEM":"SELECT_ITEM",item:e}},C=function(e){return{type:"ADD_TO_SELECTION",items:e}},S=function(e){return{type:"REMOVE_FROM_SELECTION",items:e}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.meta&&t.meta.cancelSelection)return[];switch(t.type){case"SELECT_ITEM":return[].concat(v()(e),[t.item]);case"UNSELECT_ITEM":return e.filter((function(e){return e._id!==t.item.id}));case"ADD_TO_SELECTION":var n=e.map((function(e){return e._id})),r=t.items.filter((function(e){return-1===n.indexOf(e._id)}));return[].concat(v()(e),v()(r));case"REMOVE_FROM_SELECTION":var o=t.items.map((function(e){return e._id}));return e.filter((function(e){return-1===o.indexOf(e._id)}));case"HIDE_SELECTION_BAR":return[];default:return e}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(t.meta&&t.meta.cancelSelection)return!1;switch(t.type){case"TOGGLE_SELECTION_BAR":return!e;case"SHOW_SELECTION_BAR":return!0;case"HIDE_SELECTION_BAR":return!1;default:return e}},R=function(e){u()(n,e);var t=O(n);function n(){var e;o()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(s()(e),"state",{selected:P(void 0,{}),opened:A(void 0,{})}),b()(s()(e),"toggle",(function(t,n){return e.dispatch(j(t,n))})),b()(s()(e),"select",(function(t){return e.dispatch(C(t))})),b()(s()(e),"unselect",(function(t){return e.dispatch(S(t))})),b()(s()(e),"clear",(function(){return e.dispatch({type:"HIDE_SELECTION_BAR"})})),b()(s()(e),"show",(function(){return e.dispatch({type:"SHOW_SELECTION_BAR"})})),e}return i()(n,[{key:"dispatch",value:function(e){this.setState((function(t){return x(x({},t),{},{selected:P(t.selected,e),opened:A(t.opened,e)})}))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.actions,r=void 0===n?{}:n,o=this.state,a=o.selected,i=o.opened,c=0!==a.length||i,s={toggle:this.toggle,select:this.select,unselect:this.unselect,clear:this.clear,show:this.show},l="function"==typeof r?r(s):r,u={};Object.keys(l).map((function(e){u[e]="function"==typeof l[e]?{action:l[e]}:l[e]}));var d=Object.keys(u).length>0;return _.a.createElement(k.Provider,{value:a},_.a.createElement("div",null,c&&d&&_.a.createElement(E.a,{selected:a,hideSelectionBar:this.clear,actions:u}),t(a,c,s)))}}]),n}(g.Component);k.Consumer},qxHO:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n("lSNA"),o=n.n(r),a=n("NlKi"),i=n.n(a),c=n("XA+M"),s=n.n(c),l={slug:s.a.slug,version:s.a.version,name:s.a.name,prefix:s.a.name_prefix};n("OTOu");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p="undefined"==typeof __SENTRY_URL__?"":__SENTRY_URL__,m=function(e,t){return e.replace(/^file:\/\//,"app://").replace(t,"")},h=function(e){var t=/^.*\/[^.]+(\.app|CodePush|.*(?=\/))/;e.culprit&&(e.culprit=m(e.culprit,t));var n=e.stacktrace||e.exception&&e.exception.values&&e.exception.values[0]&&e.exception.values[0].stacktrace;return n&&(n.frames=n.frames.map((function(e){return"[native code]"!==e.filename?d(d({},e),{},{filename:m(e.filename,t)}):e}))),e},f=function(){i.a.config(p,{shouldSendCallback:!0,environment:"production",release:l.version,allowSecretKey:!0,dataCallback:h}).install()},b=function(e){i.a.setTagsContext({instance:e})}},swni:function(e,t,n){e.exports={"u-visuallyhidden":"u-visuallyhidden--1L4hk","dri-btn--more":"dri-btn--more--MNdqs"}},t0Aa:function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--1w1h7","CozyTheme--normal":"CozyTheme--normal--3wr-Z","c-btn":"c-btn--1VDiR","c-btn--regular":"c-btn--regular--1AoRN","c-btn--danger":"c-btn--danger--2NNcc","c-btn--secondary":"c-btn--secondary--3znY5","c-btn--danger-outline":"c-btn--danger-outline--mVde8","pho-toolbar":"pho-toolbar--28WqL","pho-action-delete":"pho-action-delete--3RnOf","pho-action-upload":"pho-action-upload--1QgoA","fil-toolbar-menu-recipients":"fil-toolbar-menu-recipients--3uaZB",spin:"spin--GHUiz",shake:"shake--3TZHV"}},u0ID:function(e,t){e.exports={name:"Photos",name_prefix:"Cozy",slug:"photos",version:"1.49.0",type:"webapp",licence:"AGPL-3.0",icon:"public/app-icon.svg",categories:["cozy"],source:"https://github.com/cozy/cozy-drive",editor:"Cozy",developer:{name:"Cozy Cloud",url:"https://cozy.io"},langs:["en","fr"],locales:{fr:{short_description:"Cozy Photos est l’application de visualisation et gestion de vos photos sur Cozy.",long_description:"Avec Cozy Photos vous pourrez :\n- Visualiser toutes les photos présentes dans votre Cozy, classées par date;\n- Organisez vos photos en albums;\n- Partager vos albums avec qui vous le souhaitez.",screenshots:["screenshots/fr/screenshot01.jpg","screenshots/fr/screenshot02.jpg","screenshots/fr/screenshot03.jpg"]},en:{short_description:"Cozy Photos allows you to view and manage your photos on your Cozy",long_description:"With Cozy Photos, you can:\n- Get a timeline of all your memories\n- Organize your photos through albums\n- Share albums with just a link",screenshots:["screenshots/en/screenshot01.jpg","screenshots/en/screenshot02.jpg","screenshots/en/screenshot03.jpg"]}},screenshots:["screenshots/fr/screenshot01.jpg","screenshots/fr/screenshot02.jpg","screenshots/fr/screenshot03.jpg"],routes:{"/":{folder:"/",index:"index.html",public:!1},"/public":{folder:"/public",index:"index.html",public:!0}},services:{onPhotoUpload:{type:"node",file:"services/onPhotoUpload/photos.js",trigger:"@event io.cozy.files:CREATED:image:class",debounce:"5m"}},permissions:{files:{description:"Required for photo access",type:"io.cozy.files",verbs:["GET","POST","PUT","PATCH"]},apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET","PUT"]},albums:{description:"Required to manage photos albums",type:"io.cozy.photos.albums",verbs:["GET","POST","PUT","DELETE","PATCH"]},photos_settings:{description:"Required to manage photos albums settings",type:"io.cozy.photos.settings",verbs:["GET","POST","PUT"]},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]},oauth:{description:"Required to display the cozy-desktop banner",type:"io.cozy.oauth.clients",verbs:["GET"]},errorsreporting:{description:"Allow to report unexpected errors to the support team",type:"cc.cozycloud.errors",verbs:["POST"]},triggers:{description:"Required to re-execute the clustering",type:"io.cozy.triggers",verbs:["POST"],selector:"worker",values:["service"]},triggersviewer:{description:"Required to display the konnector block status",type:"io.cozy.triggers",verbs:["GET"]},konnectors:{description:"Required to display the information of the konnector that retrieved the photos",type:"io.cozy.konnectors",verbs:["GET"]}}}},yZiV:function(e,t,n){"use strict";var r=n("u0ID"),o=n.n(r),a={slug:o.a.slug,version:o.a.version};t.a=a},z6Q1:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n("lSNA"),o=n.n(r),a=n("OjRq");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var c="io.cozy.files",s="io.cozy.photos.albums",l="io.cozy.apps";!function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}}({files:{doctype:c,relationships:{old_versions:{type:"has-many",doctype:"io.cozy.files.versions"},encryption:{type:"io.cozy.files:has-many",doctype:"io.cozy.files.encryption"}}},contacts:{doctype:a.a.doctype,doctypeVersion:2},groups:{doctype:a.c.doctype},versions:{doctype:"io.cozy.files.versions"}},{})}});