!function(e){function t(t){for(var a,c,i=t[0],l=t[1],s=t[2],d=0,p=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&p.push(r[c][0]),r[c]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={0:0},o=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var u=l;o.push([9,2]),n()}({0:function(e,t){},"0yyf":function(e,t,n){e.exports={"pho-sidebar":"pho-sidebar--1JZDr","pho-content":"pho-content--6vy4r","pho-content-wrapper":"pho-content-wrapper--1u34M",spin:"spin--OsM9y",shake:"shake--V0phk"}},1:function(e,t){},2:function(e,t){},"2OO4":function(e){e.exports=JSON.parse('{"Nav":{"photos":"Photos","albums":"Albums","shared":"Shared by me","trash":"Trash","backup":"Backup","btn-client":"Get Cozy Drive for desktop","btn-client-web":"Get Cozy","btn-client-mobile":"Get Cozy Drive on your mobile!","banner-txt-client":"Get Cozy Drive for Desktop and synchronise your files safely to make them accessible at all times.","banner-btn-client":"Download","link-client":"https://cozy.io/en/download/","link-client-desktop":"https://nuts.cozycloud.cc/download/channel/stable/","link-client-android":"https://play.google.com/store/apps/details?id=io.cozy.drive.mobile","link-client-ios":"https://itunes.apple.com/us/app/cozy-drive/id1224102389?mt=8","link-client-web":"https://cozy.io/fr/try-it?from=albumsharing"},"empty":{"timeline_photos_title":"You don\'t have any photos yet.","timeline_photos_text":"Click the \\"Upload\\" button to add photos.","albums_title":"You don\'t have any album yet.","albums_text":"Start by clicking \\"New album\\" to create your first album.","album_photos_title":"There is no photo in this album yet.","album_photos_text":"Start by clicking \\"Add photos to album\\" to add some.","shared_album_photos_title":"There is no photo in this album yet.","shared_album_photos_text":"Come back later"},"Error":{"albums_title":"An error occurred while retrieving the albums list. Please try again later.","album_photos_title":"An error occurred while retrieving the album\'s photos list. Please try again later.","timeline_photos_title":"An error occurred while retrieving the photos list. Please try again later.","public_album_error_title":"An error occurred while retrieving the photos list. Please try again later.","public_album_unshared_title":"Sorry, this link is no longer available.","public_album_unshared_text":"One lost, ten found... or just check out with the owner for help. This file might not be lost.","refresh":"Refresh now","generic":"An error occurred, please try again.","album_rename_abort":"The album name can not be empty.","back_homepage":"Back to homepage"},"Toolbar":{"photo_upload":"Upload","album_new":"New album","album_delete":"Delete","album_quit":"Leave & delete shared album","album_download":"Download","more":"More","menu":{"select_items":"Select photos","photo_upload":"Upload photos","rename_album":"Rename album","album_delete":"Delete album","album_quit":"Leave & delete shared album","download_album":"Download album","add_photos":"Add photos to album"}},"loading":{"photos_indexing":"Your photos are currently being indexed. Please wait.","albums_indexing":"Your albums are currently being indexed. Please wait.","photos_fetching":"Loading","albums_fetching":"Loading","photos_upload":"Uploading"},"Board":{"load_more":"Load more photos","select_all":"Select all","unselect_all":"Unselect all"},"Alerter":{"photos":{"fetching_error":"An error occurred during photos fetching.","already_added_photo":"This album already contains this photo."}},"SelectionBar":{"selected_count":"item selected |||| items selected","delete":"Delete","trash":"Delete","album-add":"Add to album","album-remove":"Remove from album","download":"Download","close":"Close"},"Share":{"status":{"pending":"Pending","accepted":"Accepted","refused":"Refused","error":"Error","unregistered":"Error","mail-not-sent":"Error","revoked":"Error"},"type":{"one-way":"Can View (coming soon)","two-way":"Can Change"},"create-cozy":"Create my cozy"},"Albums":{"album_item_description":"%{smart_count} photo |||| %{smart_count} photos","album_item_shared_ro":"Shared (read only)","album_item_shared_rw":"Shared (read/write)","load_more":"Load more albums","add_photos":{"title":"Add to album","success":"Album %{name} has been updated with %{smart_count} photo. |||| Album %{name} has been updated with %{smart_count} photos.","error":{"generic":"An error occurred when updating the album, please try again.","reference":"Some photos has not been added to the album. Please check and try again.","response":{"Forbidden":"Application does not have permission to update albums."}}},"share":{"cta":"Share","title":"Share with others","details":{"title":"Sharing details","createdAt":"On %{date}","ro":"Read only","rw":"Read/write"},"sharedByMe":"Shared","sharedWithMe":"Shared with me","shareByLink":{"subtitle":"By public link","desc":"Anyone with the provided link can see and download your photos.","fetchFailed":"Woops! It seems your connectivity is limited, try again later when it gets better.","creating":"Creating your link...","copy":"Copy link","copied":"Link has been copied to clipboard","failed":"Unable to copy to clipboard"},"shareByEmail":{"title":"By email","subtitle":"By email","email":"email","emailPlaceholder":"Enter the email address or name of the recipient","send":"Send","genericSuccess":"You sent an invite to %{count} contacts.","success":"You sent an invite to %{email}.","comingsoon":"Coming soon! You will be able to share documents and photos in a single click with your family, your friends, and even your coworkers. Don\'t worry, we\'ll let you know when it\'s ready!"},"unshare":{"title":"Remove from album","success":"You removed this shared album from %{email}."},"sharingLink":{"title":"Link to share","copy":"Copy","copied":"Copied"},"whoHasAccess":{"title":"Who has access"},"protectedShare":{"title":"Coming soon!","desc":"Share anything by email with your family and friends!"},"close":"Close","gettingLink":"Getting your link...","error":{"generic":"An error occurred when creating the album share link, please try again.","revoke":"An error occurred when revoking the album share link, please try again."}},"create":{"panel_form":{"label":"Add a name to your new album","placeholder":"Untitled album","cancel":"Cancel","submit":"Create new album","update":"Add photos to album"},"inline_form":{"placeholder":"New album name","create_label":"Create a new album","create_button":"Create"},"success":"Album %{name} has been created with %{smart_count} photo. |||| Album %{name} has been created with %{smart_count} photos.","error":{"generic":"An error occurred when creating the album, please try again.","already_exists":"The album %{name} already exists, please pick another one.","name_missing":"You have to give a name to your album."}},"fetchAlbums":{"error":{"index_missing":"An albums index must be provided to fetch albums."}},"remove_photos":{"success":"The photo has been removed from album %{album_name}","error":{"generic":"An error occured while removing the photo, please try again."}},"remove_album":{"success":"Album %{name} was deleted.","error":{"generic":"An error occured while removing the album, please try again."}},"quit_album":{"success":"Album %{name} was deleted.","error":{"generic":"An error occured while leaving the album, please try again."}}},"Viewer":{"close":"Close","noviewer":{"title":"The viewer doesn\'t know how to read this type of file yet.","download":"Download this file","openWith":"Open with..."},"actions":{"download":"Download"},"loading":{"error":"This file could not be loaded. Do you have a working internet connection right now?","retry":"Retry"}},"destroyconfirmation":{"title":"Permanently delete this album?","cancel":"Cancel","delete":"Delete permanently","forbidden":"You won\'t be able to access this album or selection anymore.","eye":"Your photos won\'t be deleted.","link":"If you have shared it, people won\'t be able to access it."},"timeline":{"DeleteConfirm":{"title":"Delete this element? |||| Delete these elements?","trash":"It will be moved to the Trash. |||| They will be moved to the Trash.","restore":"You can still restore it whenever you want. |||| You can still restore them whenever you want.","shared":"If you have shared it, people won\'t be able to access it. |||| If you have shared them, people won\'t be able to access them.","related":"Some of the photos within the selection are related to an album. They will be removed from it if you proceed to trash them.","cancel":"Cancel","delete":"Remove"}},"UploadQueue":{"path_photos":"Photos","path_upload":"Uploaded from Cozy Photos","header":"Uploading %{smart_count} photo to Cozy Photos |||| Uploading %{smart_count} photos to Cozy Photos","header_mobile":"Uploading %{done} of %{total}","header_done":"Uploaded %{done} out of %{total} successfully","close":"close","item":{"pending":"Pending"},"alert":{"success":"%{smart_count} photo uploaded with success. |||| %{smart_count} photos uploaded with success.","success_conflicts":"%{smart_count} photo uploaded with %{conflictNumber} conflict(s). |||| %{smart_count} photos uploaded with %{conflictNumber} conflict(s).","errors":"Errors occurred during the photos upload."}},"quotaalert":{"title":"Your disk space is full :(","desc":"Please remove files, empty your trash or increase your disk space before uploading files again.","confirm":"OK","increase":"Increase your disk space"},"button":{"back":"Back"},"Backup":{"header":{"title":"Backup my photos & videos"},"actions":{"verification":"Verification","startBackup":"Start backup","backupInProgress":"Backup in progress","saved":"Saved","cancel":"Cancel"},"description":{"first":"Backing up can take some time and be particularly data-intensive. Choose to connect to a Wi-Fi network, or make sure you have unlimited Internet access with good bandwidth to get started.","second":"You can leave the application in the background when saving, but the phone must remain switched on."},"info":{"elements":"%{smart_count} element |||| %{smart_count} elements","notBackedUpElements":"%{smart_count} element not backed up |||| %{smart_count} elements not backed up","pressStartBackup":"Press \\"Start backup\\" to keep them safe in your Cozy."},"InstallAppAlert":{"description":"To save all your mobile photos and videos on your Cozy, please install our Personal Cloud - Cozy application","install":"Install"},"AllowPermissionsModal":{"title":"Allow access to your photos and videos","description":"Cozy needs access to the photos and videos stored on your device in order to synchronize them.","cancel":"Cancel","allow":"Allow"}}}')},"2sk9":function(e,t,n){e.exports={"u-card":"u-card--1LMvZ","u-debug":"u-debug--Dvf4q","u-shake":"u-shake--301R8",shake:"shake--Hx9aG","u-elevation-1":"u-elevation-1--_bAw8","u-filter-gray-100":"u-filter-gray-100--1mFsr","u-o-100":"u-o-100--1l6_J","u-o-90":"u-o-90--Vl2PX","u-o-80":"u-o-80--1iZh6","u-o-70":"u-o-70--1Orn8","u-o-60":"u-o-60--29A2S","u-o-50":"u-o-50--1vWRz","u-o-40":"u-o-40--23WHb","u-o-30":"u-o-30--C42_r","u-o-20":"u-o-20--Wp1zJ","u-o-10":"u-o-10--1yTAG","u-o-05":"u-o-05--1IKgP","u-o-025":"u-o-025--2gpCh","u-o-0":"u-o-0--2YnvF","fil-confirm-text":"fil-confirm-text--3OV-5","icon-trash":"icon-trash--2L617","icon-restore":"icon-restore--qTvX6","icon-shared":"icon-shared--2ytpg","icon-related":"icon-related--3HRWq","icon-eye":"icon-eye--2EIWz","icon-link":"icon-link--2hb-A","icon-forbidden":"icon-forbidden--23UiV",spin:"spin--3SvvM"}},3:function(e,t){},4:function(e,t){},5:function(e,t){},"59mS":function(e,t,n){e.exports={"u-card":"u-card--2A4F_","u-debug":"u-debug--239uE","u-shake":"u-shake--jsFDP",shake:"shake--3-Vkv","u-elevation-1":"u-elevation-1--2nz2m","u-filter-gray-100":"u-filter-gray-100--3z1C_","u-o-100":"u-o-100--3NgxQ","u-o-90":"u-o-90--1HDpO","u-o-80":"u-o-80--1I9nb","u-o-70":"u-o-70--3QV-j","u-o-60":"u-o-60--1QLxy","u-o-50":"u-o-50--jArI6","u-o-40":"u-o-40--3Q8vH","u-o-30":"u-o-30--3LyB0","u-o-20":"u-o-20--3Aqqq","u-o-10":"u-o-10--3v5K_","u-o-05":"u-o-05--2aGws","u-o-025":"u-o-025--2bvm8","u-o-0":"u-o-0--h266O",spin:"spin--2CdRK"}},"5ZYL":function(e,t,n){e.exports={"pho-loading":"pho-loading--2vILC","pho-empty":"pho-empty--2ISCA"}},6:function(e,t){},"6qED":function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--1b8qa","CozyTheme--normal":"CozyTheme--normal--1C24e","pho-album-list":"pho-album-list--3W0t6","pho-album-list--thumbnails":"pho-album-list--thumbnails--3FASv","pho-album":"pho-album--nBuXk","pho-album-link":"pho-album-link--1J30Z","pho-album-photo-item":"pho-album-photo-item--18xZx","pho-album-title":"pho-album-title--1N0Rf","pho-album-description":"pho-album-description--3z6S7","pho-album-shared":"pho-album-shared--2T6ed","pho-album-list--selectable":"pho-album-list--selectable--1eSpV","pho-album-link--disabled":"pho-album-link--disabled--309dC"}},7:function(e,t){},9:function(e,t,n){n("55Il"),e.exports=n("oGE2")},A5W6:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var a=n("SH7X"),r=n("z6Q1"),o=function(){return{definition:Object(a.Q)("io.cozy.files").where({class:"image","metadata.datetime":{$gt:null}}).partialIndex({trashed:!1}).indexFields(["class","metadata.datetime"]).select(["dir_id","name","size","updated_at","metadata","metadata.datetime","trashed","class"]).sortBy([{class:"desc"},{"metadata.datetime":"desc"}]).include(["albums"]),options:{as:"timeline",fetchPolicy:a.fetchPolicies.olderThan(3e4)}}},c=function(e){return{definition:Object(a.Q)(r.a).getById(e).include(["photos"]),options:{as:"albums-".concat(e),singleDocData:!0}}}},AzIT:function(e,t,n){e.exports={"coz-banner-client":"coz-banner-client--xEL17"}},"C/eS":function(e,t,n){e.exports={"pho-panel-form":"pho-panel-form--1S6en","coz-form":"coz-form--cCo_s","coz-form-group":"coz-form-group--1I069","coz-form-desc":"coz-form-desc--3FnDz","coz-form-label":"coz-form-label--385WH","coz-form-label--error":"coz-form-label--error--1Kr_k","coz-form-errors":"coz-form-errors--1RCYk",error:"error--3qEb3","CozyTheme--inverted":"CozyTheme--inverted--1gTN-","CozyTheme--normal":"CozyTheme--normal--1I94S","pho-panel":"pho-panel--vFzlq","pho-panel-header":"pho-panel-header--2aCpb","pho-panel-footer":"pho-panel-footer--2Ynjt","pho-panel-controls":"pho-panel-controls--1UDSQ","pho-panel-content":"pho-panel-content--2OXQJ","pho-panel-wrap":"pho-panel-wrap--1OkG3",spin:"spin--t2Bmx",shake:"shake--2MjHG"}},D575:function(e,t,n){e.exports={"coz-select-album":"coz-select-album--20TzS"}},FKqX:function(e){e.exports=JSON.parse('{"promoteDesktop":{"isActivated":true}}')},"G0/2":function(e,t,n){var a={"./en.json":"6wRk","./fr.json":"wNxD"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id="G0/2"},Gofk:function(e,t,n){var a={"./en":"2OO4","./en.json":"2OO4"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id="Gofk"},IFYe:function(e,t,n){"use strict";var a=n("9jFK");n("ZsPO");t.a=a},KOJc:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n("pVnL"),r=n.n(a),o=n("q1tI"),c=n.n(o),i=n("TSYQ"),l=n.n(i),s=n("buk/"),u=n("GoJ1"),d=n("o+ty"),p=n("46CF"),m=n("7Zso"),f=function(e){return c.a.createElement("svg",r()({viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),c.a.createElement("path",{opacity:"0.34",fillRule:"evenodd",clipRule:"evenodd",d:"M12.9657 1C13.5206 1 14.2876 1.3125 14.6803 1.6995L16 3H30.0059C31.1072 3 32 3.89498 32 4.997V27.003C32 28.1059 31.1107 29 29.9983 29H2.00174C0.896211 29 0 28.1001 0 27.0088V1.99653C0 1.44616 0.448999 1 1.00472 1H12.9657Z",fill:"#297EF2"}),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 1C0.447715 1 0 1.44772 0 2V6C0 6.55228 0.447716 7 1 7H13.5858C13.851 7 14.1054 6.89464 14.2929 6.70711L15.7071 5.29289C15.8946 5.10536 16.149 5 16.4142 5H32C32 3.89543 31.1046 3 30 3H16.4142C16.149 3 15.8946 2.89464 15.7071 2.70711L14.2929 1.29289C14.1054 1.10536 13.851 1 13.5858 1H1ZM10 15.9954V24.0046C10 24.5543 10.4558 25 11.0025 25H20.9975C21.5512 25 22 24.5443 22 24.0046V15.9954C22 15.4457 21.5561 15 21 15H20V13C20 10.794 18.2053 9 16 9C13.794 9 12 10.794 12 13V15H11C10.4477 15 10 15.4557 10 15.9954ZM16 11C14.8968 11 14 12.1215 14 13.5V15H18V13.5C18 12.1215 17.1028 11 16 11ZM17.5 19C17.5 18.172 16.8265 17.5 16 17.5C15.172 17.5 14.5 18.172 14.5 19C14.5 19.552 14.803 20.032 15.25 20.29V22.75C15.25 23.1625 15.586 23.5 16 23.5C16.4125 23.5 16.75 23.1625 16.75 22.75V20.29C17.1955 20.032 17.5 19.552 17.5 19Z",fill:"#297EF2"}))},h=n("lJfM"),b=n.n(h),y={drive:d.a,encrypted:f,photos:m.a,trash:p.a},v=function(e){var t=e.type,n=e.canUpload,a=e.localeKey,r=Object(s.useI18n)().t;return c.a.createElement(u.a,{"data-testid":"empty-folder",icon:y[t],title:r(a?"empty.".concat(a,"_title"):"empty.title"),text:a&&r("empty.".concat(a,"_text"))||n&&r("empty.text"),className:l()(b.a.empty,"u-mh-2")})},g=function(e){return c.a.createElement(v,r()({type:"photos"},e))}},McP2:function(e,t,n){e.exports={"pho-backup-wrapper":"pho-backup-wrapper--34t7M","pho-backup-info-wrapper":"pho-backup-info-wrapper--MDLB_","pho-backup-info-field":"pho-backup-info-field--XHDTn"}},NqoY:function(e,t,n){"use strict";var a=n("lwsE"),r=n.n(a),o=n("W8MJ"),c=n.n(o),i=n("7W2i"),l=n.n(i),s=n("a1gu"),u=n.n(s),d=n("Nsbk"),p=n.n(d),m=n("z6Q1"),f=n("Le8U"),h=n("SH7X");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var y=function(e){l()(n,e);var t=b(n);function n(){return r()(this,n),t.apply(this,arguments)}return c()(n,[{key:"data",get:function(){var e=this,t=this.target.relationships.referenced_by.data;return t?t.map((function(t){return e.get(t.type,t.id)})).filter(Boolean):[]}}],[{key:"query",value:function(e,t,n){if(!e.relationships||!e.relationships.referenced_by||!e.relationships.referenced_by.data)return null;var a=e.relationships.referenced_by.data.filter((function(e){return e.type===n.doctype})).map((function(e){return e.id}));return new h.QueryDefinition({doctype:n.doctype,ids:a})}}]),n}(h.HasMany);t.a={albums:{doctype:m.a,attributes:{name:{type:"string"}},relationships:{photos:{type:"has-many",doctype:m.c}}},files:{doctype:m.c,relationships:{albums:{type:y,doctype:m.a}}},contacts:{doctype:f.Contact.doctype}}},OTOu:function(e,t,n){"use strict";var a=n("btPC"),r=n.n(a),o=r()("cozy-".concat("photos"));r.a.enable(),r.a.suggest.allow("cozy-".concat("photos"),"log"),r.a.suggest.allow("cozy-".concat("photos"),"info"),t.a=o},OjRq:function(e,t,n){"use strict";n.d(t,"b",(function(){return a.CozyFile})),n.d(t,"c",(function(){return a.Group})),n.d(t,"a",(function(){return b}));var a=n("Le8U"),r=n("lwsE"),o=n.n(r),c=n("W8MJ"),i=n.n(c),l=n("7W2i"),s=n.n(l),u=n("a1gu"),d=n.n(u),p=n("Nsbk"),m=n.n(p),f=n("FiiU");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m()(e);if(t){var r=m()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return d()(this,n)}}var b=function(e){s()(n,e);var t=h(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,null,[{key:"getInitials",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(n.isContact(e))return Object(f.getInitials)(e);var a=e.public_name||e.name||e.email;return a&&a[0].toUpperCase()||t}},{key:"getDisplayName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return n.isContact(e)?Object(f.getDisplayName)(e):e.public_name||e.name||e.email||t}}]),n}(a.Contact)},RPnM:function(e,t,n){"use strict";var a=n("lwsE"),r=n.n(a),o=n("W8MJ"),c=n.n(o),i=n("7W2i"),l=n.n(i),s=n("a1gu"),u=n.n(s),d=n("Nsbk"),p=n.n(d),m=n("kKu1"),f=n.n(m),h=n("q1tI"),b=n.n(h),y=n("yRsm"),v=n("V2U0"),g=n("yoMi");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var _=function(e){l()(n,e);var t=E(n);function n(e){var a;return r()(this,n),(a=t.call(this,e)).state={fetching:!1},a}return c()(n,[{key:"handleClick",value:function(){var e=this;this.setState({fetching:!0}),this.props.onClick().then((function(){return e.setState({fetching:!1})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,a=t.width,r=void 0===a?"100%":a,o=this.state.fetching;return b.a.createElement("div",{style:{width:r},className:f.a["pho-list-morebutton"]},o&&b.a.createElement(y.a,{disabled:!0,theme:"secondary",label:b.a.createElement(v.b,{color:g.dodgerBlue,nomargin:!0})}),!o&&b.a.createElement(y.a,{theme:"secondary",onClick:function(){return e.handleClick()},label:n}))}}]),n}(h.Component);t.a=_},SvPG:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v}));var a=n("pVnL"),r=n.n(a),o=n("QILm"),c=n.n(o),i=n("q1tI"),l=n.n(i),s=n("buk/"),u=n("yRsm"),d=n("Pxjx"),p=n("swni"),m=n.n(p),f=["disabled","onClick"],h=function(e){var t=e.disabled,n=e.onClick,a=c()(e,f),o=Object(s.useI18n)().t;return l.a.createElement(u.a,r()({"data-testid":"more-button",className:m.a["dri-btn--more"],theme:"secondary",disabled:t,onClick:n,extension:"narrow",icon:d.a,iconOnly:!0,label:o("Toolbar.more")},a))},b=n("17x9"),y=function(e){var t=e.className,n=Object(s.useI18n)().t;return l.a.createElement(u.b,{label:n("Share.create-cozy"),icon:"cloud",className:t,href:"https://manager.cozycloud.cc/cozy/create",size:"normal"})};y.propTypes={from:n.n(b).a.string},y.defaultProps={from:""};var v=y},SvWF:function(e,t,n){"use strict";n.d(t,"b",(function(){return h}));var a=n("q1tI"),r=n.n(a),o=n("buk/"),c=n("GoJ1"),i=n("yRsm"),l=n("4BeY"),s=n.n(l),u=n("IaFt"),d=n.n(u),p=new s.a({id:"icon-image-broken_a4fd70a7dc9c96a1d21491390660382c",use:"icon-image-broken_a4fd70a7dc9c96a1d21491390660382c-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="icon-image-broken_a4fd70a7dc9c96a1d21491390660382c">\n  <g fill="none" fill-rule="evenodd" transform="translate(0 2)">\n    <rect width="32" height="28" fill="#FDD5D5" rx="2" />\n    <path fill="#F52D2D" d="M24,20 L13,15 L19.2902805,8.70971949 C19.6822478,8.31775224 20.3203148,8.32031476 20.7062149,8.7062149 L29,17 L24,20 Z" />\n    <path fill="#F52D2D" d="M0,22 L6.29028051,15.7097195 C6.68224776,15.3177522 7.31387329,15.3138733 7.70591205,15.7059121 L11,19 L15.0233154,14.9766846 L24,19 L27.2486572,17.2486572 L32,22 L32,26.0020869 C32,27.1055038 31.1107383,28 29.9982567,28 L2.00174332,28 C0.89621101,28 0,27.1017394 0,26.0020869 L0,22 Z" />\n    <circle cx="8" cy="7" r="3" fill="#FFFFFF" />\n    <path stroke="#FDD5D5" d="M11,18.3000031 L5.5,23.8000031 L11,18.3000031 Z" stroke-linecap="round" stroke-linejoin="round" />\n    <polyline stroke="#FFFFFF" stroke-width="2" points="0 17 8 13 24 20 32 16" stroke-linecap="round" stroke-linejoin="round" />\n  </g>\n</symbol>'}),m=(d.a.add(p),p),f=Object(o.translate)()((function(e){var t=e.t,n=e.errorType;return r.a.createElement(c.a,{title:t("Error.".concat(n,"_title")),icon:m},r.a.createElement(i.c,{onClick:function(){return window.location.reload()},label:t("Error.refresh")}))})),h=function(e,t,n){return function(a){return e(a)?r.a.createElement(f,{errorType:t}):r.a.createElement(n,a)}};t.a=f},TtgU:function(e,t,n){"use strict";var a=n("lwsE"),r=n.n(a),o=n("W8MJ"),c=n.n(o),i=n("7W2i"),l=n.n(i),s=n("a1gu"),u=n.n(s),d=n("Nsbk"),p=n.n(d),m=n("kKu1"),f=n.n(m),h=n("q1tI"),b=n.n(h),y=n("CMvH"),v=n("buk/"),g=n("sIaW"),E=n.n(g),_=n("TSYQ"),w=n.n(_),k=n("lSNA"),O=n.n(k),j=n("SOjZ"),x=n("6se/"),C=function(e){var t=e.photo,n=e.box,a=e.selected,r=void 0!==a&&a,o=e.onToggle,c=function(e){var t={};return e&&(e.width&&(t.width="".concat(e.width,"px")),e.height&&(t.height="".concat(e.height,"px")),e.top&&(t.top="".concat(e.top,"px")),e.left&&(t.left="".concat(e.left,"px"))),t}(n);return b.a.createElement("div",{style:c,"data-test-item":t.name,className:w()(f.a["pho-photo"],O()({},f.a["pho-photo--selected"],r))},b.a.createElement("div",null,b.a.createElement("span",{className:f.a["pho-photo-select"],"data-input":"checkbox",onClick:function(e){e.stopPropagation(),o(t,r)}},b.a.createElement("input",{type:"checkbox",checked:r,onChange:function(){}}),b.a.createElement("label",null)),b.a.createElement(j.b,{to:t.id},b.a.createElement(x.a,{file:t,linkType:"small",render:function(e){return b.a.createElement("img",{"data-testid":"pho-photo-item",src:e,className:f.a["pho-photo-item"],style:c})}}))))};function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var P={width:1,height:1},S=function(e){return 180+(e||1800)/30},z=function(e){l()(n,e);var t=A(n);function n(){return r()(this,n),t.apply(this,arguments)}return c()(n,[{key:"isPhotoSelected",value:function(e,t){return-1!==t.map((function(e){return e._id})).indexOf(e._id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,a=t.key,r=t.title,o=t.photos,c=t.selected,i=t.showSelection,l=t.onPhotoToggle,s=t.onPhotosSelect,u=t.onPhotosUnselect,d=t.containerWidth;if(!d)return null;var p=d>=768?{spacing:16,padding:32}:{spacing:8,padding:0},m=E()(o.map((function(e){var t=e.metadata||e.attributes.metadata;return t&&t.width&&t.height?function(e){return e.orientation&&e.orientation>4?{width:e.height,height:e.width}:e}(t):P})),{containerWidth:d,targetRowHeight:S(d),boxSpacing:{horizontal:p.spacing,vertical:p.spacing},containerPadding:{top:0,right:p.padding,bottom:0,left:p.padding}}),h=c.map((function(e){return e._id})),y=o.every((function(e){return-1!==h.indexOf(e._id)})),v=m.boxes[0].top,g=m.boxes.findIndex((function(e){return e.top!==v})),_=-1===g?m.boxes[m.boxes.length-1]:m.boxes[g-1],k=d-_.left-_.width-p.padding;return b.a.createElement("div",{"data-testid":"photo-section",className:w()(f.a["pho-section"],i&&f.a["pho-section--has-selection"]),key:a,style:{width:"".concat(d,"px")}},b.a.createElement("div",{className:f.a["pho-section-header"]},b.a.createElement("h3",null,r),i&&o.length>1&&y&&b.a.createElement("a",{style:{marginRight:"".concat(k,"px")},onClick:function(){return u(o)}},n("Board.unselect_all")),i&&o.length>1&&!y&&b.a.createElement("a",{style:{marginRight:"".concat(k,"px")},onClick:function(){return s(o)}},n("Board.select_all"))),b.a.createElement("div",{className:f.a["pho-photo-wrapper"],style:{width:"".concat(d,"px"),height:"".concat(m.containerHeight,"px")}},o.map((function(t,n){return b.a.createElement(C,{photo:t,box:m.boxes[n],key:t.id+n,selected:e.isPhotoSelected(t,c),onToggle:l})}))))}}]),n}(h.Component),R=Object(v.translate)()(z),N=n("KOJc"),T=n("ZFPb"),D=n("SvWF"),B=n("RPnM");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var q=function(e){l()(n,e);var t=M(n);function n(){return r()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.f,a=e.lists,r=e.selected,o=e.photosContext,c=e.showSelection,i=e.onPhotoToggle,l=e.onPhotosSelect,s=e.onPhotosUnselect,u=e.fetchStatus,d=e.hasMore,p=e.fetchMore,m=e.measureRef,h=e.contentRect.entry.width,y=e.lastFetch,v=("pending"===u||"loading"===u)&&!y;return"failed"===u?b.a.createElement(D.a,{errorType:"".concat(o,"_photos")}):v?b.a.createElement(T.a,{loadingType:"photos_fetching"}):v||0!==a.length&&0!==a[0].photos.length?b.a.createElement("div",{className:c?f.a["pho-list-selection"]:"",ref:m},a.map((function(e,t){return b.a.createElement(R,{key:t,title:e.title||(e.month?n(e.month,"MMMM YYYY"):""),photos:e.photos,selected:r,showSelection:c,onPhotoToggle:i,onPhotosSelect:l,onPhotosUnselect:s,containerWidth:h})})),d&&b.a.createElement(B.a,{label:t("Board.load_more"),width:h,onClick:p})):b.a.createElement(N.a,{localeKey:"".concat(o,"_photos")})}}]),n}(h.Component);t.a=Object(v.translate)()(Object(y.a)()(q))},VZRP:function(e,t,n){e.exports={"pho-content-title":"pho-content-title--3Yt9z",error:"error--2qbV5","pho-content-header":"pho-content-header--1M4IS","--hide-bar":"_--hide-bar--lrytb","pho-content-album-previous":"pho-content-album-previous--3BqBh",spin:"spin--1ZeSG",shake:"shake--3WZrZ"}},"XA+M":function(e,t){e.exports={name:"Drive",name_prefix:"Cozy",slug:"drive",version:"1.55.0",type:"webapp",licence:"AGPL-3.0",icon:"public/app-icon.svg",categories:["cozy"],source:"https://github.com/cozy/cozy-drive",editor:"Cozy",developer:{name:"Cozy Cloud",url:"https://cozy.io"},locales:{en:{short_description:"Cozy Drive helps you to save, sync and secure your files on your Cozy.",long_description:"With Cozy Drive, you can easily:\n- Store your important files and keep them secure in your Cozy\n- Access to all your documents online & offline, from your desktop, and on your smartphone or tablet\n- Share links to files ans folders with who you like;\n- Automatically retrieve bills, payrolls, tax notices and other data from your main online services (internet, energy, retail, mobile, energy, travel...)\n- Upload files to your Cozy from your Android",screenshots:["screenshots/en/screenshot01.png","screenshots/en/screenshot02.png","screenshots/en/screenshot03.png","screenshots/en/screenshot04.png"]},fr:{short_description:"Cozy Drive est l’application de sauvegarde, de synchronisation et de sécurisation de tous vos fichiers sur Cozy.",long_description:"Avec Cozy Drive vous pourrez :\n- Sauvegarder et synchroniser gratuitement tous vos documents importants (carte d’identité, photos de vacances, avis d’imposition, fiches de salaires…);\n- Accéder à vos documents n’importe quand, n’importe ou même en mode avion depuis votre bureau, votre smartphone ou tablette;\n- Partager vos fichiers et dossiers par lien avec qui vous le souhaitez;\n- Récupérer automatiquement vos documents administratifs de vos principaux fournisseurs de service (opérateur mobile, fournisseur d’énergie, assureur, internet, santé…);\n- Rester synchronisé·e lors de vos voyages et déplacements professionnels avec nos applications mobiles.",screenshots:["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png","screenshots/fr/screenshot03.png","screenshots/fr/screenshot04.png"]}},screenshots:["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png","screenshots/fr/screenshot03.png","screenshots/fr/screenshot04.png"],langs:["en","fr"],routes:{"/":{folder:"/",index:"index.html",public:!1},"/intents":{folder:"/intents",index:"index.html",public:!1},"/public":{folder:"/public",index:"index.html",public:!0},"/preview":{folder:"/public",index:"index.html",public:!0}},intents:[{action:"OPEN",type:["io.cozy.files"],href:"/intents"},{action:"GET_URL",type:["io.cozy.files"],href:"/intents"},{action:"OPEN",type:["io.cozy.suggestions"],href:"/intents"}],services:{qualificationMigration:{type:"node",file:"services/qualificationMigration/drive.js",trigger:"@event io.cozy.files:CREATED,UPDATED",debounce:"24h"},dacc:{type:"node",file:"services/dacc/drive.js",trigger:"@monthly on the 5-7 between 2pm and 7pm"}},permissions:{files:{description:"Required to access the files",type:"io.cozy.files",verbs:["ALL"]},allFiles:{description:"Required to access the files",type:"io.cozy.files.*",verbs:["ALL"]},apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET"]},sharings:{description:"Required to have access to the sharings in realtime",type:"io.cozy.sharings",verbs:["GET"]},albums:{description:"Required to manage photos albums",type:"io.cozy.photos.albums",verbs:["PUT","GET"]},contacts:{type:"io.cozy.contacts",verbs:["GET","POST"]},groups:{type:"io.cozy.contacts.groups",verbs:["GET"]},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]},oauth:{description:"Required to display the cozy-desktop banner",type:"io.cozy.oauth.clients",verbs:["GET"]},errorsreporting:{description:"Allow to report unexpected errors to the support team",type:"cc.cozycloud.errors",verbs:["POST"]},mail:{description:"Send feedback emails to the support team",type:"io.cozy.jobs",verbs:["POST"],selector:"worker",values:["sendmail"]},konnectors:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.konnectors",verbs:["GET"]},accounts:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.accounts",verbs:["GET"]},triggers:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.triggers",verbs:["GET"]},dacc:{type:"cc.cozycloud.dacc_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized measures to the DACC shared among mycozy.cloud's Cozy."},"dacc-eu":{type:"eu.mycozy.dacc_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized measures to the DACC shared among mycozy.eu's Cozy."}}}},Yo2A:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b}));var a=n("fvjX"),r=n("lSNA"),o=n.n(r),c=n("q1tI"),i=n.n(c),l=n("Vg22");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1,component:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODAL":return{show:!0,component:t.component};case"HIDE_MODAL":return{show:!1,component:null};default:return e}},d=function(e){return{type:"SHOW_MODAL",component:e,meta:{hideActionMenu:!0}}},p=Object(l.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.ui.modal)}))((function(e){var t=e.show,n=e.component,a=e.dispatch;return t?i.a.cloneElement(n,{onClose:function(e){return a(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"HIDE_MODAL",meta:e}}(e))}}):null})),m=n("J4zp"),f=n.n(m),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=f()(t,2),a=n[0],r=n[1],o=void 0===r||r;return e[a]=decodeURIComponent(o),e},b=function(){return window.location.search.substring(1).split("&").map((function(e){return e.split("=")})).reduce(h,{})};t.b=Object(a.combineReducers)({modal:u})},ZFPb:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),o=n("TSYQ"),c=n.n(o),i=n("buk/"),l=n("V2U0"),s=n("7jrE"),u=n.n(s),d=n("5ZYL"),p=n.n(d);t.a=Object(i.translate)()((function(e){var t=e.size,n=void 0===t?"xxlarge":t,a=e.loadingType,o=e.noMargin,i=void 0!==o&&o,s=e.middle,d=void 0===s||s;return r.a.createElement("div",{"data-testid":"loading",className:c()(p.a["pho-loading"])},r.a.createElement(l.b,{size:n,loadingType:a,color:u.a.dodgerBlue,noMargin:i,middle:d}))}))},cwrA:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f}));var a=n("q1tI"),r=n.n(a),o=n("V5US"),c=n("s0VD"),i=n("TBZM"),l=n("/dzn"),s=n("EhdM"),u=n("V4z/"),d=n("SH7X"),p=n("A5W6"),m=function(){var e=Object(p.b)(),t=Object(d.useQuery)(e.definition,e.options);return"loaded"!=t.fetchStatus?null:r.a.createElement(h,{photos:t.data})},f=function(){var e=Object(u.q)().albumId,t=Object(p.a)(e),n=Object(d.useQuery)(t.definition,t.options);return"loaded"!=n.fetchStatus?null:r.a.createElement(h,{photos:n.data.photos.data})},h=function(e){var t=e.photos,n=Object(u.o)(),d=Object(u.q)().photoId,p=Object(a.useMemo)((function(){return t?t.findIndex((function(e){return e.id===d})):0}),[t,d]);return r.a.createElement(o.a,null,r.a.createElement(c.a,{files:t,currentIndex:p,onChangeRequest:function(e){return n("../".concat(e.id))},onCloseRequest:function(){return n("..")}},r.a.createElement(i.a,null,r.a.createElement(s.a,null),r.a.createElement(l.a,null))))}},dBw4:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),o=(n("59mS"),n("3FT0"),n("xIbs"));t.a=function(e){var t=e.children;return r.a.createElement(o.a,null,t)}},kGy0:function(e,t,n){var a={"./en.json":"8WAw","./fr.json":"H488"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id="kGy0"},kKu1:function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--lQY3Q","CozyTheme--normal":"CozyTheme--normal--21hb4","pho-section":"pho-section--aOGQ8","pho-photo-wrapper":"pho-photo-wrapper--34Af_","pho-section-header":"pho-section-header--3xCwP","pho-photo":"pho-photo--1RccV","pho-photo-item":"pho-photo-item--1uvPt","pho-photo-select":"pho-photo-select--2_YlY","pho-photo--selected":"pho-photo--selected--3CHFZ","pho-section--has-selection":"pho-section--has-selection--2A-rj","pho-list-morebutton":"pho-list-morebutton--1HHd8",spin:"spin--3HNuy",shake:"shake--p49Dg"}},lEMr:function(e,t,n){e.exports={"upload-queue":"upload-queue--2RXFj","CozyTheme--inverted":"CozyTheme--inverted--3LpFU","CozyTheme--normal":"CozyTheme--normal--3194H","upload-queue--visible":"upload-queue--visible--frmGj","upload-queue-header":"upload-queue-header--Vz871","upload-queue-header-inner":"upload-queue-header-inner--1AQpy","btn-close":"btn-close--32K_q","upload-queue-progress":"upload-queue-progress--2O2Rw","upload-queue-content":"upload-queue-content--UNBUz","upload-queue--collapsed":"upload-queue--collapsed--nIVVP","upload-queue-list":"upload-queue-list--2dzTR","upload-queue-item--error":"upload-queue-item--error--3UNkr","upload-queue-item--done":"upload-queue-item--done--23Ps1","upload-queue-item":"upload-queue-item--2oTRx","item-cell":"item-cell--1mZJx","item-file":"item-file--24emt","item-ext":"item-ext--3vgYK","item-image":"item-image--wp0ZG","item-status":"item-status--2Azg6","item-pending":"item-pending--wp4pw",spin:"spin--3291m",shake:"shake--eSk8B"}},lJfM:function(e,t,n){e.exports={empty:"empty--18MhH"}},luXY:function(e,t,n){e.exports={"pho-create-album-form":"pho-create-album-form--xgUhP",error:"error--2VcpR","CozyTheme--inverted":"CozyTheme--inverted--YSD9X","CozyTheme--normal":"CozyTheme--normal--knWRd","coz-create-album-label":"coz-create-album-label--2zpY4","coz-inline-form":"coz-inline-form--3COco","coz-input-text":"coz-input-text--ZuuYG","create-button":"create-button--1cJgR",spin:"spin--1T4Vk",shake:"shake--3cnvd"}},nEYx:function(e,t,n){"use strict";var a=n("lSNA"),r=n.n(a),o=n("TSYQ"),c=n.n(o),i=n("q1tI"),l=n.n(i),s=n("17x9"),u=n.n(s),d=n("asgm"),p=n("y6ex"),m=n("1soK"),f=n("t0Aa"),h=n.n(f),b=function(e){var t=e.label,n=e.inMenu,a=e.disabled,o=e.onUpload,i=e.className;return l.a.createElement(d.a,{accept:"image/*",className:c()(i,r()({},"".concat(h.a["c-btn"]),!n)),"data-testid":"upload-btn",disabled:a,multiple:!0,onChange:o,value:[]},l.a.createElement("span",null,!n&&l.a.createElement(p.default,{icon:m.a}),l.a.createElement("span",null,t)))};b.propTypes={label:u.a.string.isRequired,disabled:u.a.bool,inMenu:u.a.bool,onUpload:u.a.func.isRequired,className:u.a.string.isRequired},b.defaultProps={disabled:!1,inMenu:!1},t.a=b},nS3w:function(e,t,n){"use strict";var a=n("J4zp"),r=n.n(a),o=n("q1tI"),c=n.n(o),i=n("17x9"),l=n.n(i),s=n("8Z8b"),u=n("mQgz"),d=n("SvPG"),p=function(e){var t=e.actions,n=Object(o.useRef)(null),a=Object(o.useState)(!1),i=r()(a,2),l=i[0],p=i[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{ref:n},c.a.createElement(d.b,{"aria-controls":"more-menu","aria-haspopup":"true",onClick:function(){p(!l)}})),c.a.createElement(s.a,{disableEnforceFocus:!0,disableRestoreFocus:!0,id:"more-menu",ref:n,open:l,actions:Object(u.c)(t),anchorOrigin:{vertical:"bottom",horizontal:"right"},autoClose:!0,onClose:function(){return p(!1)}}))};p.propTypes={actions:l.a.array.isRequired},t.a=p},nw0P:function(e,t,n){var a={"./_lib/build_formatting_tokens_reg_exp/index.js":"kOWh","./ar/build_distance_in_words_locale/index.js":"XxX6","./ar/build_format_locale/index.js":"alis","./ar/index.js":"EDRf","./be/build_distance_in_words_locale/index.js":"LQ09","./be/build_format_locale/index.js":"kj7F","./be/index.js":"YEhR","./bg/build_distance_in_words_locale/index.js":"7K3h","./bg/build_format_locale/index.js":"RrdL","./bg/index.js":"isx8","./ca/build_distance_in_words_locale/index.js":"wqqj","./ca/build_format_locale/index.js":"qcV0","./ca/index.js":"Vwa+","./cs/build_distance_in_words_locale/index.js":"ZKDM","./cs/build_format_locale/index.js":"ipyF","./cs/index.js":"dvhP","./da/build_distance_in_words_locale/index.js":"2Mgc","./da/build_format_locale/index.js":"Gned","./da/index.js":"7ur/","./de/build_distance_in_words_locale/index.js":"5IWf","./de/build_format_locale/index.js":"THCn","./de/index.js":"bgw5","./el/build_distance_in_words_locale/index.js":"o/GB","./el/build_format_locale/index.js":"8T9h","./el/index.js":"dH0v","./en/build_distance_in_words_locale/index.js":"LZbM","./en/build_format_locale/index.js":"6DAA","./en/index.js":"Us+F","./eo/build_distance_in_words_locale/index.js":"qrnn","./eo/build_format_locale/index.js":"Bl15","./eo/index.js":"UB7v","./es/build_distance_in_words_locale/index.js":"GEfZ","./es/build_format_locale/index.js":"O+zC","./es/index.js":"/S0t","./fi/build_distance_in_words_locale/index.js":"VHtQ","./fi/build_format_locale/index.js":"Oydx","./fi/index.js":"ndVD","./fil/build_distance_in_words_locale/index.js":"uq4p","./fil/build_format_locale/index.js":"d7hw","./fil/index.js":"pNfm","./fr/build_distance_in_words_locale/index.js":"IzMR","./fr/build_format_locale/index.js":"I3Zg","./fr/index.js":"LKA2","./hr/build_distance_in_words_locale/index.js":"DPvn","./hr/build_format_locale/index.js":"puw3","./hr/index.js":"L9Jq","./hu/build_distance_in_words_locale/index.js":"w2RQ","./hu/build_format_locale/index.js":"/0iD","./hu/index.js":"Nm+E","./id/build_distance_in_words_locale/index.js":"JbvB","./id/build_format_locale/index.js":"0wlw","./id/index.js":"A6C3","./is/build_distance_in_words_locale/index.js":"qzMC","./is/build_format_locale/index.js":"S3yD","./is/index.js":"N4bE","./it/build_distance_in_words_locale/index.js":"MDEp","./it/build_format_locale/index.js":"aUJd","./it/index.js":"hmb4","./ja/build_distance_in_words_locale/index.js":"nNvt","./ja/build_format_locale/index.js":"buui","./ja/index.js":"uAXs","./ko/build_distance_in_words_locale/index.js":"oEw+","./ko/build_format_locale/index.js":"9SQf","./ko/index.js":"iW8+","./mk/build_distance_in_words_locale/index.js":"nmwZ","./mk/build_format_locale/index.js":"htxJ","./mk/index.js":"GzBU","./nb/build_distance_in_words_locale/index.js":"SL1f","./nb/build_format_locale/index.js":"CJ5F","./nb/index.js":"73vv","./nl/build_distance_in_words_locale/index.js":"Uyu0","./nl/build_format_locale/index.js":"doCD","./nl/index.js":"hCQt","./pl/build_distance_in_words_locale/index.js":"FUBD","./pl/build_format_locale/index.js":"nOYf","./pl/index.js":"B6yL","./pt/build_distance_in_words_locale/index.js":"aTPA","./pt/build_format_locale/index.js":"TTT0","./pt/index.js":"gdks","./ro/build_distance_in_words_locale/index.js":"gI+A","./ro/build_format_locale/index.js":"njjO","./ro/index.js":"r2yp","./ru/build_distance_in_words_locale/index.js":"KmPx","./ru/build_format_locale/index.js":"UUBw","./ru/index.js":"nz/o","./sk/build_distance_in_words_locale/index.js":"q2Bs","./sk/build_format_locale/index.js":"9sxn","./sk/index.js":"Wqan","./sl/build_distance_in_words_locale/index.js":"mlv2","./sl/build_format_locale/index.js":"vHkZ","./sl/index.js":"KYSo","./sr/build_distance_in_words_locale/index.js":"LlkS","./sr/build_format_locale/index.js":"RhjJ","./sr/index.js":"7mU3","./sv/build_distance_in_words_locale/index.js":"UNBN","./sv/build_format_locale/index.js":"zTNB","./sv/index.js":"hxgj","./th/build_distance_in_words_locale/index.js":"XAGa","./th/build_format_locale/index.js":"We2s","./th/index.js":"Pk+z","./tr/build_distance_in_words_locale/index.js":"aFZF","./tr/build_format_locale/index.js":"jh7A","./tr/index.js":"3ZWG","./zh_cn/build_distance_in_words_locale/index.js":"KdB7","./zh_cn/build_format_locale/index.js":"l4EP","./zh_cn/index.js":"8tMq","./zh_tw/build_distance_in_words_locale/index.js":"vyyr","./zh_tw/build_format_locale/index.js":"uYH7","./zh_tw/index.js":"QPlQ"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id="nw0P"},oGE2:function(e,t,n){"use strict";n.r(t);var a=n("lSNA"),r=n.n(a),o=(n("M50D"),n("/8/d"),n("q1tI")),c=n.n(o),i=n("i8i4"),l=n("Vg22"),s=n("fvjX"),u=n("sINF"),d=n("1mXj"),p=n("SH7X"),m=n.n(p),f=n("oJ5p"),h=n("1I/2"),b=n("buk/"),y=n("UmWK"),v=n("qvEe"),g=n("z6Q1"),E=n("o0o1"),_=n.n(E),w=n("yXPU"),k=n.n(w),O=n("RIqP"),j=n.n(O),x=n("OTOu"),C=n("oK4/"),A=n("lwsE"),P=n.n(A),S=n("W8MJ"),z=n.n(S),R=n("PJYZ"),N=n.n(R),T=n("7W2i"),D=n.n(T),B=n("a1gu"),M=n.n(B),q=n("Nsbk"),I=n.n(q),U=n("TSYQ"),L=n.n(U),F=n("V2U0"),Y=n("y6ex"),G=n("yoMi"),V=n("JL3L"),W=n("s2wB"),H=n("hE6O"),Q=n("OjRq"),Z=n("lEMr"),J=n.n(Z);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var X=Object(b.translate)()((function(e){return c.a.createElement("span",{className:J.a["item-pending"]},e.t("UploadQueue.item.pending"))})),$=Object(b.translate)()((function(e){var t,n,a=e.file,o=e.status,i=Q.b.splitFilename(a),l=i.filename,s=i.extension;switch(o){case"loading":n=c.a.createElement(F.b,{className:"u-ml-half",color:G.dodgerBlue});break;case"cancel":n=c.a.createElement(Y.default,{className:"u-ml-half u-warning",icon:V.a});break;case"failed":case"conflict":case"network":n=c.a.createElement(Y.default,{className:"u-ml-half u-warning",icon:W.a});break;case"loaded":n=c.a.createElement(Y.default,{className:"u-ml-half u-success",icon:H.a});break;case"pending":default:n=c.a.createElement(X,null)}return c.a.createElement("div",{className:L()(J.a["upload-queue-item"],(t={},r()(t,J.a["upload-queue-item--done"],"loaded"===o),r()(t,J.a["upload-queue-item--error"],"failed"===o||"conflict"===o),t))},c.a.createElement("div",{className:L()(J.a["item-cell"],J.a["item-file"],J.a["item-image"])},c.a.createElement("div",null,l,s&&c.a.createElement("span",{className:J.a["item-ext"]},s))),c.a.createElement("div",{className:J.a["item-status"]},n))})),ee=Object(b.translate)()((function(e){var t=e.t,n=e.total,a=e.done;return c.a.createElement("div",{className:J.a["upload-queue-header-inner"]},c.a.createElement("span",{className:"coz-desktop"},t("UploadQueue.header",{smart_count:n})),c.a.createElement("span",{className:"u-hide--desk"},t("UploadQueue.header_mobile",{done:a,total:n})))})),te=Object(b.translate)()((function(e){var t=e.t,n=e.total,a=e.successful,r=e.onClose;return c.a.createElement("div",{"data-testid":"upload-queue-success",className:J.a["upload-queue-header-inner"]},c.a.createElement("span",null,t("UploadQueue.header_done",{done:a,total:n})),c.a.createElement("button",{className:L()(J.a["btn-close"]),onClick:r},t("UploadQueue.close")))})),ne=function(e){D()(n,e);var t=K(n);function n(){var e;P()(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),r()(N()(e),"state",{collapsed:!1}),r()(N()(e),"toggleCollapsed",(function(){e.setState((function(e){return{collapsed:!e.collapsed}}))})),e}return z()(n,[{key:"render",value:function(){var e,t=this.props,n=t.queue,a=t.doneCount,o=t.successCount,i=t.purgeQueue,l=this.state.collapsed;return c.a.createElement("div",{"data-testid":"upload-queue",className:L()(J.a["upload-queue"],(e={},r()(e,J.a["upload-queue--visible"],0!==n.length),r()(e,J.a["upload-queue--collapsed"],l),e))},c.a.createElement("h4",{className:J.a["upload-queue-header"],onDoubleClick:this.toggleCollapsed},a<n.length?c.a.createElement(ee,{total:n.length,done:a}):c.a.createElement(te,{total:n.length,successful:o,onClose:i})),c.a.createElement("progress",{className:J.a["upload-queue-progress"],value:a,max:n.length}),c.a.createElement("div",{className:J.a["upload-queue-content"]},c.a.createElement("div",{className:J.a["upload-queue-list"]},n.map((function(e,t){return c.a.createElement($,{file:e.file,status:e.status,key:"file_".concat(t)})})))))}}]),n}(o.Component),ae=Object(b.translate)()(Object(l.connect)((function(e){return{queue:ge(e),doneCount:Ee(e).length,successCount:_e(e).length}}),(function(e){return{purgeQueue:function(){return e(me())}}}))(ne)),re=n("Yo2A"),oe=n("eNgw"),ce=function(e){var t=e.onClose;return c.a.createElement(oe.a,{onClose:t})},ie=function(e){return{file:e,status:"pending"}},le=function(e){switch(e.type){case"UPLOAD_FILE":return"loading";case"RECEIVE_UPLOAD_SUCCESS":return"loaded";default:return e.status}},se=function(e,t){return Object.assign({},e,{status:le(t)})},ue=Object(s.combineReducers)({queue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TO_UPLOAD_QUEUE":return[].concat(j()(e),j()(t.files.map((function(e){return ie(e)}))));case"PURGE_UPLOAD_QUEUE":return[];case"UPLOAD_FILE":case"RECEIVE_UPLOAD_SUCCESS":case"RECEIVE_UPLOAD_ERROR":return e.map((function(e){return e.file.name!==t.file.name?e:se(e,t)}));default:return e}}}),de=function e(t){return function(){var n=k()(_.a.mark((function n(a,r){var o,i,l;return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=ge(r()).find((function(e){return"pending"===e.status}))){n.next=3;break}return n.abrupt("return",a(fe()));case 3:return i=o.file,n.prev=4,a({type:"UPLOAD_FILE",file:i}),n.next=8,t(i);case 8:a({type:"RECEIVE_UPLOAD_SUCCESS",file:i}),n.next=18;break;case 11:n.prev=11,n.t0=n.catch(4),x.a.log(n.t0),l={409:"conflict",413:"quota"}[n.t0.status]||/Failed to fetch$/.exec(n.t0.toString())||"failed",a({type:"RECEIVE_UPLOAD_ERROR",file:i,status:"conflict"===l?"conflict":"failed"}),"quota"===l&&a(Object(re.d)(c.a.createElement(ce,{t:function(){}})));case 18:a(e(t));case 19:case"end":return n.stop()}}),n,null,[[4,11]])})));return function(e,t){return n.apply(this,arguments)}}()},pe=function(e,t){return function(){var n=k()(_.a.mark((function n(a){return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"ADD_TO_UPLOAD_QUEUE",files:e}),a(de(t));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},me=function(){return{type:"PURGE_UPLOAD_QUEUE"}},fe=function(){return function(e,t){var n=ge(t()),a=be(n),r=ye(n),o=ve(n);a.length||r.length?a.length&&!r.length?C.a.info("UploadQueue.alert.success_conflicts",{smart_count:o.length,conflictNumber:a.length}):C.a.error("UploadQueue.alert.errors"):C.a.success("UploadQueue.alert.success",{smart_count:o.length})}},he=function(e,t){return e.filter((function(e){return e.status===t}))},be=function(e){return he(e,"conflict")},ye=function(e){return he(e,"failed")},ve=function(e){return he(e,"loaded")},ge=function(e){return e.upload.queue},Ee=function(e){return ge(e).filter((function(e){return"pending"!==e.status}))},_e=function(e){return ve(ge(e))},we={upload:ue,ui:re.b},ke=n("V4z/"),Oe=n("SOjZ"),je=n("snfs"),xe=n("le8I"),Ce=n("jDpt"),Ae=n("9VR2"),Pe=n("fSd/"),Se=n("WUds"),ze=n.n(Se),Re=n("mgfL"),Ne=n.n(Re),Te=n("oAJy"),De=n.n(Te),Be=n("pmGv"),Me=n("mwIZ"),qe=n.n(Me),Ie=function(){return window.navigator&&-1===window.navigator.appVersion.indexOf("Win")&&-1===window.navigator.appVersion.indexOf("Mac")},Ue=function(){return window.navigator.userAgent&&window.navigator.userAgent.indexOf("Android")>=0},Le=function(){return window.navigator.userAgent&&/iPad|iPhone|iPod/.test(window.navigator.userAgent)},Fe=function(){var e=k()(_.a.mark((function e(t){var n,a,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={definition:Object(p.Q)("io.cozy.settings").getById("clients"),options:{as:"io.cozy.settings/clients",fetchPolicy:m.a.fetchPolicies.olderThan(3e4),singleDocData:!0}},e.next=3,t.fetchQueryAndGetFromState(n);case 3:return a=e.sent,r=a.data,e.abrupt("return",Object.values(r).some((function(e){return"github.com/cozy-labs/cozy-desktop"===qe()(e,"attributes.software_id")})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=n("FKqX");function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var He=function(e){D()(a,e);var t,n=We(a);function a(){var e;P()(this,a);for(var t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];return e=n.call.apply(n,[this].concat(o)),r()(N()(e),"state",{mustShow:!1}),e}return z()(a,[{key:"UNSAFE_componentWillMount",value:(t=k()(_.a.mark((function e(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===Ye.promoteDesktop.isActivated&&!Object(je.isFlagshipApp)()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,De.a.getItem("desktop_banner");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=!1;case 7:if(!e.t0){e.next=13;break}return e.next=11,Fe(this.props.client);case 11:!e.sent&&this.setState((function(e){return Ve(Ve({},e),{},{mustShow:!0})}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){if(!0!==Ye.promoteDesktop.isActivated||!this.state.mustShow||Object(je.isFlagshipApp)())return null;var e=this.props.t;return c.a.createElement(Be.a,{label:e("Nav.btn-client"),href:e(Ie()?"Nav.link-client":"Nav.link-client-desktop"),className:"u-m-1 u-dn-m"})}}]),a}(o.Component),Qe=Object(b.translate)()(Object(p.withClient)(He)),Ze=n("56YH"),Je=n.n(Ze),Ke=n("dexL"),Xe=n("yRsm"),$e=n("7jrE"),et=n.n($e),tt=n("eY+3"),nt=n("sbrb"),at=n("AzIT"),rt=n.n(at);function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var ct=function(e){D()(a,e);var t,n=ot(a);function a(e){var t;return P()(this,a),t=n.call(this,e),r()(N()(t),"state",{mustShow:!1}),t.willUnmount=!1,t}return z()(a,[{key:"componentDidMount",value:(t=k()(_.a.mark((function e(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.willUnmount=!1,e.next=3,De.a.getItem("desktop_banner");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=!1;case 6:if(e.t0){e.next=12;break}return e.next=10,Fe(this.props.client);case 10:!e.sent&&!this.willUnmount&&this.setState({mustShow:!0});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.willUnmount=!0}},{key:"markAsSeen",value:function(){De.a.setItem("desktop_banner",!0),this.setState({mustShow:!1})}},{key:"render",value:function(){var e=this;if(!0!==Ye.promoteDesktop.isActivated||!this.state.mustShow)return null;var t=this.props.t,n=Le()?"Nav.link-client-ios":Ue()?"Nav.link-client-android":Ie()?"Nav.link-client":"Nav.link-client-desktop",a=Le()||Ue()?"Nav.btn-client-mobile":"Nav.banner-txt-client";return c.a.createElement("div",{className:rt.a["coz-banner-client"]},c.a.createElement(Ke.a,{inline:!0,icon:c.a.createElement(Y.default,{icon:tt.a,size:"100%"}),text:t(a),bgcolor:et.a.paleGrey,buttonOne:c.a.createElement(Xe.b,{href:t(n),theme:"text",icon:nt.a,label:t("Nav.banner-btn-client"),onClick:function(){return e.markAsSeen("banner")}}),buttonTwo:c.a.createElement(Xe.c,{theme:"text",label:t("SelectionBar.close"),onClick:function(){e.markAsSeen("close")}})}))}}]),a}(o.Component),it=Je()(Object(b.translate)(),p.withClient)(ct),lt=n("0yyf"),st=n.n(lt),ut=Object(Pe.e)(Oe.c),dt=function(){var e=Object(b.useI18n)().t;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Pe.b,null,c.a.createElement(ut,{to:"/backup"},c.a.createElement(Pe.a,{icon:"phone-upload"}),c.a.createElement(Pe.c,null,e("Nav.backup")))),c.a.createElement(Pe.b,null,c.a.createElement(ut,{to:"/photos"},c.a.createElement(Pe.a,{icon:"image"}),c.a.createElement(Pe.c,null,e("Nav.photos")))),c.a.createElement(Pe.b,{"data-testid":"nav-to-albums"},c.a.createElement(ut,{to:"/albums"},c.a.createElement(Pe.a,{icon:"album"}),c.a.createElement(Pe.c,null,e("Nav.albums")))))},pt=function(){var e=Object(b.useI18n)().t;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Pe.b,null,c.a.createElement(ut,{to:"/photos"},c.a.createElement(Pe.a,{icon:"image"}),c.a.createElement(Pe.c,null,e("Nav.photos")))),c.a.createElement(Pe.b,{"data-testid":"nav-to-albums"},c.a.createElement(ut,{to:"/albums"},c.a.createElement(Pe.a,{icon:"album"}),c.a.createElement(Pe.c,null,e("Nav.albums")))),c.a.createElement(Pe.b,null,c.a.createElement(ut,{to:"/backup"},c.a.createElement(Pe.a,{icon:"phone-upload"}),c.a.createElement(Pe.c,null,e("Nav.backup")))))},mt=Object(b.translate)()((function(e){var t=e.t;return c.a.createElement(Ce.b,null,c.a.createElement(Ae.a,{className:st.a["pho-sidebar"]},c.a.createElement(Pe.d,null,Object(je.isFlagshipApp)()?c.a.createElement(dt,null):c.a.createElement(pt,null)),!Object(je.isFlagshipApp)()&&c.a.createElement(Qe,null)),c.a.createElement(C.a,{t:t}),c.a.createElement(ae,null),c.a.createElement(Ce.c,{className:st.a["pho-content"]},!Object(je.isFlagshipApp)()&&c.a.createElement(it,null),c.a.createElement(ke.b,null)),c.a.createElement(re.a,null),c.a.createElement(xe.a,null),Ne()("debug")?c.a.createElement(ze.a,null):null)})),ft=n("pVnL"),ht=n.n(ft),bt=n("QILm"),yt=n.n(bt),vt=n("17x9"),gt=n.n(vt),Et=n("VZRP"),_t=n.n(Et),wt=n("yDJO"),kt=n("ufaa"),Ot=n("yFc8"),jt=n("IFYe"),xt=(n("Bkvo"),function(e,t){return function(n){var a=n.children;return c.a.createElement(e,null,c.a.createElement(Ot.default,{className:L()("u-flex u-flex-items-center",t),variant:"normal"},a))}}),Ct=xt(jt.a.BarCenter,"u-ellipsis"),At=xt(jt.a.BarRight),Pt=xt(jt.a.BarLeft),St=(xt(jt.a.BarSearch,"u-flex-grow"),n("J4zp")),zt=n.n(St),Rt=function(e){var t=e.onEdit,n=e.albumName,a=Object(o.useState)(!1),r=zt()(a,2),i=r[0],l=r[1],s=Object(o.useRef)(null);Object(o.useEffect)((function(){s.current.focus(),s.current.select()}),[]);return c.a.createElement("input",{type:"text",defaultValue:n,onKeyDown:function(e){13===e.keyCode&&t?(l(!0),t(e.target.value)):27===e.keyCode&&t&&(l(!0),t(n))},onBlur:function(e){!i&&t&&t(""!==e.target.value.trim()?e.target.value:n)},ref:s})};Rt.propTypes={albumName:gt.a.string,onEdit:gt.a.func.isRequired};var Nt=Rt;function Tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var Dt=function(e){var t=e.children;return c.a.createElement("h2",{"data-testid":"pho-content-title",className:_t.a["pho-content-title"]},t)},Bt=function(e){var t=e.onClick;return c.a.createElement("div",{role:"button","data-testid":"pho-content-album-previous",className:_t.a["pho-content-album-previous"],onClick:t})};Bt.propTypes={onClick:gt.a.func.isRequired};var Mt=function(e){D()(n,e);var t=Tt(n);function n(){return P()(this,n),t.apply(this,arguments)}return z()(n,[{key:"componentDidMount",value:function(){var e=this.props.pathname;this.parentUrl=e.substring(0,e.lastIndexOf("/"))}},{key:"renderTitle",value:function(){var e=this.props,t=e.t,n=e.viewName,a=e.albumName,r=void 0===a?"":a,o=e.onEdit,i=e.editing;return"albumContent"===n?void 0!==i&&i?c.a.createElement(Nt,{albumName:r,onEdit:o}):r:t("Nav.".concat(n))}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,a=t.viewName,r=t.breakpoints.isMobile,o=t.navigate,i=t.client,l=t.t,s="albumContent"===a,u=c.a.createElement(Dt,null,this.renderTitle()),d=r?c.a.createElement(Ct,null,u):u,p=r?c.a.createElement(At,null,c.a.createElement(wt.a,{client:i,store:this.context.store,t:l},c.a.createElement(y.a,{doctype:g.a,documentType:"Albums"},n))):n,m=c.a.createElement(Bt,{onClick:function(){return o(e.parentUrl)}}),f=r?c.a.createElement(Pt,null,m):m;return c.a.createElement("div",{className:_t.a["pho-content-header"]},s&&f,d,p)}}]),n}(o.Component);r()(Mt,"contextTypes",{store:gt.a.object.isRequired}),Mt.propTypes={viewName:gt.a.string.isRequired,albumName:gt.a.string,t:gt.a.func.isRequired,editing:gt.a.bool,onEdit:gt.a.func,breakpoints:gt.a.object.isRequired,children:gt.a.node},Mt.defaultProps={editing:!1,onEdit:function(){}};var qt=Je()(p.withClient,Object(kt.a)(),Object(b.translate)())((function(e){var t=Object(ke.o)(),n=Object(ke.m)().pathname;return c.a.createElement(Mt,ht()({},e,{navigate:t,pathname:n}))})),It=n("U0xp"),Ut=n("nEYx"),Lt=n("t0Aa"),Ft=n.n(Lt),Yt=n("nS3w"),Gt=n("zB5G"),Vt=function(e){var t=e.disabled,n=void 0!==t&&t,a=e.uploadPhotos,r=e.selectItems,o=Object(b.useI18n)().t,i=Object(h.b)().isMobile,l=i?[Object(Gt.i)(a,n),It.a,Object(Gt.g)(r)]:[Object(Gt.g)(r)];return c.a.createElement("div",{className:Ft.a["pho-toolbar"],role:"toolbar"},!i&&c.a.createElement(Ut.a,{onUpload:a,disabled:n,label:o("Toolbar.photo_upload")}),c.a.createElement(Yt.a,{actions:l}))};Vt.propTypes={disabled:gt.a.bool,uploadPhotos:gt.a.func.isRequired,selectItems:gt.a.func.isRequired,t:gt.a.func.isRequired};var Wt=Vt,Ht=n("2sk9"),Qt=n.n(Ht),Zt=n("e5eR"),Jt=function(e){var t=e.t,n=e.count,a=e.confirm,r=e.onClose,o=["trash","restore","shared"];!0===e.related&&o.push("related");var i=o.map((function(e){return c.a.createElement("p",{className:L()(Qt.a["fil-confirm-text"],Qt.a["icon-".concat(e)]),key:"key_delet_".concat(e)},t("timeline.DeleteConfirm.".concat(e),n))}));return c.a.createElement(Zt.a,{open:!0,onClose:r,title:t("timeline.DeleteConfirm.title",n),content:i,actions:c.a.createElement(c.a.Fragment,null,c.a.createElement(Xe.c,{theme:"secondary",onClick:r,label:t("timeline.DeleteConfirm.cancel")}),c.a.createElement(Xe.c,{theme:"danger",label:t("timeline.DeleteConfirm.delete"),onClick:a}))})},Kt=n("TtgU"),Xt=n("YJMV"),$t=function(e){var t=e.navigate,n=Object(h.b)().isMobile,a=Object(b.useI18n)().t,r=[Object(Gt.e)(t)];return c.a.createElement("div",{"data-testid":"pho-toolbar-albums",className:Ft.a["pho-toolbar"],role:"toolbar"},n?c.a.createElement(Yt.a,{actions:r}):c.a.createElement(Xe.b,{"data-testid":"album-add",theme:"secondary",href:"#/albums/new",icon:Xt.a,label:a("Toolbar.album_new")}))},en=n("6qED"),tn=n.n(en),nn=n("KOJc"),an=n("RPnM"),rn=n("6se/"),on=n("H/9E"),cn=n("AJ6E");function ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var sn=function(e){var t=e.album,n=e.image,a=e.title,r=e.desc;return c.a.createElement(Oe.b,{to:t._id,className:tn.a["pho-album-link"]},n,a,r)},un=function(e){var t=e.album,n=e.image,a=e.title,r=e.desc,o=e.onClick;return e.disabled?c.a.createElement("div",{className:L()(tn.a["pho-album-link"],tn.a["pho-album-link--disabled"])},n,c.a.createElement("div",null,a,r)):c.a.createElement("div",{onClick:function(){return o(t)},className:tn.a["pho-album-link"]},n,c.a.createElement("div",null,a,r))},dn=Object(b.translate)()((function(e){var t=e.t,n=e.photoCount,a=e.album;return c.a.createElement("h4",{className:tn.a["pho-album-description"]},c.a.createElement(on.a,{docId:a.id,className:tn.a["pho-album-shared"],xsmall:!0}),c.a.createElement(cn.a,{docId:a.id},(function(e){var a=e.isSharedWithMe,r=e.isSharedByMe,o=e.hasWriteAccess;return c.a.createElement("span",null,t("Albums.album_item_description",{smart_count:n}),(a||r)&&" - ".concat(t("Albums.album_item_shared_".concat(o?"rw":"ro"))))})))})),pn=function(e){D()(n,e);var t=ln(n);function n(){return P()(this,n),t.apply(this,arguments)}return z()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.album,a=e.shared,r=void 0===a?{}:a,o=e.onClick,i=e.thumbnail,l=r.readOnly,s=n.photos.data[0]||null,u=s?c.a.createElement(rn.a,{file:s,linkType:"small",render:function(e){return c.a.createElement("img",{src:e,className:tn.a["pho-album-photo-item"],alt:"".concat(n.name," album cover")})}}):c.a.createElement("div",{className:tn.a["pho-album-photo-item"]}),d=c.a.createElement(dn,{t:t,album:n,shared:r,thumbnail:i,photoCount:n.photos.count}),p=c.a.createElement("h2",{className:tn.a["pho-album-title"]},n.name);return c.a.createElement("div",{"data-testid":"pho-album","data-test-name":n.name,className:tn.a["pho-album"]},o?c.a.createElement(un,{album:n,image:u,title:p,desc:d,onClick:o,disabled:l}):c.a.createElement(sn,{album:n,image:u,title:p,desc:d}))}}]),n}(o.Component),mn=function(e,t){return new Date(t.created_at||null)-new Date(e.created_at||null)},fn=Object(b.translate)()((function(e){var t=e.data,n=e.hasMore,a=e.fetchMore,r=e.t;return 0===t.length?c.a.createElement(nn.a,{localeKey:"albums"}):c.a.createElement(Ce.a,null,c.a.createElement("div",{className:tn.a["pho-album-list"]},t.sort(mn).map((function(e){return c.a.createElement(pn,{album:e,key:e.id})})),n&&c.a.createElement(an.a,{label:r("Albums.load_more"),onClick:a})))})),hn=n("ZFPb"),bn=n("SvWF"),yn=function(e){var t=e.list,n=t.fetchStatus;return t.lastFetch||"pending"!==n&&"loading"!==n?"failed"===n?c.a.createElement(bn.a,{errorType:"albums"}):c.a.createElement(fn,t):c.a.createElement(hn.a,{loadingType:"albums_fetching"})},vn=Object(b.translate)()((function(e){var t=e.albums,n=Object(ke.o)();return t?c.a.createElement("div",{"data-testid":"album-pho-content-wrapper",className:st.a["pho-content-wrapper"]},c.a.createElement(qt,{viewName:"albums"},c.a.createElement($t,{navigate:n})),c.a.createElement(yn,{list:t}),c.a.createElement(ke.b,null)):null})),gn=n("DA+R"),En=n("FFOw"),_n=n("9jN0");function wn(e,t){return e?[t]:[]}var kn=function(e){var t=e.t,n=e.album,a=e.sharedWithMe,r=e.readOnly,o=e.disabled,i=void 0!==o&&o,l=e.downloadAlbum,s=e.deleteAlbum,u=e.selectItems,d=e.onRename,p=e.shareAlbum,m=e.navigate,f=Object(h.b)().isMobile,b=[].concat(j()(wn(!a&&f,Object(Gt.h)(p,n))),[Object(Gt.c)(l,t("Toolbar.menu.download_album")),Object(Gt.f)(d)],j()(wn(!r,Object(Gt.d)(m))),j()(wn(f,It.a)),j()(wn(f,Object(Gt.g)(u))),[It.a],j()(wn(!a,Object(Gt.b)(s))));return c.a.createElement("div",{"data-testid":"pho-toolbar-album",className:Ft.a["pho-toolbar"],role:"toolbar"},!f&&c.a.createElement(c.a.Fragment,null,c.a.createElement(En.a,{docId:n.id,onClick:function(){return p(n)}}),c.a.createElement(_n.a,{disabled:i,label:t("Albums.share.cta"),onClick:function(){return p(n)},docId:n.id})),c.a.createElement(Yt.a,{actions:b}))},On=function(e){var t=e.t,n=e.confirm,a=e.onClose,r=["forbidden","eye","link"].map((function(e){return c.a.createElement("p",{className:L()(Qt.a["fil-confirm-text"],Qt.a["icon-".concat(e)]),key:e},t("destroyconfirmation.".concat(e)))}));return c.a.createElement(Zt.a,{open:!0,onClose:a,title:t("destroyconfirmation.title"),content:r,actions:c.a.createElement(c.a.Fragment,null,c.a.createElement(Xe.c,{theme:"secondary",onClick:a,label:t("destroyconfirmation.cancel")}),c.a.createElement(Xe.c,{theme:"danger",label:t("destroyconfirmation.delete"),onClick:n}))})},jn=n("q/Uw");function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function An(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var Pn=function(e){D()(n,e);var t=An(n);function n(){var e;P()(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),r()(N()(e),"state",{editing:!1,showAddAlbumModal:!1}),r()(N()(e),"showAddAlbumModal",(function(){e.setState((function(e){return Cn(Cn({},e),{},{showAddAlbumModal:!0})}))})),r()(N()(e),"hideAddAlbumModal",(function(){e.setState((function(e){return Cn(Cn({},e),{},{showAddAlbumModal:!1})}))})),r()(N()(e),"editAlbumName",(function(){e.setState((function(e){return Cn(Cn({},e),{},{editing:!0})}))})),r()(N()(e),"renameAlbum",(function(t){if(""!==t.trim())if(t!==e.props.album.name){var n=Cn(Cn({},e.props.album),{},{name:t});e.props.updateAlbum(n).then((function(){e.setState({editing:!1})})).catch((function(){C.a.error("Error.generic")}))}else e.setState({editing:!1});else C.a.error("Error.album_rename_abort")})),r()(N()(e),"downloadAlbum",k()(_.a.mark((function t(){var n,a;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.album,t.next=3,e.props.client.getStackClient().collection("io.cozy.files").findReferencedBy({_type:"io.cozy.photos.albums",_id:n.id},{limit:99999});case 3:a=t.sent,e.props.client.collection("io.cozy.files").downloadArchive(a.data.map((function(e){return e._id})),n.name);case 5:case"end":return t.stop()}}),t)})))),r()(N()(e),"downloadPhotos",(function(t){e.props.client.collection("io.cozy.files").downloadArchive(t.map((function(e){return e._id})),"selected")})),r()(N()(e),"closeDestroyConfirmModal",(function(){e.setState({displayDestroyConfirmModal:!1})})),r()(N()(e),"renderDestroyConfirm",(function(){var t=e.props,n=t.t,a=t.navigate,r=t.album,o=t.deleteAlbum;return c.a.createElement(On,{t:n,albumName:r.name,onClose:e.closeDestroyConfirmModal,confirm:function(){return o(r).then((function(){a("/albums"),C.a.success("Albums.remove_album.success",{name:r.name})})).catch((function(){return C.a.error("Albums.remove_album.error.generic")}))}})})),r()(N()(e),"deleteAlbum",(function(){e.setState({displayDestroyConfirmModal:!0})})),e}return z()(n,[{key:"render",value:function(){var e=this;if(!this.props.album||!this.props.photos)return null;var t=this.props,n=t.t,a=t.album,r=t.shareAlbum,o=t.photos,i=t.hasMore,l=t.fetchMore,s=t.lastFetch,u=t.navigate,d=t.pathname,p=this.state.editing,m={};return c.a.createElement(jn.a,{actions:function(t){return{"album-add":e.showAddAlbumModal,download:e.downloadPhotos,"album-remove":function(n){return e.props.removePhotos(a,n,t.clear)}}}},(function(t,f,h){return c.a.createElement("div",{"data-testid":"album-pho-content-wrapper",className:st.a["pho-content-wrapper"]},a.name&&a.photos.data&&c.a.createElement(qt,{viewName:"albumContent",albumName:a.name,editing:p,onEdit:e.renameAlbum},c.a.createElement(kn,{navigate:u,pathname:d,t:n,album:a,sharedWithMe:m.withMe,sharedByMe:m.byMe,readOnly:m.readOnly,onRename:e.editAlbumName,downloadAlbum:e.downloadAlbum,deleteAlbum:e.deleteAlbum,shareAlbum:r})),e.state.displayDestroyConfirmModal&&e.renderDestroyConfirm(),e.state.showAddAlbumModal&&c.a.createElement(ua,{onDismiss:e.hideAddAlbumModal,onSuccess:h.clear,photos:t}),o&&c.a.createElement(Kt.a,{lists:[{photos:o}],selected:t,photosContext:"timeline",showSelection:f,onPhotoToggle:h.toggle,onPhotosSelect:h.select,onPhotosUnselect:h.unselect,fetchStatus:o.fetchStatus,hasMore:i,fetchMore:l,lastFetch:s}),c.a.createElement(ke.b,null))}))}},{key:"componentWillUnmount",value:function(){void 0!==this.props.selection&&this.props.selection.clear()}}]),n}(o.Component);Pn.propTypes={hasMore:gt.a.bool.isRequired,fetchMore:gt.a.func.isRequired,album:gt.a.object.isRequired,shareAlbum:gt.a.func,photos:gt.a.array.isRequired,t:gt.a.func.isRequired,navigate:gt.a.func.isRequired,lastFetch:gt.a.number};var Sn=Je()(Object(l.connect)(null,(function(e){return{shareAlbum:function(t){return e(Object(re.d)(c.a.createElement(gn.a,{document:t,sharingDesc:t.name})))}}})),p.withClient,Object(b.translate)())((function(e){var t=Object(ke.m)().pathname,n=Object(ke.o)();return c.a.createElement(Pn,ht()({},e,{navigate:n,pathname:t}))})),zn=n("C/eS"),Rn=n.n(zn);function Nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var Tn=function(e){D()(n,e);var t=Nn(n);function n(e){var a;return P()(this,n),a=t.call(this,e),r()(N()(a),"onNameChange",(function(e){a.setState({name:e.target.value})})),r()(N()(a),"onCancel",(function(){a.props.navigate(-1)})),r()(N()(a),"onCreate",(function(e){var t=a.state.name;a.props.createAlbum(t,e).then((function(e){return a.props.navigate("/albums/".concat(e.id))})).catch((function(){a.input.focus(),a.input.select()}))})),r()(N()(a),"onUpdate",(function(e){var t=a.props.album;a.props.addPhotos(t,e).then((function(){return a.props.navigate("/albums/".concat(t.id))}))})),a.state={name:e.t("Albums.create.panel_form.placeholder")},a}return z()(n,[{key:"componentDidMount",value:function(){this.props.album||(this.input.focus(),this.input.select())}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,a=t.album,r=this.state.name,o=!a;return c.a.createElement(jn.a,null,(function(t,i,l){return c.a.createElement("div",{className:Rn.a["pho-panel"]},c.a.createElement("div",{className:Rn.a["pho-panel-form"]},c.a.createElement("header",{className:Rn.a["pho-panel-header"]},c.a.createElement("div",{className:Rn.a["pho-panel-wrap"]},o&&c.a.createElement("div",null,c.a.createElement("label",{className:Rn.a["coz-form-label"]},n("Albums.create.panel_form.label")),c.a.createElement("input",{"data-testid":"input-album-name",type:"text",ref:function(t){e.input=t},value:r,onChange:e.onNameChange})),!o&&c.a.createElement("h3",{"data-testid":"pho-picker-album-name"},a.name))),c.a.createElement("div",{className:Rn.a["pho-panel-content"]},c.a.createElement("div",{"data-testid":"picker-panel",className:Rn.a["pho-panel-wrap"]},c.a.createElement(La,{selected:t,showSelection:!0,selection:l}))),c.a.createElement("footer",{className:Rn.a["pho-panel-footer"]},c.a.createElement("div",{className:Rn.a["pho-panel-wrap"]},c.a.createElement("div",{className:Rn.a["pho-panel-controls"]},c.a.createElement(Xe.a,{theme:"secondary",onClick:e.onCancel,label:n("Albums.create.panel_form.cancel")}),c.a.createElement(Xe.a,{"data-testid":"validate-album",onClick:function(){return o?e.onCreate(t):e.onUpdate(t)},label:n(o?"Albums.create.panel_form.submit":"Albums.create.panel_form.update")}))))))}))}}]),n}(o.Component),Dn=Object(b.translate)()((function(e){var t=Object(ke.o)();return c.a.createElement(Tn,ht()({},e,{navigate:t}))})),Bn=n("D575"),Mn=n.n(Bn),qn=n("qFRD"),In=n("R1lS"),Un=n("luXY"),Ln=n.n(Un);function Fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var Yn=function(e){D()(n,e);var t=Fn(n);function n(){var e;return P()(this,n),(e=t.call(this)).state={name:"",isSubmitDisabled:!0,isBusy:!1,hasError:!1},e}return z()(n,[{key:"reset",value:function(){this.setState({name:"",isSubmitDisabled:!0,isBusy:!1,hasError:!1})}},{key:"onSubmit",value:function(e,t){var n=this;return e.preventDefault(),this.setState({isBusy:!0}),t(this.state.name).then((function(){return n.reset()}),(function(){return n.setState({hasError:!0,isBusy:!1})}))}},{key:"onNameChange",value:function(e){var t=e.target.value;this.setState({name:t,isSubmitDisabled:!t.trim().length,hasError:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,a=t.onSubmitNewAlbum;return c.a.createElement("form",{className:Ln.a["pho-create-album-form"],onSubmit:function(t){return e.onSubmit(t,a)}},c.a.createElement("label",{className:Ln.a["coz-create-album-label"]},n("Albums.create.inline_form.create_label")),c.a.createElement("div",{className:Ln.a["coz-inline-form"]},c.a.createElement("input",{className:L()(Ln.a["coz-input-text"],this.state.hasError&&Ln.a.error),type:"text",name:"album-name",onInput:function(t){return e.onNameChange(t)},disabled:this.state.isBusy,placeholder:n("Albums.create.inline_form.placeholder"),value:this.state.name}),c.a.createElement(Xe.a,{className:Ln.a["create-button"],disabled:this.state.isSubmitDisabled||this.state.isBusy,"aria-busy":this.state.isBusy,label:n("Albums.create.inline_form.create_button")})))}}]),n}(o.Component),Gn=Object(b.translate)()(Yn),Vn=void 0,Wn=function(e){return 0===e.albums.data.length?c.a.createElement(nn.a,{localeKey:"albums"}):c.a.createElement("div",{className:L()(tn.a["pho-album-list"],tn.a["pho-album-list--thumbnails"],tn.a["pho-album-list--selectable"])},e.albums.data.map((function(t){return c.a.createElement(pn,{album:t,key:t.id,thumbnail:!0,onServerError:e.onServerError,onClick:e.onSubmitSelectedAlbum})})))},Hn=Object(bn.b)((function(e){return e.error}),"albums",(function(e){return c.a.createElement("div",null,c.a.createElement(Wn,e))})),Qn=function(e){if(!e.albums)return null;var t="failed"===e.albums.fetchStatus;return c.a.createElement(Hn,ht()({error:t,onServerError:function(){return Vn.handleError(t)}},e))};function Zn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var Jn=function(e){D()(n,e);var t=Zn(n);function n(){return P()(this,n),t.apply(this,arguments)}return z()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.photos,a=e.data,r=e.fetchStatus,o=e.createAlbum,i=e.addPhotos,l=e.onDismiss,s=e.onSuccess,u=void 0===s?function(){}:s,d="pending"===r||"loading"===r;return c.a.createElement(qn.a,{open:!0,onClose:l,title:t("Albums.add_photos.title"),content:c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement(Gn,{onSubmitNewAlbum:function(e){return o(e,n).then(l).then(u)}}),c.a.createElement(In.a,{className:"u-ml-0 u-maw-100 u-mt-1"}),d&&c.a.createElement(hn.a,{loadingType:"albums_fetching"}),!d&&a&&a.length>0&&c.a.createElement("div",{className:L()(Mn.a["coz-select-album"])},c.a.createElement(Qn,{albums:{data:a,fetchStatus:r},onSubmitSelectedAlbum:function(e){return i(e,n).then(l).then(u)}}))))})}}]),n}(o.Component),Kn=Object(b.translate)()(Jn),Xn=n("GoJ1"),$n=n("aR52"),ea=n("7Zso"),ta=function(){var e=Object(b.useI18n)().t,t=Object(ke.o)();return c.a.createElement(Xn.a,{title:e("Error.generic"),icon:ea.a},c.a.createElement($n.a,{onClick:function(){t("/")},label:e("Error.back_homepage")}))},na=n("A5W6");function aa(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ra(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ra(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw o}}}}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var oa=function(e){return e.find(g.a,{created_at:{$gt:null}}).where({auto:{$exists:!1}}).indexFields(["created_at"]).include(["photos"]).sortBy([{created_at:"desc"}])},ca=function(){var e=k()(_.a.mark((function e(t,n){var a,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.photos.data.length,e.next=4,t.photos.addById(n.map((function(e){return e._id})));case 4:r=t.photos.data.length,a+n.length!==r?C.a.info("Alerter.photos.already_added_photo"):C.a.success("Albums.add_photos.success",{name:t.name,smart_count:n.length}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C.a.error("Albums.add_photos.error.reference");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),ia=function(e){return{updateAlbum:(n=k()(_.a.mark((function t(n){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.collection(g.a).checkUniquenessOf("name",n.name);case 2:if(!0===t.sent){t.next=8;break}return C.a.error("Albums.create.error.already_exists",{name:name}),t.abrupt("return");case 8:return t.abrupt("return",e.save(n));case 9:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)}),deleteAlbum:function(t){return e.destroy(t)},addPhotos:ca,removePhotos:(t=k()(_.a.mark((function e(t,n,a){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.photos.removeById(n.map((function(e){return e._id})));case 3:C.a.success("Albums.remove_photos.success",{album_name:t.name}),a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),C.a.error("Albums.remove_photos.error.generic");case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e,n,a){return t.apply(this,arguments)})};var t,n},la=function(e){return{addPhotos:ca,createAlbum:(t=k()(_.a.mark((function t(n,a){var r,o,c,i=arguments;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:new Date,t.prev=1,n){t.next=5;break}return C.a.error("Albums.create.error.name_missing"),t.abrupt("return");case 5:return o={_type:g.a,name:n,created_at:r},t.next=8,e.collection(g.a).checkUniquenessOf("name",o.name);case 8:if(!0===t.sent){t.next=12;break}return C.a.error("Albums.create.error.already_exists",{name:n}),t.abrupt("return");case 12:return t.next=14,e.create(g.a,o,{photos:a},{updateQueries:{albums:function(e,t){return[t.data].concat(j()(e))}}});case 14:return c=t.sent,C.a.success("Albums.create.success",{name:o.name,smart_count:a.length}),t.abrupt("return",c.data);case 19:t.prev=19,t.t0=t.catch(1),C.a.error("Albums.create.error.generic");case 22:case"end":return t.stop()}}),t,null,[[1,19]])}))),function(e,n){return t.apply(this,arguments)})};var t},sa=function(e){return c.a.createElement(p.Query,{query:oa},(function(t){return c.a.createElement(vn,ht()({albums:t},e))}))},ua=function(e){return c.a.createElement(p.Query,{query:oa,as:"albums",mutations:la},(function(t,n){var a=n.createAlbum,r=n.addPhotos;return c.a.createElement(Kn,ht()({},t,{createAlbum:a,addPhotos:r},e))}))},da=function(e){var t,n,a=Object(ke.q)().albumId,r=Object(na.a)(a);return c.a.createElement(p.Query,ht()({query:r.definition,as:r.as},e,{mutations:ia}),(t={children:e.children},n=t.children,function(e,t){var a=e.data,r=e.fetchStatus,o=e.lastFetch,i=t.updateAlbum,l=t.deleteAlbum,s=t.removePhotos;return a&&"loaded"===r?c.a.createElement(Sn,{album:a,photos:a.photos.data,updateAlbum:i,deleteAlbum:l,removePhotos:s,hasMore:void 0!==a.photos.hasMore,fetchMore:a.photos.fetchMore.bind(a.photos),lastFetch:o},n):"failed"===r?c.a.createElement(ta,null):c.a.createElement(hn.a,{size:"xxlarge",loadingType:"photos_fetching",middle:!0})}))},pa=Object(p.withMutations)(la)(Dn),ma=function(e){var t=ht()({},e),n=Object(ke.q)().albumId;if(n){var a=Object(na.a)(n);return c.a.createElement(p.Query,ht()({query:a.definition,as:a.as,mutations:la},t),(function(e,t){var n=e.data,a=t.addPhotos;return c.a.createElement(Dn,{album:n,addPhotos:a})}))}return c.a.createElement(pa,null)},fa=function(e){if(!e)return!1;var t,n=aa(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.relationships&&a.relationships.referenced_by&&a.relationships.referenced_by.data&&a.relationships.referenced_by.data.length>0){var r,o=aa(a.relationships.referenced_by.data);try{for(o.s();!(r=o.n()).done;){if(r.value.type===g.a)return!0}}catch(c){o.e(c)}finally{o.f()}}}}catch(c){n.e(c)}finally{n.f()}return!1},ha="".concat(g.b,"/photos"),ba="".concat(g.b,"/photos/upload"),ya=("".concat(g.b,"/photos/mobile"),function(){var e=k()(_.a.mark((function e(t,n){var a,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.collection(g.c).findReferencedBy({_type:g.b,_id:n});case 2:return a=e.sent,r=a.included,e.abrupt("return",r.filter((function(e){return!1===/^\/\.cozy_trash/.test(e.attributes.path)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),va=function(){var e=k()(_.a.mark((function e(t,n,a){var r,o,c,i,l;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ya(t,a);case 2:if(!(r=e.sent).length){e.next=7;break}return e.abrupt("return",r[0]);case 7:return o=t.collection(g.c),e.next=10,o.ensureDirectoryExists(n);case 10:return c=e.sent,e.next=13,o.addReferencesTo({_id:a,_type:g.b},[{_id:c}]);case 13:return e.next=15,o.get(c);case 15:return i=e.sent,l=i.data,e.abrupt("return",l);case 18:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();function ga(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ga(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ga(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=I()(e);if(t){var r=I()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return M()(this,n)}}var wa=function(){var e=k()(_.a.mark((function e(t,n){var a,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ya(t,ba);case 2:if(!((a=e.sent).length>0)){e.next=7;break}return e.abrupt("return",a[0]._id);case 7:return e.next=9,va(t,"/".concat(n("UploadQueue.path_photos")),ha);case 9:return e.next=11,va(t,"/".concat(n("UploadQueue.path_photos"),"/").concat(n("UploadQueue.path_upload")),ba);case 11:return r=e.sent,e.abrupt("return",r._id);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ka=function(e){D()(n,e);var t=_a(n);function n(){var e;P()(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),r()(N()(e),"state",{showAddAlbumModal:!1}),r()(N()(e),"showAddAlbumModal",(function(){e.setState((function(e){return Ea(Ea({},e),{},{showAddAlbumModal:!0})}))})),r()(N()(e),"hideAddAlbumModal",(function(){e.setState((function(e){return Ea(Ea({},e),{},{showAddAlbumModal:!1})}))})),r()(N()(e),"uploadPhotos",function(){var t=k()(_.a.mark((function t(n){var a,r,o,c,i;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.uploadPhoto,r=e.props,o=r.client,c=r.t,t.next=4,wa(o,c);case 4:i=t.sent,e.dispatch(pe(n,(function(e){return a(e,i)})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r()(N()(e),"downloadPhotos",(function(t){e.props.client.collection("io.cozy.files").downloadArchive(t.map((function(e){return e._id})),"selected")})),r()(N()(e),"closeModal",(function(){e.setState({displayModal:!1,selected:null,clearSelection:null})})),r()(N()(e),"showDeleteConfirm",(function(){var t=e.state,n=t.selected,a=t.clearSelection;return c.a.createElement(Jt,{t:e.props.t,count:n.length,related:fa(n),onClose:e.closeModal,confirm:k()(_.a.mark((function t(){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.map((function(t){return e.props.deletePhoto(t)}))).then(a);case 2:e.closeModal();case 3:case"end":return t.stop()}}),t)})))})})),r()(N()(e),"deletePhotos",(function(t,n){e.setState({displayModal:!0,selected:t,clearSelection:n})})),e}return z()(n,[{key:"dispatch",value:function(e){return this.context.store.dispatch(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,a=t.lists,r=t.fetchStatus,o=t.hasMore,i=t.fetchMore,l=t.lastFetch;return c.a.createElement(jn.a,{actions:function(t){return{"album-add":e.showAddAlbumModal,download:e.downloadPhotos,trash:function(n){return e.deletePhotos(n,t.clear)}}}},(function(t,s,u){return c.a.createElement("div",{"data-testid":"timeline-pho-content-wrapper",className:st.a["pho-content-wrapper"]},c.a.createElement(qt,{viewName:"photos"},c.a.createElement(Wt,{disabled:s,uploadPhotos:e.uploadPhotos,selectItems:u.show,t:n})),c.a.createElement(Ce.a,null,e.state.displayModal&&e.showDeleteConfirm(),e.state.showAddAlbumModal&&c.a.createElement(ua,{onDismiss:e.hideAddAlbumModal,onSuccess:u.clear,photos:t}),c.a.createElement(Kt.a,{lists:a,selected:t,photosContext:"timeline",showSelection:s,onPhotoToggle:u.toggle,onPhotosSelect:u.select,onPhotosUnselect:u.unselect,fetchStatus:r,hasMore:o,fetchMore:i,lastFetch:l})),c.a.createElement(ke.b,null))}))}}]),n}(o.Component);r()(ka,"contextTypes",{store:gt.a.object.isRequired});var Oa=Object(b.translate)()(Object(p.withClient)(ka)),ja=n("NAv5"),xa=function(e,t,n){var a=t.substr(0,10).split("-"),r=zt()(a,3),o=r[0],c=r[1],i=r[2],l=t.length>10?t.substr(11,8).split(":"):[0,0,0],s=zt()(l,3),u=s[0],d=s[1],p=s[2];return e(new Date(o,c-1,i,u,d,p),n)},Ca=function(e,t){return xa(e,t,"HH")},Aa=function(e,t){return xa(e,t,"DD MMMM")+Pa(e,t)},Pa=function(e,t){return Object(ja.isThisYear)(t)?"":xa(e,t," YYYY")},Sa=function(e,t,n){var a=xa(e,t),r=xa(e,n);return 0===Object(ja.differenceInCalendarDays)(a,r)},za=["data"],Ra=["selection"],Na=["data"],Ta=function(e){return e.find("io.cozy.files").where({class:"image","metadata.datetime":{$gt:null}}).partialIndex({trashed:!1}).indexFields(["class","metadata.datetime"]).select(["dir_id","name","size","updated_at","metadata","metadata.datetime","trashed","class"]).sortBy([{class:"desc"},{"metadata.datetime":"desc"}]).include(["albums"])},Da=function(e){return{uploadPhoto:(t=k()(_.a.mark((function t(n,a){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.mutate({mutationType:"UPLOAD_PHOTO",execute:function(){var t=k()(_.a.mark((function t(){var r,o,c;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.chrome){t.next=10;break}return t.next=3,e.getStackClient().fetchJSON("GET","/settings/disk-usage");case 3:if(r=t.sent,!(o=r.data).attributes.quota){t.next=10;break}if(!(parseInt(o.attributes.used)+parseInt(n.size)>parseInt(o.attributes.quota))){t.next=10;break}throw(c=new Error("Payload Too Large")).status=413,c;case 10:return t.abrupt("return",e.collection("io.cozy.files").createFile(n,{dirId:a}));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}));case 1:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)}),deletePhoto:function(t){return e.destroy(t)}};var t},Ba=function(e,t){if(e.period){var n=e.period.start,a=e.period.end;return function(e,t,n){var a=xa(e,t),r=xa(e,n);return 0===Object(ja.differenceInCalendarMonths)(a,r)}(t,a,n)?Sa(t,a,n)?Aa(t,n):function(e,t){return xa(e,t,"DD")}(t,n)+"-"+Aa(t,a):Aa(t,n)+" - "+Aa(t,a)}return Aa(t,e.name)},Ma=function(e,t,n,a){if(n.album&&(t>0&&Sa(a,e[t-1],e[t])||t<e.length-1&&Sa(a,e[t],e[t+1]))){var r=n.album.period.start,o=n.album.period.end,c=n.title+" · "+Ca(a,r)+"h";return function(e,t,n){var a=xa(e,t),r=xa(e,n);return 0===Object(ja.differenceInHours)(a,r)}(a,o,r)||(c+="-"+Ca(a,o)+"h"),c}return n.title},qa=function(e,t,n){return Object.keys(e).find((function(a){if(e[a].album){var r=e[a].album.period.start,o=e[a].album.period.end;return(c=t,i=r,Object(ja.compareAsc)(c,i)>=0&&function(e,t){return Object(ja.compareAsc)(e,t)<=0}(t,o))||Sa(n,t,o)}return Sa(n,t,a);var c,i}))},Ia=function(e,t){var n={},a=[];e.forEach((function(e){var r=(e.albums?e.albums.data:[]).find((function(e){return e.auto}));if(r){var o=r.name;if(!n.hasOwnProperty(o)){var c=Ba(r,t);n[o]={photos:[],title:c,album:r}}n[o].photos.push(e)}else a.push(e)})),a.forEach((function(e){var a=e.metadata&&e.metadata.datetime?e.metadata.datetime:e.created_at,r=qa(n,a,t);if(r)n[r].photos.push(e);else{var o=function(e,t){return xa(e,t,"YYYY-MM-DD")}(t,a);n[o]={title:Aa(t,a),photos:[e]}}}));var r=Object.keys(n);return r.sort((function(e,t){return new Date(t).getTime()-new Date(e).getTime()})),r.map((function(e,a){return{title:Ma(r,a,n[e],t),photos:n[e].photos}}))},Ua=Object(b.translate)()((function(e){return c.a.createElement(p.Query,{query:Ta,as:"timeline",mutations:Da},(function(t,n){var a=t.data,r=yt()(t,za);return c.a.createElement(Oa,ht()({lists:a?Ia(a,e.f):[],data:a},n,r,e))}))})),La=Object(b.translate)()((function(e){var t=e.selection,n=yt()(e,Ra);return c.a.createElement(p.Query,{query:Ta},(function(e){var a=e.data,r=yt()(e,Na);return c.a.createElement(Kt.a,ht()({lists:a?Ia(a,n.f):[],photosContext:"timeline",onPhotoToggle:t.toggle,onPhotosSelect:t.select,onPhotosUnselect:t.unselect},r,n))}))})),Fa=n("McP2"),Ya=n.n(Fa),Ga=n("c8ah"),Va=n("urqY"),Wa=function(){var e=Object(b.useI18n)().t;return c.a.createElement("div",{className:"u-flex u-flex-column u-flex-items-center"},c.a.createElement(Y.default,{icon:Va.a,size:"64",color:et.a.slateGrey}),c.a.createElement(Ga.default,{variant:"h4",className:"u-mt-1"},e("Backup.header.title")))},Ha=n("Bq8i"),Qa=n("bmTa"),Za=Object(o.createContext)(null),Ja=function(e){var t=e.children,n=Object(o.useState)(null),a=zt()(n,2),r=a[0],i=a[1];return c.a.createElement(Za.Provider,{value:{backupInfo:r,setBackupInfo:i}},t)},Ka=function(){return Object(o.useContext)(Za)},Xa=function(){var e=Object(b.useI18n)().t,t=Ka().backupInfo;if(!t)return null;var n=t.currentBackup,a=n.status,r=n.mediasToBackupCount;return"ready"===a&&r>0?c.a.createElement("div",{className:L()("u-mt-1-half",Ya.a["pho-backup-info-wrapper"])},c.a.createElement(Ha.a,{severity:"primary"},c.a.createElement(Qa.a,null,e("Backup.info.notBackedUpElements",{smart_count:t.currentBackup.mediasToBackupCount})),e("Backup.info.pressStartBackup"))):null},$a=n("iZIm"),er=n("i+Yv"),tr=Object(o.createContext)(null),nr=function(e){var t=e.children,n=Ka().setBackupInfo,a=Object(o.useState)(null),r=zt()(a,2),i=r[0],l=r[1],s=Object(o.useState)(null),u=zt()(s,2),d=u[0],p=u[1],m=Object(o.useState)(!1),f=zt()(m,2),h=f[0],b=f[1],y=Object(v.useWebviewIntent)(),g=Object(o.useCallback)(k()(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("💿 📷 prepareBackup called"),e.next=4,y.call("prepareBackup");case 4:t=e.sent,console.log("💿 📷 prepareBackup finished"),n(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),p({message:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),[y,n]),E=Object(o.useCallback)(k()(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("💿 📷 startBackup called"),e.next=4,y.call("startBackup");case 4:t=e.sent,n(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),p({message:e.t0.message});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),[y,n]),w=Object(o.useCallback)(k()(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("💿 📷 stopBackup called"),e.next=4,y.call("stopBackup");case 4:t=e.sent,n(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),p({message:e.t0.message});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),[y,n]),O=Object(o.useCallback)(k()(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("💿 📷 checkBackupPermissions called"),e.next=4,y.call("checkBackupPermissions");case 4:return t=e.sent,l(t),e.abrupt("return",t);case 9:e.prev=9,e.t0=e.catch(0),p({message:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),[y]),j=Object(o.useCallback)(k()(_.a.mark((function e(){var t,n,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("💿 📷 requestBackupPermissions called"),e.next=4,y.call("requestBackupPermissions");case 4:if(t=e.sent,l(t),n=t.granted&&!i.granted,a=!t.canRequest,!n){e.next=15;break}return e.next=11,g();case 11:return e.next=13,E();case 13:e.next=16;break;case 15:a&&b(!0);case 16:return e.abrupt("return",t);case 19:e.prev=19,e.t0=e.catch(0),p({message:e.t0.message});case 22:case"end":return e.stop()}}),e,null,[[0,19]])}))),[y,i,g,E,b]),x=Object(o.useCallback)(k()(_.a.mark((function e(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.call("openAppOSSettings");case 2:case"end":return e.stop()}}),e)}))),[y]);return Object(o.useEffect)((function(){y&&function(){var e=k()(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("💿 📷 check"),e.next=3,O();case 3:if(null==(t=e.sent)||!t.granted){e.next=7;break}return e.next=7,g();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[y,O,g]),c.a.createElement(tr.Provider,{value:{backupPermissions:i,prepareBackup:g,startBackup:E,stopBackup:w,requestBackupPermissions:j,backupError:d,setBackupError:p,isAllowPermissionsModalOpen:h,setIsAllowPermissionsModalOpen:b,openAppOSSettings:x}},t)},ar=function(){return Object(o.useContext)(tr)},rr=function(){var e=Object(b.useI18n)().t,t=Ka().backupInfo,n=ar(),a=n.backupPermissions,r=n.prepareBackup,o=n.startBackup,i=n.stopBackup,l=n.requestBackupPermissions;if(!a)return null;if(a.granted){if(!t)return null;var s=t.currentBackup,u=s.status,d=s.mediasToBackupCount,p=s.totalMediasToBackupCount;return"running"===u?c.a.createElement("div",{className:"u-mt-1 u-flex u-flex-column u-flex-justify-center"},c.a.createElement($n.a,{label:"".concat(e("Backup.actions.backupInProgress")," ").concat(p-d,"/").concat(p),variant:"primary",disabled:!0,onClick:o,startIcon:c.a.createElement(Y.default,{icon:er.a,spin:!0,"aria-hidden":!0,focusable:"false"})}),c.a.createElement($n.a,{className:"u-mt-half",label:e("Backup.actions.cancel"),variant:"secondary",onClick:i})):"initializing"===u?c.a.createElement("div",{className:"u-mt-1-half u-flex u-flex-column u-flex-justify-center"},c.a.createElement($n.a,{label:e("Backup.actions.verification"),variant:"primary",disabled:!0,startIcon:c.a.createElement(Y.default,{icon:er.a,spin:!0,"aria-hidden":!0,focusable:"false"})})):0===d?c.a.createElement("div",{className:"u-mt-1-half u-flex u-flex-justify-center"},c.a.createElement($n.a,{label:e("Backup.actions.saved"),variant:"primary",color:"success",onClick:r,startIcon:c.a.createElement(Y.default,{icon:H.a})})):c.a.createElement("div",{className:"u-mt-1-half u-flex u-flex-justify-center"},c.a.createElement($n.a,{label:e("Backup.actions.startBackup"),variant:"primary",onClick:o,startIcon:c.a.createElement(Y.default,{icon:$a.a})}))}return c.a.createElement("div",{className:"u-mt-1-half u-flex u-flex-justify-center"},c.a.createElement($n.a,{label:e("Backup.actions.startBackup"),variant:"primary",onClick:l,startIcon:c.a.createElement(Y.default,{icon:$a.a})}))},or=function(){var e=Object(b.useI18n)().t,t=Object(h.b)().isMobile;return c.a.createElement("div",null,c.a.createElement(Ga.default,{className:"u-mt-1-half",align:t?"center":"left"},e("Backup.description.first")),c.a.createElement(Ga.default,{className:"u-mt-1",align:t?"center":"left"},e("Backup.description.second")))},cr=n("KOLZ"),ir=function(){var e=Object(b.useI18n)().t,t=Object(o.useState)(!1),n=zt()(t,2),a=n[0],r=n[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ha.a,{action:c.a.createElement($n.a,{variant:"text",size:"small",label:e("Backup.InstallAppAlert.install"),onClick:function(){r(!0)}}),className:"u-mt-1"},e("Backup.InstallAppAlert.description")),a&&c.a.createElement(cr.a,{onClose:function(){r(!1)}}))},lr=n("pI/q"),sr=n("vQbK"),ur=n.n(sr),dr=function(){var e=Object(b.useI18n)().t,t=ar(),n=t.isAllowPermissionsModalOpen,a=t.setIsAllowPermissionsModalOpen,r=t.openAppOSSettings,o=function(){a(!1)};return c.a.createElement(lr.a,{open:n,size:"small",transitionDuration:0,onClose:o,componentsProps:{dialogTitle:{className:"u-pt-2"}},title:c.a.createElement("img",{src:ur.a,style:{width:"10rem"},"aria-hidden":!0}),content:c.a.createElement("div",{className:"u-ta-center"},c.a.createElement(Ga.default,{gutterBottom:!0,variant:"h3",color:"textPrimary"},e("Backup.AllowPermissionsModal.title")),c.a.createElement(Ga.default,{gutterBottom:!0,variant:"body1",color:"textPrimary"},e("Backup.AllowPermissionsModal.description"))),actions:c.a.createElement(c.a.Fragment,null,c.a.createElement($n.a,{variant:"secondary",label:e("Backup.AllowPermissionsModal.cancel"),onClick:o}),c.a.createElement($n.a,{variant:"primary",label:e("Backup.AllowPermissionsModal.allow"),onClick:function(){a(!1),r()}}))})},pr=n("jQ11"),mr=function(){var e=ar(),t=e.backupError,n=e.setBackupError;if(null===t)return null;var a=function(){n(null)};return c.a.createElement(pr.a,{open:t,onClose:a,autoHideDuration:5e3,className:"u-mb-half",style:{bottom:"var(--sidebarHeight)"}},c.a.createElement(Ha.a,{variant:"filled",elevation:6,severity:"error",onClose:a},t.message))},fr=function(){var e=Object(h.b)().isMobile;return c.a.createElement("div",{"data-testid":"backup-pho-content-wrapper",className:st.a["pho-content-wrapper"]},c.a.createElement(qt,{viewName:"backup"}),c.a.createElement(Ce.a,null,c.a.createElement(nr,null,c.a.createElement("div",{className:L()("u-m-1",Ya.a["pho-backup-wrapper"])},e?c.a.createElement(Wa,null):null,c.a.createElement(Xa,null),Object(je.isFlagshipApp)()?null:c.a.createElement(ir,null),c.a.createElement(rr,null),c.a.createElement(or,null)),c.a.createElement(dr,null),c.a.createElement(mr,null))))},hr=n("cwrA");function br(){return c.a.createElement(ke.a,{to:"photos",replace:!0})}var yr=Object(je.isFlagshipApp)()?"backup":"photos",vr=Object(Oe.d)([{element:c.a.createElement(mt,null),children:[{path:"/*",element:c.a.createElement(ke.a,{to:yr,replace:!0})},{path:"backup",element:c.a.createElement(fr,null)},{path:"photos",element:c.a.createElement(Ua,null),children:[{path:":photoId",element:c.a.createElement(hr.b,null),errorElement:c.a.createElement(br,null)}]},{path:"albums",children:[{path:"",element:c.a.createElement(sa,null)},{path:"new",element:c.a.createElement(ma,null)},{path:":albumId",element:c.a.createElement(da,null),errorElement:c.a.createElement(br,null),children:[{path:"edit",element:c.a.createElement(ma,null)},{path:":photoId",element:c.a.createElement(hr.a,null),errorElement:c.a.createElement(br,null)}]}]}]}]),gr=function(){return c.a.createElement(ke.e,{router:vr,fallbackElement:c.a.createElement(F.b,null)})},Er=n("dBw4"),_r=n("44Ds"),wr=n.n(_r),kr=n("qxHO"),Or=n("yZiV"),jr=n("NqoY");function xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ar=Object(d.createLogger)(),Pr=wr()((function(){var e=document.querySelector("[role=application]"),t=JSON.parse(e.dataset.cozy),n=document.documentElement.getAttribute("lang")||"en",a=window.location?window.location.protocol:"https:",r="".concat(a,"//").concat(t.domain),o=new m.a({uri:r,token:t.token,appMetadata:Or.a,schema:jr.a,store:!1});o.registerPlugin(f.RealtimePlugin),cozy.client.init({cozyURL:r,token:t.token}),Object(kr.a)(),Object(kr.b)(r);var c=[u.default,Ar],i=s.compose,l=Object(s.createStore)(Object(s.combineReducers)(Cr(Cr({},we),{},{cozy:o.reducer()})),i(s.applyMiddleware.apply(void 0,c)));o.setStore(l);var d=t.locale;return jt.a.init({appName:t.app.name,appEditor:t.app.editor,cozyClient:o,iconPath:t.app.icon,lang:n,replaceTitleOnMobile:!0,appSlug:t.app.slug,appNamePrefix:t.app.prefix}),{store:l,locale:d,client:o,root:e}})),Sr=function(e){var t=Ka().setBackupInfo;return c.a.createElement(v.WebviewIntentProvider,{setBarContext:jt.a.setWebviewContext,methods:{updateBackupInfo:function(e){t(e)}}},c.a.createElement(l.Provider,{store:e.store},c.a.createElement(b.I18n,{lang:e.locale,dictRequire:function(e){return n("Gofk")("./".concat(e))}},c.a.createElement(p.CozyProvider,{client:e.client},c.a.createElement(h.a,null,c.a.createElement(Er.a,null,c.a.createElement(y.a,{doctype:g.a,documentType:"Albums"},e.children)))))))},zr=function(e){return c.a.createElement(Ja,null,c.a.createElement(Sr,e,c.a.createElement(gr,null)))};document.addEventListener("DOMContentLoaded",(function(){var e,t,n,a,r;e=Pr(),t=e.store,n=e.locale,a=e.client,r=e.root,Object(i.render)(c.a.createElement(zr,{store:t,locale:n,client:a}),r)}))},"q/Uw":function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n("lwsE"),r=n.n(a),o=n("W8MJ"),c=n.n(o),i=n("PJYZ"),l=n.n(i),s=n("7W2i"),u=n.n(s),d=n("a1gu"),p=n.n(d),m=n("Nsbk"),f=n.n(m),h=n("lSNA"),b=n.n(h),y=n("RIqP"),v=n.n(y),g=n("q1tI"),E=n.n(g),_=n("+MCZ");function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=f()(e);if(t){var r=f()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return p()(this,n)}}var j=E.a.createContext([]),x=function(e,t){return{type:t?"UNSELECT_ITEM":"SELECT_ITEM",item:e}},C=function(e){return{type:"ADD_TO_SELECTION",items:e}},A=function(e){return{type:"REMOVE_FROM_SELECTION",items:e}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.meta&&t.meta.cancelSelection)return[];switch(t.type){case"SELECT_ITEM":return[].concat(v()(e),[t.item]);case"UNSELECT_ITEM":return e.filter((function(e){return e._id!==t.item.id}));case"ADD_TO_SELECTION":var n=e.map((function(e){return e._id})),a=t.items.filter((function(e){return-1===n.indexOf(e._id)}));return[].concat(v()(e),v()(a));case"REMOVE_FROM_SELECTION":var r=t.items.map((function(e){return e._id}));return e.filter((function(e){return-1===r.indexOf(e._id)}));case"HIDE_SELECTION_BAR":return[];default:return e}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(t.meta&&t.meta.cancelSelection)return!1;switch(t.type){case"TOGGLE_SELECTION_BAR":return!e;case"SHOW_SELECTION_BAR":return!0;case"HIDE_SELECTION_BAR":return!1;default:return e}},z=function(e){u()(n,e);var t=O(n);function n(){var e;r()(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),b()(l()(e),"state",{selected:P(void 0,{}),opened:S(void 0,{})}),b()(l()(e),"toggle",(function(t,n){return e.dispatch(x(t,n))})),b()(l()(e),"select",(function(t){return e.dispatch(C(t))})),b()(l()(e),"unselect",(function(t){return e.dispatch(A(t))})),b()(l()(e),"clear",(function(){return e.dispatch({type:"HIDE_SELECTION_BAR"})})),b()(l()(e),"show",(function(){return e.dispatch({type:"SHOW_SELECTION_BAR"})})),e}return c()(n,[{key:"dispatch",value:function(e){this.setState((function(t){return k(k({},t),{},{selected:P(t.selected,e),opened:S(t.opened,e)})}))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.actions,a=void 0===n?{}:n,r=this.state,o=r.selected,c=r.opened,i=0!==o.length||c,l={toggle:this.toggle,select:this.select,unselect:this.unselect,clear:this.clear,show:this.show},s="function"==typeof a?a(l):a,u={};Object.keys(s).map((function(e){u[e]="function"==typeof s[e]?{action:s[e]}:s[e]}));var d=Object.keys(u).length>0;return E.a.createElement(j.Provider,{value:o},E.a.createElement("div",null,i&&d&&E.a.createElement(_.a,{selected:o,hideSelectionBar:this.clear,actions:u}),t(o,i,l)))}}]),n}(g.Component);j.Consumer},qxHO:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return b}));var a=n("lSNA"),r=n.n(a),o=n("NlKi"),c=n.n(o),i=n("XA+M"),l=n.n(i),s={slug:l.a.slug,version:l.a.version,name:l.a.name,prefix:l.a.name_prefix};n("OTOu");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p="undefined"==typeof __SENTRY_URL__?"":__SENTRY_URL__,m=function(e,t){return e.replace(/^file:\/\//,"app://").replace(t,"")},f=function(e){var t=/^.*\/[^.]+(\.app|CodePush|.*(?=\/))/;e.culprit&&(e.culprit=m(e.culprit,t));var n=e.stacktrace||e.exception&&e.exception.values&&e.exception.values[0]&&e.exception.values[0].stacktrace;return n&&(n.frames=n.frames.map((function(e){return"[native code]"!==e.filename?d(d({},e),{},{filename:m(e.filename,t)}):e}))),e},h=function(){c.a.config(p,{shouldSendCallback:!0,environment:"production",release:s.version,allowSecretKey:!0,dataCallback:f}).install()},b=function(e){c.a.setTagsContext({instance:e})}},swni:function(e,t,n){e.exports={"u-visuallyhidden":"u-visuallyhidden--1L4hk","dri-btn--more":"dri-btn--more--MNdqs"}},t0Aa:function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--1w1h7","CozyTheme--normal":"CozyTheme--normal--3wr-Z","c-btn":"c-btn--1VDiR","c-btn--regular":"c-btn--regular--1AoRN","c-btn--danger":"c-btn--danger--2NNcc","c-btn--secondary":"c-btn--secondary--3znY5","c-btn--danger-outline":"c-btn--danger-outline--mVde8","pho-toolbar":"pho-toolbar--28WqL","fil-toolbar-menu-recipients":"fil-toolbar-menu-recipients--3uaZB",spin:"spin--GHUiz",shake:"shake--3TZHV"}},u0ID:function(e,t){e.exports={name:"Photos",name_prefix:"Cozy",slug:"photos",version:"1.55.0",type:"webapp",licence:"AGPL-3.0",icon:"public/app-icon.svg",categories:["cozy"],source:"https://github.com/cozy/cozy-drive",editor:"Cozy",developer:{name:"Cozy Cloud",url:"https://cozy.io"},langs:["en","fr"],locales:{fr:{short_description:"Cozy Photos est l’application de visualisation et gestion de vos photos sur Cozy.",long_description:"Avec Cozy Photos vous pourrez :\n- Visualiser toutes les photos présentes dans votre Cozy, classées par date;\n- Organisez vos photos en albums;\n- Partager vos albums avec qui vous le souhaitez.",screenshots:["screenshots/fr/screenshot01.jpg","screenshots/fr/screenshot02.jpg","screenshots/fr/screenshot03.jpg"]},en:{short_description:"Cozy Photos allows you to view and manage your photos on your Cozy",long_description:"With Cozy Photos, you can:\n- Get a timeline of all your memories\n- Organize your photos through albums\n- Share albums with just a link",screenshots:["screenshots/en/screenshot01.jpg","screenshots/en/screenshot02.jpg","screenshots/en/screenshot03.jpg"]}},screenshots:["screenshots/fr/screenshot01.jpg","screenshots/fr/screenshot02.jpg","screenshots/fr/screenshot03.jpg"],routes:{"/":{folder:"/",index:"index.html",public:!1},"/public":{folder:"/public",index:"index.html",public:!0}},services:{onPhotoUpload:{type:"node",file:"services/onPhotoUpload/photos.js",trigger:"@event io.cozy.files:CREATED:image:class",debounce:"5m"}},permissions:{files:{description:"Required for photo access",type:"io.cozy.files",verbs:["GET","POST","PUT","PATCH"]},apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET","PUT"]},albums:{description:"Required to manage photos albums",type:"io.cozy.photos.albums",verbs:["GET","POST","PUT","DELETE","PATCH"]},photos_settings:{description:"Required to manage photos albums settings",type:"io.cozy.photos.settings",verbs:["GET","POST","PUT"]},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]},oauth:{description:"Required to display the cozy-desktop banner",type:"io.cozy.oauth.clients",verbs:["GET"]},errorsreporting:{description:"Allow to report unexpected errors to the support team",type:"cc.cozycloud.errors",verbs:["POST"]},triggers:{description:"Required to re-execute the clustering",type:"io.cozy.triggers",verbs:["POST"],selector:"worker",values:["service"]},triggersviewer:{description:"Required to display the konnector block status",type:"io.cozy.triggers",verbs:["GET"]},konnectors:{description:"Required to display the information of the konnector that retrieved the photos",type:"io.cozy.konnectors",verbs:["GET"]}}}},vQbK:function(e,t){e.exports="/img/cozy-photo-sync.9d8d58187e9c880b90270324a6fff0da.png"},yZiV:function(e,t,n){"use strict";var a=n("u0ID"),r=n.n(a),o={slug:r.a.slug,version:r.a.version};t.a=o},z6Q1:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s}));var a=n("lSNA"),r=n.n(a),o=n("OjRq");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var i="io.cozy.files",l="io.cozy.photos.albums",s="io.cozy.apps";!function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}}({files:{doctype:i,relationships:{old_versions:{type:"has-many",doctype:"io.cozy.files.versions"},encryption:{type:"io.cozy.files:has-many",doctype:"io.cozy.files.encryption"}}},contacts:{doctype:o.a.doctype,doctypeVersion:2},groups:{doctype:o.c.doctype},versions:{doctype:"io.cozy.files.versions"}},{})},zB5G:function(e,t,n){"use strict";n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"b",(function(){return _})),n.d(t,"g",(function(){return k})),n.d(t,"f",(function(){return j})),n.d(t,"d",(function(){return x})),n.d(t,"a",(function(){return A})),n.d(t,"i",(function(){return z}));var a=n("pVnL"),r=n.n(a),o=n("q1tI"),c=n.n(o),i=n("buk/"),l=n("y6ex"),s=n("etNt"),u=n("vEVt"),d=n("94Ho"),p=n("YJMV"),m=function(e){return function(){return{name:"newAlbum",action:function(){return e("/albums/new")},Component:Object(o.forwardRef)((function(e,t){var n=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},e,{ref:t}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:p.a})),c.a.createElement(u.default,{primary:n("Toolbar.album_new")}))}))}}},f=n("sbrb"),h=function(e,t){return function(){return{name:"download",action:e,Component:Object(o.forwardRef)((function(e,n){return c.a.createElement(d.a,r()({},e,{ref:n}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:f.a})),c.a.createElement(u.default,{primary:t}))}))}}},b=n("AJ6E"),y=n("fmf2"),v=n("lXO7"),g=function(e,t){return function(){return{name:"shareAlbum",action:function(){return e(t)},Component:Object(o.forwardRef)((function(e,n){var a=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},e,{ref:n}),c.a.createElement(b.a,{docId:t.id},(function(e){var t=e.isSharedWithMe,n=e.recipients,r=e.link;return c.a.createElement(c.a.Fragment,null,c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:v.a})),c.a.createElement(u.default,{primary:a(t?"Albums.share.sharedWithMe":"Albums.share.cta")}),c.a.createElement(s.a,null,c.a.createElement(y.a,{recipients:n,link:r,size:"small"})))})))}))}}},E=n("46CF"),_=function(e){return function(){return{name:"deleteAlbum",action:e,Component:Object(o.forwardRef)((function(e,t){var n=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},e,{ref:t,className:"u-pomegranate"}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:E.a,color:"var(--pomegranate)"})),c.a.createElement(u.default,{primary:n("Toolbar.menu.album_delete")}))}))}}},w=n("9gqn"),k=function(e){return function(){return{name:"selectItems",action:e,Component:Object(o.forwardRef)((function(e,t){var n=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},e,{ref:t}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:w.a})),c.a.createElement(u.default,{primary:n("Toolbar.menu.select_items")}))}))}}},O=n("Tgut"),j=function(e){return function(){return{name:"renameAlbum",action:e,Component:Object(o.forwardRef)((function(e,t){var n=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},e,{ref:t}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:O.a})),c.a.createElement(u.default,{primary:n("Toolbar.menu.rename_album")}))}))}}},x=function(e){return function(){return{name:"editAlbum",action:function(){return e("./edit")},Component:Object(o.forwardRef)((function(e,t){var n=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},e,{ref:t}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:p.a})),c.a.createElement(u.default,{primary:n("Toolbar.menu.add_photos")}))}))}}},C=n("g4Do"),A=function(){return{name:"createCozy",action:function(){return window.location="https://manager.cozycloud.cc/cozy/create"},Component:Object(o.forwardRef)((function(e,t){var n=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},e,{ref:t}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:C.a})),c.a.createElement(u.default,{primary:n("Share.create-cozy")}))}))}},P=n("1soK"),S=n("nEYx"),z=function(e,t){return function(){return{name:"upload",action:function(e){return e.stopPropagation()},Component:Object(o.forwardRef)((function(n,a){var o=Object(i.useI18n)().t;return c.a.createElement(d.a,r()({},n,{ref:a}),c.a.createElement(s.a,null,c.a.createElement(l.default,{icon:P.a})),c.a.createElement(S.a,{onUpload:e,disabled:t,label:o("Toolbar.menu.photo_upload"),inMenu:!0}))}))}}}}});