!function(e){function t(t){for(var r,i,c=t[0],l=t[1],s=t[2],d=0,p=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var l=n[c];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={0:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;o.push([9,2]),n()}({0:function(e,t){},"0yyf":function(e,t,n){e.exports={"pho-sidebar":"pho-sidebar--1JZDr","pho-content":"pho-content--6vy4r","pho-content-wrapper":"pho-content-wrapper--1u34M",spin:"spin--OsM9y",shake:"shake--V0phk"}},1:function(e,t){},2:function(e,t){},"2OO4":function(e){e.exports=JSON.parse('{"Nav":{"photos":"Photos","albums":"Albums","shared":"Shared by me","trash":"Trash","btn-client":"Get Cozy Drive for desktop","btn-client-web":"Get Cozy","btn-client-mobile":"Get Cozy Drive on your mobile!","banner-txt-client":"Get Cozy Drive for Desktop and synchronise your files safely to make them accessible at all times.","banner-btn-client":"Download","link-client":"https://cozy.io/en/download/","link-client-desktop":"https://nuts.cozycloud.cc/download/channel/stable/","link-client-android":"https://play.google.com/store/apps/details?id=io.cozy.drive.mobile","link-client-ios":"https://itunes.apple.com/us/app/cozy-drive/id1224102389?mt=8","link-client-web":"https://cozy.io/fr/try-it?from=albumsharing"},"empty":{"timeline_photos_title":"You don\'t have any photos yet.","timeline_photos_text":"Click the \\"Upload\\" button to add photos.","albums_title":"You don\'t have any album yet.","albums_text":"Start by clicking \\"New album\\" to create your first album.","album_photos_title":"There is no photo in this album yet.","album_photos_text":"Start by clicking \\"Add photos to album\\" to add some.","shared_album_photos_title":"There is no photo in this album yet.","shared_album_photos_text":"Come back later"},"Error":{"albums_title":"An error occurred while retrieving the albums list. Please try again later.","album_photos_title":"An error occurred while retrieving the album\'s photos list. Please try again later.","timeline_photos_title":"An error occurred while retrieving the photos list. Please try again later.","public_album_error_title":"An error occurred while retrieving the photos list. Please try again later.","public_album_unshared_title":"Sorry, this link is no longer available.","public_album_unshared_text":"One lost, ten found... or just check out with the owner for help. This file might not be lost.","refresh":"Refresh now","generic":"An error occurred, please try again.","album_rename_abort":"The album name can not be empty.","back_homepage":"Back to homepage"},"Toolbar":{"photo_upload":"Upload","album_new":"New album","album_delete":"Delete","album_quit":"Leave & delete shared album","album_download":"Download","more":"More","menu":{"select_items":"Select photos","photo_upload":"Upload photos","rename_album":"Rename album","album_delete":"Delete album","album_quit":"Leave & delete shared album","download_album":"Download album","add_photos":"Add photos to album"}},"loading":{"photos_indexing":"Your photos are currently being indexed. Please wait.","albums_indexing":"Your albums are currently being indexed. Please wait.","photos_fetching":"Loading","albums_fetching":"Loading","photos_upload":"Uploading"},"Board":{"load_more":"Load more photos","select_all":"Select all","unselect_all":"Unselect all"},"Alerter":{"photos":{"fetching_error":"An error occurred during photos fetching.","already_added_photo":"This album already contains this photo."}},"SelectionBar":{"selected_count":"item selected |||| items selected","delete":"Delete","trash":"Delete","album-add":"Add to album","album-remove":"Remove from album","download":"Download","close":"Close"},"Share":{"status":{"pending":"Pending","accepted":"Accepted","refused":"Refused","error":"Error","unregistered":"Error","mail-not-sent":"Error","revoked":"Error"},"type":{"one-way":"Can View (coming soon)","two-way":"Can Change"},"create-cozy":"Create my cozy"},"Albums":{"album_item_description":"%{smart_count} photo |||| %{smart_count} photos","album_item_shared_ro":"Shared (read only)","album_item_shared_rw":"Shared (read/write)","load_more":"Load more albums","add_photos":{"title":"Add to album","success":"Album %{name} has been updated with %{smart_count} photo. |||| Album %{name} has been updated with %{smart_count} photos.","error":{"generic":"An error occurred when updating the album, please try again.","reference":"Some photos has not been added to the album. Please check and try again.","response":{"Forbidden":"Application does not have permission to update albums."}}},"share":{"cta":"Share","title":"Share with others","details":{"title":"Sharing details","createdAt":"On %{date}","ro":"Read only","rw":"Read/write"},"sharedByMe":"Shared","sharedWithMe":"Shared with me","shareByLink":{"subtitle":"By public link","desc":"Anyone with the provided link can see and download your photos.","fetchFailed":"Woops! It seems your connectivity is limited, try again later when it gets better.","creating":"Creating your link...","copy":"Copy link","copied":"Link has been copied to clipboard","failed":"Unable to copy to clipboard"},"shareByEmail":{"title":"By email","subtitle":"By email","email":"email","emailPlaceholder":"Enter the email address or name of the recipient","send":"Send","genericSuccess":"You sent an invite to %{count} contacts.","success":"You sent an invite to %{email}.","comingsoon":"Coming soon! You will be able to share documents and photos in a single click with your family, your friends, and even your coworkers. Don\'t worry, we\'ll let you know when it\'s ready!"},"unshare":{"title":"Remove from album","success":"You removed this shared album from %{email}."},"sharingLink":{"title":"Link to share","copy":"Copy","copied":"Copied"},"whoHasAccess":{"title":"Who has access"},"protectedShare":{"title":"Coming soon!","desc":"Share anything by email with your family and friends!"},"close":"Close","gettingLink":"Getting your link...","error":{"generic":"An error occurred when creating the album share link, please try again.","revoke":"An error occurred when revoking the album share link, please try again."}},"create":{"panel_form":{"label":"Add a name to your new album","placeholder":"Untitled album","cancel":"Cancel","submit":"Create new album","update":"Add photos to album"},"inline_form":{"placeholder":"New album name","create_label":"Create a new album","create_button":"Create"},"success":"Album %{name} has been created with %{smart_count} photo. |||| Album %{name} has been created with %{smart_count} photos.","error":{"generic":"An error occurred when creating the album, please try again.","already_exists":"The album %{name} already exists, please pick another one.","name_missing":"You have to give a name to your album."}},"fetchAlbums":{"error":{"index_missing":"An albums index must be provided to fetch albums."}},"remove_photos":{"success":"The photo has been removed from album %{album_name}","error":{"generic":"An error occured while removing the photo, please try again."}},"remove_album":{"success":"Album %{name} was deleted.","error":{"generic":"An error occured while removing the album, please try again."}},"quit_album":{"success":"Album %{name} was deleted.","error":{"generic":"An error occured while leaving the album, please try again."}}},"Viewer":{"close":"Close","noviewer":{"title":"The viewer doesn\'t know how to read this type of file yet.","download":"Download this file","openWith":"Open with..."},"actions":{"download":"Download"},"loading":{"error":"This file could not be loaded. Do you have a working internet connection right now?","retry":"Retry"}},"destroyconfirmation":{"title":"Permanently delete this album?","cancel":"Cancel","delete":"Delete permanently","forbidden":"You won\'t be able to access this album or selection anymore.","eye":"Your photos won\'t be deleted.","link":"If you have shared it, people won\'t be able to access it."},"timeline":{"DeleteConfirm":{"title":"Delete this element? |||| Delete these elements?","trash":"It will be moved to the Trash. |||| They will be moved to the Trash.","restore":"You can still restore it whenever you want. |||| You can still restore them whenever you want.","shared":"If you have shared it, people won\'t be able to access it. |||| If you have shared them, people won\'t be able to access them.","related":"Some of the photos within the selection are related to an album. They will be removed from it if you proceed to trash them.","cancel":"Cancel","delete":"Remove"}},"UploadQueue":{"path_photos":"Photos","path_upload":"Uploaded from Cozy Photos","header":"Uploading %{smart_count} photo to Cozy Photos |||| Uploading %{smart_count} photos to Cozy Photos","header_mobile":"Uploading %{done} of %{total}","header_done":"Uploaded %{done} out of %{total} successfully","close":"close","item":{"pending":"Pending"},"alert":{"success":"%{smart_count} photo uploaded with success. |||| %{smart_count} photos uploaded with success.","success_conflicts":"%{smart_count} photo uploaded with %{conflictNumber} conflict(s). |||| %{smart_count} photos uploaded with %{conflictNumber} conflict(s).","errors":"Errors occurred during the photos upload."}},"quotaalert":{"title":"Your disk space is full :(","desc":"Please remove files, empty your trash or increase your disk space before uploading files again.","confirm":"OK","increase":"Increase your disk space"},"button":{"back":"Back"}}')},"2sk9":function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--b7sc9","CozyTheme--normal":"CozyTheme--normal--1PFeN","u-card":"u-card--1LMvZ","u-debug":"u-debug--Dvf4q","u-shake":"u-shake--301R8",shake:"shake--Hx9aG","u-elevation-1":"u-elevation-1--_bAw8","u-filter-gray-100":"u-filter-gray-100--1mFsr","u-o-100":"u-o-100--1l6_J","u-o-90":"u-o-90--Vl2PX","u-o-80":"u-o-80--1iZh6","u-o-70":"u-o-70--1Orn8","u-o-60":"u-o-60--29A2S","u-o-50":"u-o-50--1vWRz","u-o-40":"u-o-40--23WHb","u-o-30":"u-o-30--C42_r","u-o-20":"u-o-20--Wp1zJ","u-o-10":"u-o-10--1yTAG","u-o-05":"u-o-05--1IKgP","u-o-025":"u-o-025--2gpCh","u-o-0":"u-o-0--2YnvF","fil-confirm-text":"fil-confirm-text--3OV-5","icon-trash":"icon-trash--2L617","icon-restore":"icon-restore--qTvX6","icon-shared":"icon-shared--2ytpg","icon-related":"icon-related--3HRWq","icon-eye":"icon-eye--2EIWz","icon-link":"icon-link--2hb-A","icon-forbidden":"icon-forbidden--23UiV",spin:"spin--3SvvM"}},3:function(e,t){},4:function(e,t){},5:function(e,t){},"59mS":function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--2YC9P","CozyTheme--normal":"CozyTheme--normal--11Mk6","u-card":"u-card--2A4F_","u-debug":"u-debug--239uE","u-shake":"u-shake--jsFDP",shake:"shake--3-Vkv","u-elevation-1":"u-elevation-1--2nz2m","u-filter-gray-100":"u-filter-gray-100--3z1C_","u-o-100":"u-o-100--3NgxQ","u-o-90":"u-o-90--1HDpO","u-o-80":"u-o-80--1I9nb","u-o-70":"u-o-70--3QV-j","u-o-60":"u-o-60--1QLxy","u-o-50":"u-o-50--jArI6","u-o-40":"u-o-40--3Q8vH","u-o-30":"u-o-30--3LyB0","u-o-20":"u-o-20--3Aqqq","u-o-10":"u-o-10--3v5K_","u-o-05":"u-o-05--2aGws","u-o-025":"u-o-025--2bvm8","u-o-0":"u-o-0--h266O",spin:"spin--2CdRK"}},"5ZYL":function(e,t,n){e.exports={"pho-loading":"pho-loading--2vILC","pho-empty":"pho-empty--2ISCA"}},6:function(e,t){},"6qED":function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--1b8qa","CozyTheme--normal":"CozyTheme--normal--1C24e","pho-album-list":"pho-album-list--3W0t6","pho-album-list--thumbnails":"pho-album-list--thumbnails--3FASv","pho-album":"pho-album--nBuXk","pho-album-link":"pho-album-link--1J30Z","pho-album-photo-item":"pho-album-photo-item--18xZx","pho-album-title":"pho-album-title--1N0Rf","pho-album-description":"pho-album-description--3z6S7","pho-album-shared":"pho-album-shared--2T6ed","pho-album-list--selectable":"pho-album-list--selectable--1eSpV","pho-album-link--disabled":"pho-album-link--disabled--309dC"}},7:function(e,t){},9:function(e,t,n){n("55Il"),e.exports=n("oGE2")},A5W6:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n("SH7X"),a=n("z6Q1"),o=function(){return{definition:Object(r.Q)("io.cozy.files").where({class:"image","metadata.datetime":{$gt:null}}).partialIndex({trashed:!1}).indexFields(["class","metadata.datetime"]).select(["dir_id","name","size","updated_at","metadata","metadata.datetime","trashed","class"]).sortBy([{class:"desc"},{"metadata.datetime":"desc"}]).include(["albums"]),options:{as:"timeline",fetchPolicy:r.fetchPolicies.olderThan(3e4)}}},i=function(e){return{definition:Object(r.Q)(a.a).getById(e).include(["photos"]),options:{as:"albums-".concat(e),singleDocData:!0}}}},AzIT:function(e,t,n){e.exports={"coz-banner-client":"coz-banner-client--xEL17"}},"C/eS":function(e,t,n){e.exports={"pho-panel-form":"pho-panel-form--1S6en","coz-form":"coz-form--cCo_s","coz-form-group":"coz-form-group--1I069","coz-form-desc":"coz-form-desc--3FnDz","coz-form-label":"coz-form-label--385WH","coz-form-label--error":"coz-form-label--error--1Kr_k","coz-form-errors":"coz-form-errors--1RCYk",error:"error--3qEb3","CozyTheme--inverted":"CozyTheme--inverted--1gTN-","CozyTheme--normal":"CozyTheme--normal--1I94S","pho-panel":"pho-panel--vFzlq","pho-panel-header":"pho-panel-header--2aCpb","pho-panel-footer":"pho-panel-footer--2Ynjt","pho-panel-controls":"pho-panel-controls--1UDSQ","pho-panel-content":"pho-panel-content--2OXQJ","pho-panel-wrap":"pho-panel-wrap--1OkG3",spin:"spin--t2Bmx",shake:"shake--2MjHG"}},D575:function(e,t,n){e.exports={"coz-select-album":"coz-select-album--20TzS"}},FKqX:function(e){e.exports=JSON.parse('{"promoteDesktop":{"isActivated":true}}')},"G0/2":function(e,t,n){var r={"./en.json":"6wRk","./fr.json":"wNxD"};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id="G0/2"},Gofk:function(e,t,n){var r={"./en":"2OO4","./en.json":"2OO4"};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id="Gofk"},IFYe:function(e,t,n){"use strict";var r=n("9jFK");n("ZsPO");t.a=r},KOJc:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("pVnL"),a=n.n(r),o=n("q1tI"),i=n.n(o),c=n("TSYQ"),l=n.n(c),s=n("buk/"),u=n("GoJ1"),d=n("o+ty"),p=n("46CF"),m=n("7Zso"),f=function(e){return i.a.createElement("svg",a()({viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),i.a.createElement("path",{opacity:"0.34",fillRule:"evenodd",clipRule:"evenodd",d:"M12.9657 1C13.5206 1 14.2876 1.3125 14.6803 1.6995L16 3H30.0059C31.1072 3 32 3.89498 32 4.997V27.003C32 28.1059 31.1107 29 29.9983 29H2.00174C0.896211 29 0 28.1001 0 27.0088V1.99653C0 1.44616 0.448999 1 1.00472 1H12.9657Z",fill:"#297EF2"}),i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 1C0.447715 1 0 1.44772 0 2V6C0 6.55228 0.447716 7 1 7H13.5858C13.851 7 14.1054 6.89464 14.2929 6.70711L15.7071 5.29289C15.8946 5.10536 16.149 5 16.4142 5H32C32 3.89543 31.1046 3 30 3H16.4142C16.149 3 15.8946 2.89464 15.7071 2.70711L14.2929 1.29289C14.1054 1.10536 13.851 1 13.5858 1H1ZM10 15.9954V24.0046C10 24.5543 10.4558 25 11.0025 25H20.9975C21.5512 25 22 24.5443 22 24.0046V15.9954C22 15.4457 21.5561 15 21 15H20V13C20 10.794 18.2053 9 16 9C13.794 9 12 10.794 12 13V15H11C10.4477 15 10 15.4557 10 15.9954ZM16 11C14.8968 11 14 12.1215 14 13.5V15H18V13.5C18 12.1215 17.1028 11 16 11ZM17.5 19C17.5 18.172 16.8265 17.5 16 17.5C15.172 17.5 14.5 18.172 14.5 19C14.5 19.552 14.803 20.032 15.25 20.29V22.75C15.25 23.1625 15.586 23.5 16 23.5C16.4125 23.5 16.75 23.1625 16.75 22.75V20.29C17.1955 20.032 17.5 19.552 17.5 19Z",fill:"#297EF2"}))},h=n("lJfM"),b=n.n(h),y={drive:d.a,encrypted:f,photos:m.a,trash:p.a},v=function(e){var t=e.type,n=e.canUpload,r=e.localeKey,a=Object(s.useI18n)().t;return i.a.createElement(u.a,{"data-testid":"empty-folder",icon:y[t],title:a(r?"empty.".concat(r,"_title"):"empty.title"),text:r&&a("empty.".concat(r,"_text"))||n&&a("empty.text"),className:l()(b.a.empty,"u-mh-2")})},g=function(e){return i.a.createElement(v,a()({type:"photos"},e))}},NqoY:function(e,t,n){"use strict";var r=n("lwsE"),a=n.n(r),o=n("W8MJ"),i=n.n(o),c=n("7W2i"),l=n.n(c),s=n("a1gu"),u=n.n(s),d=n("Nsbk"),p=n.n(d),m=n("z6Q1"),f=n("Le8U"),h=n("SH7X");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u()(this,n)}}var y=function(e){l()(n,e);var t=b(n);function n(){return a()(this,n),t.apply(this,arguments)}return i()(n,[{key:"data",get:function(){var e=this,t=this.target.relationships.referenced_by.data;return t?t.map((function(t){return e.get(t.type,t.id)})).filter(Boolean):[]}}],[{key:"query",value:function(e,t,n){if(!e.relationships||!e.relationships.referenced_by||!e.relationships.referenced_by.data)return null;var r=e.relationships.referenced_by.data.filter((function(e){return e.type===n.doctype})).map((function(e){return e.id}));return new h.QueryDefinition({doctype:n.doctype,ids:r})}}]),n}(h.HasMany);t.a={albums:{doctype:m.a,attributes:{name:{type:"string"}},relationships:{photos:{type:"has-many",doctype:m.c}}},files:{doctype:m.c,relationships:{albums:{type:y,doctype:m.a}}},contacts:{doctype:f.Contact.doctype}}},OTOu:function(e,t,n){"use strict";var r=n("btPC"),a=n.n(r),o=a()("cozy-".concat("photos"));a.a.enable(),a.a.suggest.allow("cozy-".concat("photos"),"log"),a.a.suggest.allow("cozy-".concat("photos"),"info"),t.a=o},OjRq:function(e,t,n){"use strict";n.d(t,"b",(function(){return r.CozyFile})),n.d(t,"c",(function(){return r.Group})),n.d(t,"a",(function(){return b}));var r=n("Le8U"),a=n("lwsE"),o=n.n(a),i=n("W8MJ"),c=n.n(i),l=n("7W2i"),s=n.n(l),u=n("a1gu"),d=n.n(u),p=n("Nsbk"),m=n.n(p),f=n("FiiU");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}var b=function(e){s()(n,e);var t=h(n);function n(){return o()(this,n),t.apply(this,arguments)}return c()(n,null,[{key:"getInitials",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(n.isContact(e))return Object(f.getInitials)(e);var r=e.public_name||e.name||e.email;return r&&r[0].toUpperCase()||t}},{key:"getDisplayName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return n.isContact(e)?Object(f.getDisplayName)(e):e.public_name||e.name||e.email||t}}]),n}(r.Contact)},RPnM:function(e,t,n){"use strict";var r=n("lwsE"),a=n.n(r),o=n("W8MJ"),i=n.n(o),c=n("7W2i"),l=n.n(c),s=n("a1gu"),u=n.n(s),d=n("Nsbk"),p=n.n(d),m=n("kKu1"),f=n.n(m),h=n("q1tI"),b=n.n(h),y=n("KXWi"),v=n("V2U0"),g=n("yoMi");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u()(this,n)}}var E=function(e){l()(n,e);var t=_(n);function n(e){var r;return a()(this,n),(r=t.call(this,e)).state={fetching:!1},r}return i()(n,[{key:"handleClick",value:function(){var e=this;this.setState({fetching:!0}),this.props.onClick().then((function(){return e.setState({fetching:!1})}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.width,a=void 0===r?"100%":r,o=this.state.fetching;return b.a.createElement("div",{style:{width:a},className:f.a["pho-list-morebutton"]},o&&b.a.createElement(y.a,{disabled:!0,theme:"secondary",label:b.a.createElement(v.b,{color:g.dodgerBlue,nomargin:!0})}),!o&&b.a.createElement(y.a,{theme:"secondary",onClick:function(){return e.handleClick()},label:n}))}}]),n}(h.Component);t.a=E},SvPG:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v}));var r=n("pVnL"),a=n.n(r),o=n("QILm"),i=n.n(o),c=n("q1tI"),l=n.n(c),s=n("buk/"),u=n("KXWi"),d=n("Pxjx"),p=n("swni"),m=n.n(p),f=["disabled","onClick"],h=function(e){var t=e.disabled,n=e.onClick,r=i()(e,f),o=Object(s.useI18n)().t;return l.a.createElement(u.a,a()({"data-testid":"more-button",className:m.a["dri-btn--more"],theme:"secondary",disabled:t,onClick:n,extension:"narrow",icon:d.a,iconOnly:!0,label:o("Toolbar.more")},r))},b=n("17x9"),y=function(e){var t=e.className,n=Object(s.useI18n)().t;return l.a.createElement(u.b,{label:n("Share.create-cozy"),icon:"cloud",className:t,href:"https://manager.cozycloud.cc/cozy/create",size:"normal"})};y.propTypes={from:n.n(b).a.string},y.defaultProps={from:""};var v=y},SvWF:function(e,t,n){"use strict";n.d(t,"b",(function(){return h}));var r=n("q1tI"),a=n.n(r),o=n("buk/"),i=n("GoJ1"),c=n("KXWi"),l=n("4BeY"),s=n.n(l),u=n("IaFt"),d=n.n(u),p=new s.a({id:"icon-image-broken_a4fd70a7dc9c96a1d21491390660382c",use:"icon-image-broken_a4fd70a7dc9c96a1d21491390660382c-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="icon-image-broken_a4fd70a7dc9c96a1d21491390660382c">\n  <g fill="none" fill-rule="evenodd" transform="translate(0 2)">\n    <rect width="32" height="28" fill="#FDD5D5" rx="2" />\n    <path fill="#F52D2D" d="M24,20 L13,15 L19.2902805,8.70971949 C19.6822478,8.31775224 20.3203148,8.32031476 20.7062149,8.7062149 L29,17 L24,20 Z" />\n    <path fill="#F52D2D" d="M0,22 L6.29028051,15.7097195 C6.68224776,15.3177522 7.31387329,15.3138733 7.70591205,15.7059121 L11,19 L15.0233154,14.9766846 L24,19 L27.2486572,17.2486572 L32,22 L32,26.0020869 C32,27.1055038 31.1107383,28 29.9982567,28 L2.00174332,28 C0.89621101,28 0,27.1017394 0,26.0020869 L0,22 Z" />\n    <circle cx="8" cy="7" r="3" fill="#FFFFFF" />\n    <path stroke="#FDD5D5" d="M11,18.3000031 L5.5,23.8000031 L11,18.3000031 Z" stroke-linecap="round" stroke-linejoin="round" />\n    <polyline stroke="#FFFFFF" stroke-width="2" points="0 17 8 13 24 20 32 16" stroke-linecap="round" stroke-linejoin="round" />\n  </g>\n</symbol>'}),m=(d.a.add(p),p),f=Object(o.translate)()((function(e){var t=e.t,n=e.errorType;return a.a.createElement(i.a,{title:t("Error.".concat(n,"_title")),icon:m},a.a.createElement(c.c,{onClick:function(){return window.location.reload()},label:t("Error.refresh")}))})),h=function(e,t,n){return function(r){return e(r)?a.a.createElement(f,{errorType:t}):a.a.createElement(n,r)}};t.a=f},TtgU:function(e,t,n){"use strict";var r=n("lwsE"),a=n.n(r),o=n("W8MJ"),i=n.n(o),c=n("7W2i"),l=n.n(c),s=n("a1gu"),u=n.n(s),d=n("Nsbk"),p=n.n(d),m=n("kKu1"),f=n.n(m),h=n("q1tI"),b=n.n(h),y=n("CMvH"),v=n("buk/"),g=n("sIaW"),_=n.n(g),E=n("TSYQ"),w=n.n(E),O=n("lSNA"),j=n.n(O),x=n("SOjZ"),k=n("6se/"),C=function(e){var t=e.photo,n=e.box,r=e.selected,a=void 0!==r&&r,o=e.onToggle,i=function(e){var t={};return e&&(e.width&&(t.width="".concat(e.width,"px")),e.height&&(t.height="".concat(e.height,"px")),e.top&&(t.top="".concat(e.top,"px")),e.left&&(t.left="".concat(e.left,"px"))),t}(n);return b.a.createElement("div",{style:i,"data-test-item":t.name,className:w()(f.a["pho-photo"],j()({},f.a["pho-photo--selected"],a))},b.a.createElement("div",null,b.a.createElement("span",{className:f.a["pho-photo-select"],"data-input":"checkbox",onClick:function(e){e.stopPropagation(),o(t,a)}},b.a.createElement("input",{type:"checkbox",checked:a,onChange:function(){}}),b.a.createElement("label",null)),b.a.createElement(x.b,{to:t.id},b.a.createElement(k.a,{file:t,linkType:"small",render:function(e){return b.a.createElement("img",{"data-testid":"pho-photo-item",src:e,className:f.a["pho-photo-item"],style:i})}}))))};function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u()(this,n)}}var S={width:1,height:1},P=function(e){return 180+(e||1800)/30},z=function(e){l()(n,e);var t=A(n);function n(){return a()(this,n),t.apply(this,arguments)}return i()(n,[{key:"isPhotoSelected",value:function(e,t){return-1!==t.map((function(e){return e._id})).indexOf(e._id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.key,a=t.title,o=t.photos,i=t.selected,c=t.showSelection,l=t.onPhotoToggle,s=t.onPhotosSelect,u=t.onPhotosUnselect,d=t.containerWidth;if(!d)return null;var p=d>=768?{spacing:16,padding:32}:{spacing:8,padding:0},m=_()(o.map((function(e){var t=e.metadata||e.attributes.metadata;return t&&t.width&&t.height?function(e){return e.orientation&&e.orientation>4?{width:e.height,height:e.width}:e}(t):S})),{containerWidth:d,targetRowHeight:P(d),boxSpacing:{horizontal:p.spacing,vertical:p.spacing},containerPadding:{top:0,right:p.padding,bottom:0,left:p.padding}}),h=i.map((function(e){return e._id})),y=o.every((function(e){return-1!==h.indexOf(e._id)})),v=m.boxes[0].top,g=m.boxes.findIndex((function(e){return e.top!==v})),E=-1===g?m.boxes[m.boxes.length-1]:m.boxes[g-1],O=d-E.left-E.width-p.padding;return b.a.createElement("div",{"data-testid":"photo-section",className:w()(f.a["pho-section"],c&&f.a["pho-section--has-selection"]),key:r,style:{width:"".concat(d,"px")}},b.a.createElement("div",{className:f.a["pho-section-header"]},b.a.createElement("h3",null,a),c&&o.length>1&&y&&b.a.createElement("a",{style:{marginRight:"".concat(O,"px")},onClick:function(){return u(o)}},n("Board.unselect_all")),c&&o.length>1&&!y&&b.a.createElement("a",{style:{marginRight:"".concat(O,"px")},onClick:function(){return s(o)}},n("Board.select_all"))),b.a.createElement("div",{className:f.a["pho-photo-wrapper"],style:{width:"".concat(d,"px"),height:"".concat(m.containerHeight,"px")}},o.map((function(t,n){return b.a.createElement(C,{photo:t,box:m.boxes[n],key:t.id+n,selected:e.isPhotoSelected(t,i),onToggle:l})}))))}}]),n}(h.Component),R=Object(v.translate)()(z),D=n("KOJc"),T=n("ZFPb"),N=n("SvWF"),q=n("RPnM");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u()(this,n)}}var I=function(e){l()(n,e);var t=M(n);function n(){return a()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.f,r=e.lists,a=e.selected,o=e.photosContext,i=e.showSelection,c=e.onPhotoToggle,l=e.onPhotosSelect,s=e.onPhotosUnselect,u=e.fetchStatus,d=e.hasMore,p=e.fetchMore,m=e.measureRef,h=e.contentRect.entry.width,y=e.lastFetch,v=("pending"===u||"loading"===u)&&!y;return"failed"===u?b.a.createElement(N.a,{errorType:"".concat(o,"_photos")}):v?b.a.createElement(T.a,{loadingType:"photos_fetching"}):v||0!==r.length&&0!==r[0].photos.length?b.a.createElement("div",{className:i?f.a["pho-list-selection"]:"",ref:m},r.map((function(e,t){return b.a.createElement(R,{key:t,title:e.title||(e.month?n(e.month,"MMMM YYYY"):""),photos:e.photos,selected:a,showSelection:i,onPhotoToggle:c,onPhotosSelect:l,onPhotosUnselect:s,containerWidth:h})})),d&&b.a.createElement(q.a,{label:t("Board.load_more"),width:h,onClick:p})):b.a.createElement(D.a,{localeKey:"".concat(o,"_photos")})}}]),n}(h.Component);t.a=Object(v.translate)()(Object(y.a)()(I))},VZRP:function(e,t,n){e.exports={"pho-content-title":"pho-content-title--3Yt9z",error:"error--2qbV5","pho-content-header":"pho-content-header--1M4IS","--hide-bar":"_--hide-bar--lrytb","pho-content-album-previous":"pho-content-album-previous--3BqBh",spin:"spin--1ZeSG",shake:"shake--3WZrZ"}},"XA+M":function(e,t){e.exports={name:"Drive",name_prefix:"Cozy",slug:"drive",version:"1.55.0",type:"webapp",licence:"AGPL-3.0",icon:"public/app-icon.svg",categories:["cozy"],source:"https://github.com/cozy/cozy-drive",editor:"Cozy",developer:{name:"Cozy Cloud",url:"https://cozy.io"},locales:{en:{short_description:"Cozy Drive helps you to save, sync and secure your files on your Cozy.",long_description:"With Cozy Drive, you can easily:\n- Store your important files and keep them secure in your Cozy\n- Access to all your documents online & offline, from your desktop, and on your smartphone or tablet\n- Share links to files ans folders with who you like;\n- Automatically retrieve bills, payrolls, tax notices and other data from your main online services (internet, energy, retail, mobile, energy, travel...)\n- Upload files to your Cozy from your Android",screenshots:["screenshots/en/screenshot01.png","screenshots/en/screenshot02.png","screenshots/en/screenshot03.png","screenshots/en/screenshot04.png"]},fr:{short_description:"Cozy Drive est l’application de sauvegarde, de synchronisation et de sécurisation de tous vos fichiers sur Cozy.",long_description:"Avec Cozy Drive vous pourrez :\n- Sauvegarder et synchroniser gratuitement tous vos documents importants (carte d’identité, photos de vacances, avis d’imposition, fiches de salaires…);\n- Accéder à vos documents n’importe quand, n’importe ou même en mode avion depuis votre bureau, votre smartphone ou tablette;\n- Partager vos fichiers et dossiers par lien avec qui vous le souhaitez;\n- Récupérer automatiquement vos documents administratifs de vos principaux fournisseurs de service (opérateur mobile, fournisseur d’énergie, assureur, internet, santé…);\n- Rester synchronisé·e lors de vos voyages et déplacements professionnels avec nos applications mobiles.",screenshots:["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png","screenshots/fr/screenshot03.png","screenshots/fr/screenshot04.png"]}},screenshots:["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png","screenshots/fr/screenshot03.png","screenshots/fr/screenshot04.png"],langs:["en","fr"],routes:{"/":{folder:"/",index:"index.html",public:!1},"/intents":{folder:"/intents",index:"index.html",public:!1},"/public":{folder:"/public",index:"index.html",public:!0},"/preview":{folder:"/public",index:"index.html",public:!0}},intents:[{action:"OPEN",type:["io.cozy.files"],href:"/intents"},{action:"GET_URL",type:["io.cozy.files"],href:"/intents"},{action:"OPEN",type:["io.cozy.suggestions"],href:"/intents"}],services:{qualificationMigration:{type:"node",file:"services/qualificationMigration/drive.js",trigger:"@event io.cozy.files:CREATED,UPDATED",debounce:"24h"},dacc:{type:"node",file:"services/dacc/drive.js",trigger:"@monthly on the 5-7 between 2pm and 7pm"}},permissions:{files:{description:"Required to access the files",type:"io.cozy.files",verbs:["ALL"]},allFiles:{description:"Required to access the files",type:"io.cozy.files.*",verbs:["ALL"]},apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET"]},sharings:{description:"Required to have access to the sharings in realtime",type:"io.cozy.sharings",verbs:["GET"]},albums:{description:"Required to manage photos albums",type:"io.cozy.photos.albums",verbs:["PUT","GET"]},contacts:{type:"io.cozy.contacts",verbs:["GET","POST"]},groups:{type:"io.cozy.contacts.groups",verbs:["GET"]},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]},oauth:{description:"Required to display the cozy-desktop banner",type:"io.cozy.oauth.clients",verbs:["GET"]},errorsreporting:{description:"Allow to report unexpected errors to the support team",type:"cc.cozycloud.errors",verbs:["POST"]},mail:{description:"Send feedback emails to the support team",type:"io.cozy.jobs",verbs:["POST"],selector:"worker",values:["sendmail"]},konnectors:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.konnectors",verbs:["GET"]},accounts:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.accounts",verbs:["GET"]},triggers:{description:"Required to display additional information in the viewer for files automatically retrieved by services",type:"io.cozy.triggers",verbs:["GET"]},dacc:{type:"cc.cozycloud.dacc_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized measures to the DACC shared among mycozy.cloud's Cozy."},"dacc-eu":{type:"eu.mycozy.dacc_v2",verbs:["POST"],description:"Remote-doctype required to send anonymized measures to the DACC shared among mycozy.eu's Cozy."}}}},Yo2A:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b}));var r=n("fvjX"),a=n("lSNA"),o=n.n(a),i=n("q1tI"),c=n.n(i),l=n("Vg22");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1,component:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODAL":return{show:!0,component:t.component};case"HIDE_MODAL":return{show:!1,component:null};default:return e}},d=function(e){return{type:"SHOW_MODAL",component:e,meta:{hideActionMenu:!0}}},p=Object(l.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.ui.modal)}))((function(e){var t=e.show,n=e.component,r=e.dispatch;return t?c.a.cloneElement(n,{onClose:function(e){return r(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"HIDE_MODAL",meta:e}}(e))}}):null})),m=n("J4zp"),f=n.n(m),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=f()(t,2),r=n[0],a=n[1],o=void 0===a||a;return e[r]=decodeURIComponent(o),e},b=function(){return window.location.search.substring(1).split("&").map((function(e){return e.split("=")})).reduce(h,{})};t.b=Object(r.combineReducers)({modal:u})},ZFPb:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=n("TSYQ"),i=n.n(o),c=n("buk/"),l=n("V2U0"),s=n("7jrE"),u=n.n(s),d=n("5ZYL"),p=n.n(d);t.a=Object(c.translate)()((function(e){var t=e.size,n=void 0===t?"xxlarge":t,r=e.loadingType,o=e.noMargin,c=void 0!==o&&o,s=e.middle,d=void 0===s||s;return a.a.createElement("div",{"data-testid":"loading",className:i()(p.a["pho-loading"])},a.a.createElement(l.b,{size:n,loadingType:r,color:u.a.dodgerBlue,noMargin:c,middle:d}))}))},cwrA:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f}));var r=n("q1tI"),a=n.n(r),o=n("B9Y0"),i=n("s0VD"),c=n("TBZM"),l=n("/dzn"),s=n("EhdM"),u=n("V4z/"),d=n("SH7X"),p=n("A5W6"),m=function(){var e=Object(p.b)(),t=Object(d.useQuery)(e.definition,e.options);return"loaded"!=t.fetchStatus?null:a.a.createElement(h,{photos:t.data})},f=function(){var e=Object(u.q)().albumId,t=Object(p.a)(e),n=Object(d.useQuery)(t.definition,t.options);return"loaded"!=n.fetchStatus?null:a.a.createElement(h,{photos:n.data.photos.data})},h=function(e){var t=e.photos,n=Object(u.o)(),d=Object(u.q)().photoId,p=Object(r.useMemo)((function(){return t?t.findIndex((function(e){return e.id===d})):0}),[t,d]);return a.a.createElement(o.a,null,a.a.createElement(i.a,{files:t,currentIndex:p,onChangeRequest:function(e){return n("../".concat(e.id))},onCloseRequest:function(){return n("..")}},a.a.createElement(c.a,null,a.a.createElement(s.a,null),a.a.createElement(l.a,null))))}},dBw4:function(e,t,n){"use strict";var r=n("q1tI"),a=n.n(r),o=(n("59mS"),n("3FT0"),n("xIbs"));t.a=function(e){var t=e.children;return a.a.createElement(o.a,null,t)}},kGy0:function(e,t,n){var r={"./en.json":"8WAw","./fr.json":"H488"};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id="kGy0"},kKu1:function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--lQY3Q","CozyTheme--normal":"CozyTheme--normal--21hb4","pho-section":"pho-section--aOGQ8","pho-photo-wrapper":"pho-photo-wrapper--34Af_","pho-section-header":"pho-section-header--3xCwP","pho-photo":"pho-photo--1RccV","pho-photo-item":"pho-photo-item--1uvPt","pho-photo-select":"pho-photo-select--2_YlY","pho-photo--selected":"pho-photo--selected--3CHFZ","pho-section--has-selection":"pho-section--has-selection--2A-rj","pho-list-morebutton":"pho-list-morebutton--1HHd8",spin:"spin--3HNuy",shake:"shake--p49Dg"}},lEMr:function(e,t,n){e.exports={"upload-queue":"upload-queue--2RXFj","CozyTheme--inverted":"CozyTheme--inverted--3LpFU","CozyTheme--normal":"CozyTheme--normal--3194H","upload-queue--visible":"upload-queue--visible--frmGj","upload-queue-header":"upload-queue-header--Vz871","upload-queue-header-inner":"upload-queue-header-inner--1AQpy","btn-close":"btn-close--32K_q","upload-queue-progress":"upload-queue-progress--2O2Rw","upload-queue-content":"upload-queue-content--UNBUz","upload-queue--collapsed":"upload-queue--collapsed--nIVVP","upload-queue-list":"upload-queue-list--2dzTR","upload-queue-item--error":"upload-queue-item--error--3UNkr","upload-queue-item--done":"upload-queue-item--done--23Ps1","upload-queue-item":"upload-queue-item--2oTRx","item-cell":"item-cell--1mZJx","item-file":"item-file--24emt","item-ext":"item-ext--3vgYK","item-image":"item-image--wp0ZG","item-status":"item-status--2Azg6","item-pending":"item-pending--wp4pw",spin:"spin--3291m",shake:"shake--eSk8B"}},lJfM:function(e,t,n){e.exports={empty:"empty--18MhH"}},luXY:function(e,t,n){e.exports={"pho-create-album-form":"pho-create-album-form--xgUhP",error:"error--2VcpR","CozyTheme--inverted":"CozyTheme--inverted--YSD9X","CozyTheme--normal":"CozyTheme--normal--knWRd","coz-create-album-label":"coz-create-album-label--2zpY4","coz-inline-form":"coz-inline-form--3COco","coz-input-text":"coz-input-text--ZuuYG","create-button":"create-button--1cJgR",spin:"spin--1T4Vk",shake:"shake--3cnvd"}},nEYx:function(e,t,n){"use strict";var r=n("lSNA"),a=n.n(r),o=n("TSYQ"),i=n.n(o),c=n("q1tI"),l=n.n(c),s=n("17x9"),u=n.n(s),d=n("asgm"),p=n("y6ex"),m=n("1soK"),f=n("t0Aa"),h=n.n(f),b=function(e){var t=e.label,n=e.inMenu,r=e.disabled,o=e.onUpload,c=e.className;return l.a.createElement(d.a,{accept:"image/*",className:i()(c,a()({},"".concat(h.a["c-btn"]),!n)),"data-testid":"upload-btn",disabled:r,multiple:!0,onChange:o,value:[]},l.a.createElement("span",null,!n&&l.a.createElement(p.default,{icon:m.a}),l.a.createElement("span",null,t)))};b.propTypes={label:u.a.string.isRequired,disabled:u.a.bool,inMenu:u.a.bool,onUpload:u.a.func.isRequired,className:u.a.string.isRequired},b.defaultProps={disabled:!1,inMenu:!1},t.a=b},nS3w:function(e,t,n){"use strict";var r=n("J4zp"),a=n.n(r),o=n("q1tI"),i=n.n(o),c=n("17x9"),l=n.n(c),s=n("8Z8b"),u=n("mQgz"),d=n("SvPG"),p=function(e){var t=e.actions,n=Object(o.useRef)(null),r=Object(o.useState)(!1),c=a()(r,2),l=c[0],p=c[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{ref:n},i.a.createElement(d.b,{"aria-controls":"more-menu","aria-haspopup":"true",onClick:function(){p(!l)}})),i.a.createElement(s.a,{disableEnforceFocus:!0,disableRestoreFocus:!0,id:"more-menu",ref:n,open:l,actions:Object(u.c)(t),anchorOrigin:{vertical:"bottom",horizontal:"right"},autoClose:!0,onClose:function(){return p(!1)}}))};p.propTypes={actions:l.a.array.isRequired},t.a=p},nw0P:function(e,t,n){var r={"./_lib/build_formatting_tokens_reg_exp/index.js":"kOWh","./ar/build_distance_in_words_locale/index.js":"XxX6","./ar/build_format_locale/index.js":"alis","./ar/index.js":"EDRf","./be/build_distance_in_words_locale/index.js":"LQ09","./be/build_format_locale/index.js":"kj7F","./be/index.js":"YEhR","./bg/build_distance_in_words_locale/index.js":"7K3h","./bg/build_format_locale/index.js":"RrdL","./bg/index.js":"isx8","./ca/build_distance_in_words_locale/index.js":"wqqj","./ca/build_format_locale/index.js":"qcV0","./ca/index.js":"Vwa+","./cs/build_distance_in_words_locale/index.js":"ZKDM","./cs/build_format_locale/index.js":"ipyF","./cs/index.js":"dvhP","./da/build_distance_in_words_locale/index.js":"2Mgc","./da/build_format_locale/index.js":"Gned","./da/index.js":"7ur/","./de/build_distance_in_words_locale/index.js":"5IWf","./de/build_format_locale/index.js":"THCn","./de/index.js":"bgw5","./el/build_distance_in_words_locale/index.js":"o/GB","./el/build_format_locale/index.js":"8T9h","./el/index.js":"dH0v","./en/build_distance_in_words_locale/index.js":"LZbM","./en/build_format_locale/index.js":"6DAA","./en/index.js":"Us+F","./eo/build_distance_in_words_locale/index.js":"qrnn","./eo/build_format_locale/index.js":"Bl15","./eo/index.js":"UB7v","./es/build_distance_in_words_locale/index.js":"GEfZ","./es/build_format_locale/index.js":"O+zC","./es/index.js":"/S0t","./fi/build_distance_in_words_locale/index.js":"VHtQ","./fi/build_format_locale/index.js":"Oydx","./fi/index.js":"ndVD","./fil/build_distance_in_words_locale/index.js":"uq4p","./fil/build_format_locale/index.js":"d7hw","./fil/index.js":"pNfm","./fr/build_distance_in_words_locale/index.js":"IzMR","./fr/build_format_locale/index.js":"I3Zg","./fr/index.js":"LKA2","./hr/build_distance_in_words_locale/index.js":"DPvn","./hr/build_format_locale/index.js":"puw3","./hr/index.js":"L9Jq","./hu/build_distance_in_words_locale/index.js":"w2RQ","./hu/build_format_locale/index.js":"/0iD","./hu/index.js":"Nm+E","./id/build_distance_in_words_locale/index.js":"JbvB","./id/build_format_locale/index.js":"0wlw","./id/index.js":"A6C3","./is/build_distance_in_words_locale/index.js":"qzMC","./is/build_format_locale/index.js":"S3yD","./is/index.js":"N4bE","./it/build_distance_in_words_locale/index.js":"MDEp","./it/build_format_locale/index.js":"aUJd","./it/index.js":"hmb4","./ja/build_distance_in_words_locale/index.js":"nNvt","./ja/build_format_locale/index.js":"buui","./ja/index.js":"uAXs","./ko/build_distance_in_words_locale/index.js":"oEw+","./ko/build_format_locale/index.js":"9SQf","./ko/index.js":"iW8+","./mk/build_distance_in_words_locale/index.js":"nmwZ","./mk/build_format_locale/index.js":"htxJ","./mk/index.js":"GzBU","./nb/build_distance_in_words_locale/index.js":"SL1f","./nb/build_format_locale/index.js":"CJ5F","./nb/index.js":"73vv","./nl/build_distance_in_words_locale/index.js":"Uyu0","./nl/build_format_locale/index.js":"doCD","./nl/index.js":"hCQt","./pl/build_distance_in_words_locale/index.js":"FUBD","./pl/build_format_locale/index.js":"nOYf","./pl/index.js":"B6yL","./pt/build_distance_in_words_locale/index.js":"aTPA","./pt/build_format_locale/index.js":"TTT0","./pt/index.js":"gdks","./ro/build_distance_in_words_locale/index.js":"gI+A","./ro/build_format_locale/index.js":"njjO","./ro/index.js":"r2yp","./ru/build_distance_in_words_locale/index.js":"KmPx","./ru/build_format_locale/index.js":"UUBw","./ru/index.js":"nz/o","./sk/build_distance_in_words_locale/index.js":"q2Bs","./sk/build_format_locale/index.js":"9sxn","./sk/index.js":"Wqan","./sl/build_distance_in_words_locale/index.js":"mlv2","./sl/build_format_locale/index.js":"vHkZ","./sl/index.js":"KYSo","./sr/build_distance_in_words_locale/index.js":"LlkS","./sr/build_format_locale/index.js":"RhjJ","./sr/index.js":"7mU3","./sv/build_distance_in_words_locale/index.js":"UNBN","./sv/build_format_locale/index.js":"zTNB","./sv/index.js":"hxgj","./th/build_distance_in_words_locale/index.js":"XAGa","./th/build_format_locale/index.js":"We2s","./th/index.js":"Pk+z","./tr/build_distance_in_words_locale/index.js":"aFZF","./tr/build_format_locale/index.js":"jh7A","./tr/index.js":"3ZWG","./zh_cn/build_distance_in_words_locale/index.js":"KdB7","./zh_cn/build_format_locale/index.js":"l4EP","./zh_cn/index.js":"8tMq","./zh_tw/build_distance_in_words_locale/index.js":"vyyr","./zh_tw/build_format_locale/index.js":"uYH7","./zh_tw/index.js":"QPlQ"};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id="nw0P"},oGE2:function(e,t,n){"use strict";n.r(t);var r=n("lSNA"),a=n.n(r),o=(n("/8/d"),n("q1tI")),i=n.n(o),c=n("i8i4"),l=n("Vg22"),s=n("fvjX"),u=n("sINF"),d=n("1mXj"),p=n("SH7X"),m=n.n(p),f=n("oJ5p"),h=n("1I/2"),b=n("buk/"),y=n("UmWK"),v=n("qvEe"),g=n("z6Q1"),_=n("o0o1"),E=n.n(_),w=n("yXPU"),O=n.n(w),j=n("RIqP"),x=n.n(j),k=n("OTOu"),C=n("67rm"),A=n("lwsE"),S=n.n(A),P=n("W8MJ"),z=n.n(P),R=n("PJYZ"),D=n.n(R),T=n("7W2i"),N=n.n(T),q=n("a1gu"),M=n.n(q),I=n("Nsbk"),U=n.n(I),L=n("TSYQ"),F=n.n(L),B=n("V2U0"),Y=n("y6ex"),G=n("yoMi"),W=n("JL3L"),V=n("s2wB"),Q=n("hE6O"),H=n("OjRq"),Z=n("lEMr"),J=n.n(Z);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var X=Object(b.translate)()((function(e){return i.a.createElement("span",{className:J.a["item-pending"]},e.t("UploadQueue.item.pending"))})),$=Object(b.translate)()((function(e){var t,n,r=e.file,o=e.status,c=H.b.splitFilename(r),l=c.filename,s=c.extension;switch(o){case"loading":n=i.a.createElement(B.b,{className:"u-ml-half",color:G.dodgerBlue});break;case"cancel":n=i.a.createElement(Y.default,{className:"u-ml-half u-warning",icon:W.a});break;case"failed":case"conflict":case"network":n=i.a.createElement(Y.default,{className:"u-ml-half u-warning",icon:V.a});break;case"loaded":n=i.a.createElement(Y.default,{className:"u-ml-half u-success",icon:Q.a});break;case"pending":default:n=i.a.createElement(X,null)}return i.a.createElement("div",{className:F()(J.a["upload-queue-item"],(t={},a()(t,J.a["upload-queue-item--done"],"loaded"===o),a()(t,J.a["upload-queue-item--error"],"failed"===o||"conflict"===o),t))},i.a.createElement("div",{className:F()(J.a["item-cell"],J.a["item-file"],J.a["item-image"])},i.a.createElement("div",null,l,s&&i.a.createElement("span",{className:J.a["item-ext"]},s))),i.a.createElement("div",{className:J.a["item-status"]},n))})),ee=Object(b.translate)()((function(e){var t=e.t,n=e.total,r=e.done;return i.a.createElement("div",{className:J.a["upload-queue-header-inner"]},i.a.createElement("span",{className:"coz-desktop"},t("UploadQueue.header",{smart_count:n})),i.a.createElement("span",{className:"u-hide--desk"},t("UploadQueue.header_mobile",{done:r,total:n})))})),te=Object(b.translate)()((function(e){var t=e.t,n=e.total,r=e.successful,a=e.onClose;return i.a.createElement("div",{"data-testid":"upload-queue-success",className:J.a["upload-queue-header-inner"]},i.a.createElement("span",null,t("UploadQueue.header_done",{done:r,total:n})),i.a.createElement("button",{className:F()(J.a["btn-close"]),onClick:a},t("UploadQueue.close")))})),ne=function(e){N()(n,e);var t=K(n);function n(){var e;S()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),a()(D()(e),"state",{collapsed:!1}),a()(D()(e),"toggleCollapsed",(function(){e.setState((function(e){return{collapsed:!e.collapsed}}))})),e}return z()(n,[{key:"render",value:function(){var e,t=this.props,n=t.queue,r=t.doneCount,o=t.successCount,c=t.purgeQueue,l=this.state.collapsed;return i.a.createElement("div",{"data-testid":"upload-queue",className:F()(J.a["upload-queue"],(e={},a()(e,J.a["upload-queue--visible"],0!==n.length),a()(e,J.a["upload-queue--collapsed"],l),e))},i.a.createElement("h4",{className:J.a["upload-queue-header"],onDoubleClick:this.toggleCollapsed},r<n.length?i.a.createElement(ee,{total:n.length,done:r}):i.a.createElement(te,{total:n.length,successful:o,onClose:c})),i.a.createElement("progress",{className:J.a["upload-queue-progress"],value:r,max:n.length}),i.a.createElement("div",{className:J.a["upload-queue-content"]},i.a.createElement("div",{className:J.a["upload-queue-list"]},n.map((function(e,t){return i.a.createElement($,{file:e.file,status:e.status,key:"file_".concat(t)})})))))}}]),n}(o.Component),re=Object(b.translate)()(Object(l.connect)((function(e){return{queue:ge(e),doneCount:_e(e).length,successCount:Ee(e).length}}),(function(e){return{purgeQueue:function(){return e(me())}}}))(ne)),ae=n("Yo2A"),oe=n("owKQ"),ie=function(e){var t=e.onClose;return i.a.createElement(oe.a,{onClose:t})},ce=function(e){return{file:e,status:"pending"}},le=function(e){switch(e.type){case"UPLOAD_FILE":return"loading";case"RECEIVE_UPLOAD_SUCCESS":return"loaded";default:return e.status}},se=function(e,t){return Object.assign({},e,{status:le(t)})},ue=Object(s.combineReducers)({queue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TO_UPLOAD_QUEUE":return[].concat(x()(e),x()(t.files.map((function(e){return ce(e)}))));case"PURGE_UPLOAD_QUEUE":return[];case"UPLOAD_FILE":case"RECEIVE_UPLOAD_SUCCESS":case"RECEIVE_UPLOAD_ERROR":return e.map((function(e){return e.file.name!==t.file.name?e:se(e,t)}));default:return e}}}),de=function e(t){return function(){var n=O()(E.a.mark((function n(r,a){var o,c,l;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=ge(a()).find((function(e){return"pending"===e.status}))){n.next=3;break}return n.abrupt("return",r(fe()));case 3:return c=o.file,n.prev=4,r({type:"UPLOAD_FILE",file:c}),n.next=8,t(c);case 8:r({type:"RECEIVE_UPLOAD_SUCCESS",file:c}),n.next=18;break;case 11:n.prev=11,n.t0=n.catch(4),k.a.log(n.t0),l={409:"conflict",413:"quota"}[n.t0.status]||/Failed to fetch$/.exec(n.t0.toString())||"failed",r({type:"RECEIVE_UPLOAD_ERROR",file:c,status:"conflict"===l?"conflict":"failed"}),"quota"===l&&r(Object(ae.d)(i.a.createElement(ie,{t:function(){}})));case 18:r(e(t));case 19:case"end":return n.stop()}}),n,null,[[4,11]])})));return function(e,t){return n.apply(this,arguments)}}()},pe=function(e,t){return function(){var n=O()(E.a.mark((function n(r){return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r({type:"ADD_TO_UPLOAD_QUEUE",files:e}),r(de(t));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},me=function(){return{type:"PURGE_UPLOAD_QUEUE"}},fe=function(){return function(e,t){var n=ge(t()),r=be(n),a=ye(n),o=ve(n);r.length||a.length?r.length&&!a.length?C.a.info("UploadQueue.alert.success_conflicts",{smart_count:o.length,conflictNumber:r.length}):C.a.error("UploadQueue.alert.errors"):C.a.success("UploadQueue.alert.success",{smart_count:o.length})}},he=function(e,t){return e.filter((function(e){return e.status===t}))},be=function(e){return he(e,"conflict")},ye=function(e){return he(e,"failed")},ve=function(e){return he(e,"loaded")},ge=function(e){return e.upload.queue},_e=function(e){return ge(e).filter((function(e){return"pending"!==e.status}))},Ee=function(e){return ve(ge(e))},we={upload:ue,ui:ae.b},Oe=n("V4z/"),je=n("SOjZ"),xe=n("le8I"),ke=n("jDpt"),Ce=n("9VR2"),Ae=n("fSd/"),Se=n("WUds"),Pe=n.n(Se),ze=n("snfs"),Re=n("mgfL"),De=n.n(Re),Te=n("oAJy"),Ne=n.n(Te),qe=n("GnT2"),Me=n("mwIZ"),Ie=n.n(Me),Ue=function(){return window.navigator&&-1===window.navigator.appVersion.indexOf("Win")&&-1===window.navigator.appVersion.indexOf("Mac")},Le=function(){return window.navigator.userAgent&&window.navigator.userAgent.indexOf("Android")>=0},Fe=function(){return window.navigator.userAgent&&/iPad|iPhone|iPod/.test(window.navigator.userAgent)},Be=function(){var e=O()(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={definition:Object(p.Q)("io.cozy.settings").getById("clients"),options:{as:"io.cozy.settings/clients",fetchPolicy:m.a.fetchPolicies.olderThan(3e4),singleDocData:!0}},e.next=3,t.fetchQueryAndGetFromState(n);case 3:return r=e.sent,a=r.data,e.abrupt("return",Object.values(a).some((function(e){return"github.com/cozy-labs/cozy-desktop"===Ie()(e,"attributes.software_id")})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=n("FKqX");function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var Qe=function(e){N()(r,e);var t,n=Ve(r);function r(){var e;S()(this,r);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return e=n.call.apply(n,[this].concat(o)),a()(D()(e),"state",{mustShow:!1}),e}return z()(r,[{key:"UNSAFE_componentWillMount",value:(t=O()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===Ye.promoteDesktop.isActivated&&!Object(ze.isFlagshipApp)()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ne.a.getItem("desktop_banner");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=!1;case 7:if(!e.t0){e.next=13;break}return e.next=11,Be(this.props.client);case 11:!e.sent&&this.setState((function(e){return We(We({},e),{},{mustShow:!0})}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){if(!0!==Ye.promoteDesktop.isActivated||!this.state.mustShow||Object(ze.isFlagshipApp)())return null;var e=this.props.t;return i.a.createElement(qe.a,{label:e("Nav.btn-client"),href:e(Ue()?"Nav.link-client":"Nav.link-client-desktop"),className:"u-m-1 u-dn-m"})}}]),r}(o.Component),He=Object(b.translate)()(Object(p.withClient)(Qe)),Ze=n("56YH"),Je=n.n(Ze),Ke=n("dexL"),Xe=n("KXWi"),$e=n("7jrE"),et=n.n($e),tt=n("eY+3"),nt=n("sbrb"),rt=n("AzIT"),at=n.n(rt);function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var it=function(e){N()(r,e);var t,n=ot(r);function r(e){var t;return S()(this,r),t=n.call(this,e),a()(D()(t),"state",{mustShow:!1}),t.willUnmount=!1,t}return z()(r,[{key:"componentDidMount",value:(t=O()(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.willUnmount=!1,e.next=3,Ne.a.getItem("desktop_banner");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=!1;case 6:if(e.t0){e.next=12;break}return e.next=10,Be(this.props.client);case 10:!e.sent&&!this.willUnmount&&this.setState({mustShow:!0});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){this.willUnmount=!0}},{key:"markAsSeen",value:function(){Ne.a.setItem("desktop_banner",!0),this.setState({mustShow:!1})}},{key:"render",value:function(){var e=this;if(!0!==Ye.promoteDesktop.isActivated||!this.state.mustShow)return null;var t=this.props.t,n=Fe()?"Nav.link-client-ios":Le()?"Nav.link-client-android":Ue()?"Nav.link-client":"Nav.link-client-desktop",r=Fe()||Le()?"Nav.btn-client-mobile":"Nav.banner-txt-client";return i.a.createElement("div",{className:at.a["coz-banner-client"]},i.a.createElement(Ke.a,{inline:!0,icon:i.a.createElement(Y.default,{icon:tt.a,size:"100%"}),text:t(r),bgcolor:et.a.paleGrey,buttonOne:i.a.createElement(Xe.b,{href:t(n),theme:"text",icon:nt.a,label:t("Nav.banner-btn-client"),onClick:function(){return e.markAsSeen("banner")}}),buttonTwo:i.a.createElement(Xe.c,{theme:"text",label:t("SelectionBar.close"),onClick:function(){e.markAsSeen("close")}})}))}}]),r}(o.Component),ct=Je()(Object(b.translate)(),p.withClient)(it),lt=n("0yyf"),st=n.n(lt),ut=Object(Ae.e)(je.c),dt=Object(b.translate)()((function(e){var t=e.t;return i.a.createElement(ke.b,null,i.a.createElement(Ce.a,{className:st.a["pho-sidebar"]},i.a.createElement(Ae.d,null,i.a.createElement(Ae.b,null,i.a.createElement(ut,{to:"/photos"},i.a.createElement(Ae.a,{icon:"image"}),i.a.createElement(Ae.c,null,t("Nav.photos")))),i.a.createElement(Ae.b,{"data-testid":"nav-to-albums"},i.a.createElement(ut,{to:"/albums"},i.a.createElement(Ae.a,{icon:"album"}),i.a.createElement(Ae.c,null,t("Nav.albums"))))),!Object(ze.isFlagshipApp)()&&i.a.createElement(He,null)),i.a.createElement(C.a,{t:t}),i.a.createElement(re,null),i.a.createElement(ke.c,{className:st.a["pho-content"]},!Object(ze.isFlagshipApp)()&&i.a.createElement(ct,null),i.a.createElement(Oe.b,null)),i.a.createElement(ae.a,null),i.a.createElement(xe.a,null),De()("debug")?i.a.createElement(Pe.a,null):null)})),pt=n("pVnL"),mt=n.n(pt),ft=n("QILm"),ht=n.n(ft),bt=n("17x9"),yt=n.n(bt),vt=n("VZRP"),gt=n.n(vt),_t=n("yDJO"),Et=n("ufaa"),wt=n("yFc8"),Ot=n("IFYe"),jt=(n("Bkvo"),function(e,t){return function(n){var r=n.children;return i.a.createElement(e,null,i.a.createElement(wt.default,{className:F()("u-flex u-flex-items-center",t),variant:"normal"},r))}}),xt=jt(Ot.a.BarCenter,"u-ellipsis"),kt=jt(Ot.a.BarRight),Ct=jt(Ot.a.BarLeft),At=(jt(Ot.a.BarSearch,"u-flex-grow"),n("J4zp")),St=n.n(At),Pt=function(e){var t=e.onEdit,n=e.albumName,r=Object(o.useState)(!1),a=St()(r,2),c=a[0],l=a[1],s=Object(o.useRef)(null);Object(o.useEffect)((function(){s.current.focus(),s.current.select()}),[]);return i.a.createElement("input",{type:"text",defaultValue:n,onKeyDown:function(e){13===e.keyCode&&t?(l(!0),t(e.target.value)):27===e.keyCode&&t&&(l(!0),t(n))},onBlur:function(e){!c&&t&&t(""!==e.target.value.trim()?e.target.value:n)},ref:s})};Pt.propTypes={albumName:yt.a.string,onEdit:yt.a.func.isRequired};var zt=Pt;function Rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var Dt=function(e){var t=e.children;return i.a.createElement("h2",{"data-testid":"pho-content-title",className:gt.a["pho-content-title"]},t)},Tt=function(e){var t=e.onClick;return i.a.createElement("div",{role:"button","data-testid":"pho-content-album-previous",className:gt.a["pho-content-album-previous"],onClick:t})};Tt.propTypes={onClick:yt.a.func.isRequired};var Nt=function(e){N()(n,e);var t=Rt(n);function n(){return S()(this,n),t.apply(this,arguments)}return z()(n,[{key:"componentDidMount",value:function(){var e=this.props.pathname;this.parentUrl=e.substring(0,e.lastIndexOf("/"))}},{key:"renderTitle",value:function(){var e=this.props,t=e.t,n=e.viewName,r=e.albumName,a=void 0===r?"":r,o=e.onEdit,c=e.editing;return"albumContent"===n?void 0!==c&&c?i.a.createElement(zt,{albumName:a,onEdit:o}):a:t("Nav.".concat(n))}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.viewName,a=t.breakpoints.isMobile,o=t.navigate,c=t.client,l=t.t,s="albumContent"===r,u=i.a.createElement(Dt,null,this.renderTitle()),d=a?i.a.createElement(xt,null,u):u,p=a?i.a.createElement(kt,null,i.a.createElement(_t.a,{client:c,store:this.context.store,t:l},i.a.createElement(y.a,{doctype:g.a,documentType:"Albums"},n))):n,m=i.a.createElement(Tt,{onClick:function(){return o(e.parentUrl)}}),f=a?i.a.createElement(Ct,null,m):m;return i.a.createElement("div",{className:gt.a["pho-content-header"]},s&&f,d,p)}}]),n}(o.Component);a()(Nt,"contextTypes",{store:yt.a.object.isRequired}),Nt.propTypes={viewName:yt.a.string.isRequired,albumName:yt.a.string,t:yt.a.func.isRequired,editing:yt.a.bool,onEdit:yt.a.func,breakpoints:yt.a.object.isRequired,children:yt.a.node},Nt.defaultProps={editing:!1,onEdit:function(){}};var qt=Je()(p.withClient,Object(Et.a)(),Object(b.translate)())((function(e){var t=Object(Oe.o)(),n=Object(Oe.m)().pathname;return i.a.createElement(Nt,mt()({},e,{navigate:t,pathname:n}))})),Mt=n("U0xp"),It=n("nEYx"),Ut=n("t0Aa"),Lt=n.n(Ut),Ft=n("nS3w"),Bt=n("zB5G"),Yt=function(e){var t=e.disabled,n=void 0!==t&&t,r=e.uploadPhotos,a=e.selectItems,o=Object(b.useI18n)().t,c=Object(h.b)().isMobile,l=c?[Object(Bt.i)(r,n),Mt.a,Object(Bt.g)(a)]:[Object(Bt.g)(a)];return i.a.createElement("div",{className:Lt.a["pho-toolbar"],role:"toolbar"},!c&&i.a.createElement(It.a,{onUpload:r,disabled:n,label:o("Toolbar.photo_upload")}),i.a.createElement(Ft.a,{actions:l}))};Yt.propTypes={disabled:yt.a.bool,uploadPhotos:yt.a.func.isRequired,selectItems:yt.a.func.isRequired,t:yt.a.func.isRequired};var Gt=Yt,Wt=n("2sk9"),Vt=n.n(Wt),Qt=n("e5eR"),Ht=function(e){var t=e.t,n=e.count,r=e.confirm,a=e.onClose,o=["trash","restore","shared"];!0===e.related&&o.push("related");var c=o.map((function(e){return i.a.createElement("p",{className:F()(Vt.a["fil-confirm-text"],Vt.a["icon-".concat(e)]),key:"key_delet_".concat(e)},t("timeline.DeleteConfirm.".concat(e),n))}));return i.a.createElement(Qt.a,{open:!0,onClose:a,title:t("timeline.DeleteConfirm.title",n),content:c,actions:i.a.createElement(i.a.Fragment,null,i.a.createElement(Xe.c,{theme:"secondary",onClick:a,label:t("timeline.DeleteConfirm.cancel")}),i.a.createElement(Xe.c,{theme:"danger",label:t("timeline.DeleteConfirm.delete"),onClick:r}))})},Zt=n("TtgU"),Jt=n("YJMV"),Kt=function(e){var t=e.navigate,n=Object(h.b)().isMobile,r=Object(b.useI18n)().t,a=[Object(Bt.e)(t)];return i.a.createElement("div",{"data-testid":"pho-toolbar-albums",className:Lt.a["pho-toolbar"],role:"toolbar"},n?i.a.createElement(Ft.a,{actions:a}):i.a.createElement(Xe.b,{"data-testid":"album-add",theme:"secondary",href:"#/albums/new",icon:Jt.a,label:r("Toolbar.album_new")}))},Xt=n("6qED"),$t=n.n(Xt),en=n("KOJc"),tn=n("RPnM"),nn=n("6se/"),rn=n("H/9E"),an=n("AJ6E");function on(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var cn=function(e){var t=e.album,n=e.image,r=e.title,a=e.desc;return i.a.createElement(je.b,{to:t._id,className:$t.a["pho-album-link"]},n,r,a)},ln=function(e){var t=e.album,n=e.image,r=e.title,a=e.desc,o=e.onClick;return e.disabled?i.a.createElement("div",{className:F()($t.a["pho-album-link"],$t.a["pho-album-link--disabled"])},n,i.a.createElement("div",null,r,a)):i.a.createElement("div",{onClick:function(){return o(t)},className:$t.a["pho-album-link"]},n,i.a.createElement("div",null,r,a))},sn=Object(b.translate)()((function(e){var t=e.t,n=e.photoCount,r=e.album;return i.a.createElement("h4",{className:$t.a["pho-album-description"]},i.a.createElement(rn.a,{docId:r.id,className:$t.a["pho-album-shared"],xsmall:!0}),i.a.createElement(an.a,{docId:r.id},(function(e){var r=e.isSharedWithMe,a=e.isSharedByMe,o=e.hasWriteAccess;return i.a.createElement("span",null,t("Albums.album_item_description",{smart_count:n}),(r||a)&&" - ".concat(t("Albums.album_item_shared_".concat(o?"rw":"ro"))))})))})),un=function(e){N()(n,e);var t=on(n);function n(){return S()(this,n),t.apply(this,arguments)}return z()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.album,r=e.shared,a=void 0===r?{}:r,o=e.onClick,c=e.thumbnail,l=a.readOnly,s=n.photos.data[0]||null,u=s?i.a.createElement(nn.a,{file:s,linkType:"small",render:function(e){return i.a.createElement("img",{src:e,className:$t.a["pho-album-photo-item"],alt:"".concat(n.name," album cover")})}}):i.a.createElement("div",{className:$t.a["pho-album-photo-item"]}),d=i.a.createElement(sn,{t:t,album:n,shared:a,thumbnail:c,photoCount:n.photos.count}),p=i.a.createElement("h2",{className:$t.a["pho-album-title"]},n.name);return i.a.createElement("div",{"data-testid":"pho-album","data-test-name":n.name,className:$t.a["pho-album"]},o?i.a.createElement(ln,{album:n,image:u,title:p,desc:d,onClick:o,disabled:l}):i.a.createElement(cn,{album:n,image:u,title:p,desc:d}))}}]),n}(o.Component),dn=function(e,t){return new Date(t.created_at||null)-new Date(e.created_at||null)},pn=Object(b.translate)()((function(e){var t=e.data,n=e.hasMore,r=e.fetchMore,a=e.t;return 0===t.length?i.a.createElement(en.a,{localeKey:"albums"}):i.a.createElement(ke.a,null,i.a.createElement("div",{className:$t.a["pho-album-list"]},t.sort(dn).map((function(e){return i.a.createElement(un,{album:e,key:e.id})})),n&&i.a.createElement(tn.a,{label:a("Albums.load_more"),onClick:r})))})),mn=n("ZFPb"),fn=n("SvWF"),hn=function(e){var t=e.list,n=t.fetchStatus;return t.lastFetch||"pending"!==n&&"loading"!==n?"failed"===n?i.a.createElement(fn.a,{errorType:"albums"}):i.a.createElement(pn,t):i.a.createElement(mn.a,{loadingType:"albums_fetching"})},bn=Object(b.translate)()((function(e){var t=e.albums,n=Object(Oe.o)();return t?i.a.createElement("div",{"data-testid":"album-pho-content-wrapper",className:st.a["pho-content-wrapper"]},i.a.createElement(qt,{viewName:"albums"},i.a.createElement(Kt,{navigate:n})),i.a.createElement(hn,{list:t}),i.a.createElement(Oe.b,null)):null})),yn=n("DA+R"),vn=n("FFOw"),gn=n("9jN0");function _n(e,t){return e?[t]:[]}var En=function(e){var t=e.t,n=e.album,r=e.sharedWithMe,a=e.readOnly,o=e.disabled,c=void 0!==o&&o,l=e.downloadAlbum,s=e.deleteAlbum,u=e.selectItems,d=e.onRename,p=e.shareAlbum,m=e.navigate,f=Object(h.b)().isMobile,b=[].concat(x()(_n(!r&&f,Object(Bt.h)(p,n))),[Object(Bt.c)(l,t("Toolbar.menu.download_album")),Object(Bt.f)(d)],x()(_n(!a,Object(Bt.d)(m))),x()(_n(f,Mt.a)),x()(_n(f,Object(Bt.g)(u))),[Mt.a],x()(_n(!r,Object(Bt.b)(s))));return i.a.createElement("div",{"data-testid":"pho-toolbar-album",className:Lt.a["pho-toolbar"],role:"toolbar"},!f&&i.a.createElement(i.a.Fragment,null,i.a.createElement(vn.a,{docId:n.id,onClick:function(){return p(n)}}),i.a.createElement(gn.a,{disabled:c,label:t("Albums.share.cta"),onClick:function(){return p(n)},docId:n.id})),i.a.createElement(Ft.a,{actions:b}))},wn=function(e){var t=e.t,n=e.confirm,r=e.onClose,a=["forbidden","eye","link"].map((function(e){return i.a.createElement("p",{className:F()(Vt.a["fil-confirm-text"],Vt.a["icon-".concat(e)]),key:e},t("destroyconfirmation.".concat(e)))}));return i.a.createElement(Qt.a,{open:!0,onClose:r,title:t("destroyconfirmation.title"),content:a,actions:i.a.createElement(i.a.Fragment,null,i.a.createElement(Xe.c,{theme:"secondary",onClick:r,label:t("destroyconfirmation.cancel")}),i.a.createElement(Xe.c,{theme:"danger",label:t("destroyconfirmation.delete"),onClick:n}))})},On=n("q/Uw");function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var Cn=function(e){N()(n,e);var t=kn(n);function n(){var e;S()(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),a()(D()(e),"state",{editing:!1,showAddAlbumModal:!1}),a()(D()(e),"showAddAlbumModal",(function(){e.setState((function(e){return xn(xn({},e),{},{showAddAlbumModal:!0})}))})),a()(D()(e),"hideAddAlbumModal",(function(){e.setState((function(e){return xn(xn({},e),{},{showAddAlbumModal:!1})}))})),a()(D()(e),"editAlbumName",(function(){e.setState((function(e){return xn(xn({},e),{},{editing:!0})}))})),a()(D()(e),"renameAlbum",(function(t){if(""!==t.trim())if(t!==e.props.album.name){var n=xn(xn({},e.props.album),{},{name:t});e.props.updateAlbum(n).then((function(){e.setState({editing:!1})})).catch((function(){C.a.error("Error.generic")}))}else e.setState({editing:!1});else C.a.error("Error.album_rename_abort")})),a()(D()(e),"downloadAlbum",O()(E.a.mark((function t(){var n,r;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.album,t.next=3,e.props.client.getStackClient().collection("io.cozy.files").findReferencedBy({_type:"io.cozy.photos.albums",_id:n.id},{limit:99999});case 3:r=t.sent,e.props.client.collection("io.cozy.files").downloadArchive(r.data.map((function(e){return e._id})),n.name);case 5:case"end":return t.stop()}}),t)})))),a()(D()(e),"downloadPhotos",(function(t){e.props.client.collection("io.cozy.files").downloadArchive(t.map((function(e){return e._id})),"selected")})),a()(D()(e),"closeDestroyConfirmModal",(function(){e.setState({displayDestroyConfirmModal:!1})})),a()(D()(e),"renderDestroyConfirm",(function(){var t=e.props,n=t.t,r=t.navigate,a=t.album,o=t.deleteAlbum;return i.a.createElement(wn,{t:n,albumName:a.name,onClose:e.closeDestroyConfirmModal,confirm:function(){return o(a).then((function(){r("/albums"),C.a.success("Albums.remove_album.success",{name:a.name})})).catch((function(){return C.a.error("Albums.remove_album.error.generic")}))}})})),a()(D()(e),"deleteAlbum",(function(){e.setState({displayDestroyConfirmModal:!0})})),e}return z()(n,[{key:"render",value:function(){var e=this;if(!this.props.album||!this.props.photos)return null;var t=this.props,n=t.t,r=t.album,a=t.shareAlbum,o=t.photos,c=t.hasMore,l=t.fetchMore,s=t.lastFetch,u=t.navigate,d=t.pathname,p=this.state.editing,m={};return i.a.createElement(On.a,{actions:function(t){return{"album-add":e.showAddAlbumModal,download:e.downloadPhotos,"album-remove":function(n){return e.props.removePhotos(r,n,t.clear)}}}},(function(t,f,h){return i.a.createElement("div",{"data-testid":"album-pho-content-wrapper",className:st.a["pho-content-wrapper"]},r.name&&r.photos.data&&i.a.createElement(qt,{viewName:"albumContent",albumName:r.name,editing:p,onEdit:e.renameAlbum},i.a.createElement(En,{navigate:u,pathname:d,t:n,album:r,sharedWithMe:m.withMe,sharedByMe:m.byMe,readOnly:m.readOnly,onRename:e.editAlbumName,downloadAlbum:e.downloadAlbum,deleteAlbum:e.deleteAlbum,shareAlbum:a})),e.state.displayDestroyConfirmModal&&e.renderDestroyConfirm(),e.state.showAddAlbumModal&&i.a.createElement(lr,{onDismiss:e.hideAddAlbumModal,onSuccess:h.clear,photos:t}),o&&i.a.createElement(Zt.a,{lists:[{photos:o}],selected:t,photosContext:"timeline",showSelection:f,onPhotoToggle:h.toggle,onPhotosSelect:h.select,onPhotosUnselect:h.unselect,fetchStatus:o.fetchStatus,hasMore:c,fetchMore:l,lastFetch:s}),i.a.createElement(Oe.b,null))}))}},{key:"componentWillUnmount",value:function(){void 0!==this.props.selection&&this.props.selection.clear()}}]),n}(o.Component);Cn.propTypes={hasMore:yt.a.bool.isRequired,fetchMore:yt.a.func.isRequired,album:yt.a.object.isRequired,shareAlbum:yt.a.func,photos:yt.a.array.isRequired,t:yt.a.func.isRequired,navigate:yt.a.func.isRequired,lastFetch:yt.a.number};var An=Je()(Object(l.connect)(null,(function(e){return{shareAlbum:function(t){return e(Object(ae.d)(i.a.createElement(yn.a,{document:t,sharingDesc:t.name})))}}})),p.withClient,Object(b.translate)())((function(e){var t=Object(Oe.m)().pathname,n=Object(Oe.o)();return i.a.createElement(Cn,mt()({},e,{navigate:n,pathname:t}))})),Sn=n("C/eS"),Pn=n.n(Sn);function zn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var Rn=function(e){N()(n,e);var t=zn(n);function n(e){var r;return S()(this,n),r=t.call(this,e),a()(D()(r),"onNameChange",(function(e){r.setState({name:e.target.value})})),a()(D()(r),"onCancel",(function(){r.props.navigate(-1)})),a()(D()(r),"onCreate",(function(e){var t=r.state.name;r.props.createAlbum(t,e).then((function(e){return r.props.navigate("/albums/".concat(e.id))})).catch((function(){r.input.focus(),r.input.select()}))})),a()(D()(r),"onUpdate",(function(e){var t=r.props.album;r.props.addPhotos(t,e).then((function(){return r.props.navigate("/albums/".concat(t.id))}))})),r.state={name:e.t("Albums.create.panel_form.placeholder")},r}return z()(n,[{key:"componentDidMount",value:function(){this.props.album||(this.input.focus(),this.input.select())}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.album,a=this.state.name,o=!r;return i.a.createElement(On.a,null,(function(t,c,l){return i.a.createElement("div",{className:Pn.a["pho-panel"]},i.a.createElement("div",{className:Pn.a["pho-panel-form"]},i.a.createElement("header",{className:Pn.a["pho-panel-header"]},i.a.createElement("div",{className:Pn.a["pho-panel-wrap"]},o&&i.a.createElement("div",null,i.a.createElement("label",{className:Pn.a["coz-form-label"]},n("Albums.create.panel_form.label")),i.a.createElement("input",{"data-testid":"input-album-name",type:"text",ref:function(t){e.input=t},value:a,onChange:e.onNameChange})),!o&&i.a.createElement("h3",{"data-testid":"pho-picker-album-name"},r.name))),i.a.createElement("div",{className:Pn.a["pho-panel-content"]},i.a.createElement("div",{"data-testid":"picker-panel",className:Pn.a["pho-panel-wrap"]},i.a.createElement(Ur,{selected:t,showSelection:!0,selection:l}))),i.a.createElement("footer",{className:Pn.a["pho-panel-footer"]},i.a.createElement("div",{className:Pn.a["pho-panel-wrap"]},i.a.createElement("div",{className:Pn.a["pho-panel-controls"]},i.a.createElement(Xe.a,{theme:"secondary",onClick:e.onCancel,label:n("Albums.create.panel_form.cancel")}),i.a.createElement(Xe.a,{"data-testid":"validate-album",onClick:function(){return o?e.onCreate(t):e.onUpdate(t)},label:n(o?"Albums.create.panel_form.submit":"Albums.create.panel_form.update")}))))))}))}}]),n}(o.Component),Dn=Object(b.translate)()((function(e){var t=Object(Oe.o)();return i.a.createElement(Rn,mt()({},e,{navigate:t}))})),Tn=n("D575"),Nn=n.n(Tn),qn=n("qFRD"),Mn=n("MSWZ"),In=n("luXY"),Un=n.n(In);function Ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var Fn=function(e){N()(n,e);var t=Ln(n);function n(){var e;return S()(this,n),(e=t.call(this)).state={name:"",isSubmitDisabled:!0,isBusy:!1,hasError:!1},e}return z()(n,[{key:"reset",value:function(){this.setState({name:"",isSubmitDisabled:!0,isBusy:!1,hasError:!1})}},{key:"onSubmit",value:function(e,t){var n=this;return e.preventDefault(),this.setState({isBusy:!0}),t(this.state.name).then((function(){return n.reset()}),(function(){return n.setState({hasError:!0,isBusy:!1})}))}},{key:"onNameChange",value:function(e){var t=e.target.value;this.setState({name:t,isSubmitDisabled:!t.trim().length,hasError:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.onSubmitNewAlbum;return i.a.createElement("form",{className:Un.a["pho-create-album-form"],onSubmit:function(t){return e.onSubmit(t,r)}},i.a.createElement("label",{className:Un.a["coz-create-album-label"]},n("Albums.create.inline_form.create_label")),i.a.createElement("div",{className:Un.a["coz-inline-form"]},i.a.createElement("input",{className:F()(Un.a["coz-input-text"],this.state.hasError&&Un.a.error),type:"text",name:"album-name",onInput:function(t){return e.onNameChange(t)},disabled:this.state.isBusy,placeholder:n("Albums.create.inline_form.placeholder"),value:this.state.name}),i.a.createElement(Xe.a,{className:Un.a["create-button"],disabled:this.state.isSubmitDisabled||this.state.isBusy,"aria-busy":this.state.isBusy,label:n("Albums.create.inline_form.create_button")})))}}]),n}(o.Component),Bn=Object(b.translate)()(Fn),Yn=void 0,Gn=function(e){return 0===e.albums.data.length?i.a.createElement(en.a,{localeKey:"albums"}):i.a.createElement("div",{className:F()($t.a["pho-album-list"],$t.a["pho-album-list--thumbnails"],$t.a["pho-album-list--selectable"])},e.albums.data.map((function(t){return i.a.createElement(un,{album:t,key:t.id,thumbnail:!0,onServerError:e.onServerError,onClick:e.onSubmitSelectedAlbum})})))},Wn=Object(fn.b)((function(e){return e.error}),"albums",(function(e){return i.a.createElement("div",null,i.a.createElement(Gn,e))})),Vn=function(e){if(!e.albums)return null;var t="failed"===e.albums.fetchStatus;return i.a.createElement(Wn,mt()({error:t,onServerError:function(){return Yn.handleError(t)}},e))};function Qn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var Hn=function(e){N()(n,e);var t=Qn(n);function n(){return S()(this,n),t.apply(this,arguments)}return z()(n,[{key:"render",value:function(){var e=this.props,t=e.t,n=e.photos,r=e.data,a=e.fetchStatus,o=e.createAlbum,c=e.addPhotos,l=e.onDismiss,s=e.onSuccess,u=void 0===s?function(){}:s,d="pending"===a||"loading"===a;return i.a.createElement(qn.a,{open:!0,onClose:l,title:t("Albums.add_photos.title"),content:i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement(Bn,{onSubmitNewAlbum:function(e){return o(e,n).then(l).then(u)}}),i.a.createElement(Mn.a,{className:"u-ml-0 u-maw-100 u-mt-1"}),d&&i.a.createElement(mn.a,{loadingType:"albums_fetching"}),!d&&r&&r.length>0&&i.a.createElement("div",{className:F()(Nn.a["coz-select-album"])},i.a.createElement(Vn,{albums:{data:r,fetchStatus:a},onSubmitSelectedAlbum:function(e){return c(e,n).then(l).then(u)}}))))})}}]),n}(o.Component),Zn=Object(b.translate)()(Hn),Jn=n("GoJ1"),Kn=n("aR52"),Xn=n("7Zso"),$n=function(){var e=Object(b.useI18n)().t,t=Object(Oe.o)();return i.a.createElement(Jn.a,{title:e("Error.generic"),icon:Xn.a},i.a.createElement(Kn.a,{onClick:function(){t("/")},label:e("Error.back_homepage")}))},er=n("A5W6");function tr(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rr=function(e){return e.find(g.a,{created_at:{$gt:null}}).where({auto:{$exists:!1}}).indexFields(["created_at"]).include(["photos"]).sortBy([{created_at:"desc"}])},ar=function(){var e=O()(E.a.mark((function e(t,n){var r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.photos.data.length,e.next=4,t.photos.addById(n.map((function(e){return e._id})));case 4:a=t.photos.data.length,r+n.length!==a?C.a.info("Alerter.photos.already_added_photo"):C.a.success("Albums.add_photos.success",{name:t.name,smart_count:n.length}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C.a.error("Albums.add_photos.error.reference");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),or=function(e){return{updateAlbum:(n=O()(E.a.mark((function t(n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.collection(g.a).checkUniquenessOf("name",n.name);case 2:if(!0===t.sent){t.next=8;break}return C.a.error("Albums.create.error.already_exists",{name:name}),t.abrupt("return");case 8:return t.abrupt("return",e.save(n));case 9:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)}),deleteAlbum:function(t){return e.destroy(t)},addPhotos:ar,removePhotos:(t=O()(E.a.mark((function e(t,n,r){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.photos.removeById(n.map((function(e){return e._id})));case 3:C.a.success("Albums.remove_photos.success",{album_name:t.name}),r(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),C.a.error("Albums.remove_photos.error.generic");case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e,n,r){return t.apply(this,arguments)})};var t,n},ir=function(e){return{addPhotos:ar,createAlbum:(t=O()(E.a.mark((function t(n,r){var a,o,i,c=arguments;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=c.length>2&&void 0!==c[2]?c[2]:new Date,t.prev=1,n){t.next=5;break}return C.a.error("Albums.create.error.name_missing"),t.abrupt("return");case 5:return o={_type:g.a,name:n,created_at:a},t.next=8,e.collection(g.a).checkUniquenessOf("name",o.name);case 8:if(!0===t.sent){t.next=12;break}return C.a.error("Albums.create.error.already_exists",{name:n}),t.abrupt("return");case 12:return t.next=14,e.create(g.a,o,{photos:r},{updateQueries:{albums:function(e,t){return[t.data].concat(x()(e))}}});case 14:return i=t.sent,C.a.success("Albums.create.success",{name:o.name,smart_count:r.length}),t.abrupt("return",i.data);case 19:t.prev=19,t.t0=t.catch(1),C.a.error("Albums.create.error.generic");case 22:case"end":return t.stop()}}),t,null,[[1,19]])}))),function(e,n){return t.apply(this,arguments)})};var t},cr=function(e){return i.a.createElement(p.Query,{query:rr},(function(t){return i.a.createElement(bn,mt()({albums:t},e))}))},lr=function(e){return i.a.createElement(p.Query,{query:rr,as:"albums",mutations:ir},(function(t,n){var r=n.createAlbum,a=n.addPhotos;return i.a.createElement(Zn,mt()({},t,{createAlbum:r,addPhotos:a},e))}))},sr=function(e){var t,n,r=Object(Oe.q)().albumId,a=Object(er.a)(r);return i.a.createElement(p.Query,mt()({query:a.definition,as:a.as},e,{mutations:or}),(t={children:e.children},n=t.children,function(e,t){var r=e.data,a=e.fetchStatus,o=e.lastFetch,c=t.updateAlbum,l=t.deleteAlbum,s=t.removePhotos;return r&&"loaded"===a?i.a.createElement(An,{album:r,photos:r.photos.data,updateAlbum:c,deleteAlbum:l,removePhotos:s,hasMore:void 0!==r.photos.hasMore,fetchMore:r.photos.fetchMore.bind(r.photos),lastFetch:o},n):"failed"===a?i.a.createElement($n,null):i.a.createElement(mn.a,{size:"xxlarge",loadingType:"photos_fetching",middle:!0})}))},ur=Object(p.withMutations)(ir)(Dn),dr=function(e){var t=mt()({},e),n=Object(Oe.q)().albumId;if(n){var r=Object(er.a)(n);return i.a.createElement(p.Query,mt()({query:r.definition,as:r.as,mutations:ir},t),(function(e,t){var n=e.data,r=t.addPhotos;return i.a.createElement(Dn,{album:n,addPhotos:r})}))}return i.a.createElement(ur,null)},pr=function(e){if(!e)return!1;var t,n=tr(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.relationships&&r.relationships.referenced_by&&r.relationships.referenced_by.data&&r.relationships.referenced_by.data.length>0){var a,o=tr(r.relationships.referenced_by.data);try{for(o.s();!(a=o.n()).done;){if(a.value.type===g.a)return!0}}catch(i){o.e(i)}finally{o.f()}}}}catch(i){n.e(i)}finally{n.f()}return!1},mr="".concat(g.b,"/photos"),fr="".concat(g.b,"/photos/upload"),hr=("".concat(g.b,"/photos/mobile"),function(){var e=O()(E.a.mark((function e(t,n){var r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.collection(g.c).findReferencedBy({_type:g.b,_id:n});case 2:return r=e.sent,a=r.included,e.abrupt("return",a.filter((function(e){return!1===/^\/\.cozy_trash/.test(e.attributes.path)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),br=function(){var e=O()(E.a.mark((function e(t,n,r){var a,o,i,c,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hr(t,r);case 2:if(!(a=e.sent).length){e.next=7;break}return e.abrupt("return",a[0]);case 7:return o=t.collection(g.c),e.next=10,o.ensureDirectoryExists(n);case 10:return i=e.sent,e.next=13,o.addReferencesTo({_id:r,_type:g.b},[{_id:i}]);case 13:return e.next=15,o.get(i);case 15:return c=e.sent,l=c.data,e.abrupt("return",l);case 18:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U()(e);if(t){var a=U()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M()(this,n)}}var _r=function(){var e=O()(E.a.mark((function e(t,n){var r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hr(t,fr);case 2:if(!((r=e.sent).length>0)){e.next=7;break}return e.abrupt("return",r[0]._id);case 7:return e.next=9,br(t,"/".concat(n("UploadQueue.path_photos")),mr);case 9:return e.next=11,br(t,"/".concat(n("UploadQueue.path_photos"),"/").concat(n("UploadQueue.path_upload")),fr);case 11:return a=e.sent,e.abrupt("return",a._id);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Er=function(e){N()(n,e);var t=gr(n);function n(){var e;S()(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),a()(D()(e),"state",{showAddAlbumModal:!1}),a()(D()(e),"showAddAlbumModal",(function(){e.setState((function(e){return vr(vr({},e),{},{showAddAlbumModal:!0})}))})),a()(D()(e),"hideAddAlbumModal",(function(){e.setState((function(e){return vr(vr({},e),{},{showAddAlbumModal:!1})}))})),a()(D()(e),"uploadPhotos",function(){var t=O()(E.a.mark((function t(n){var r,a,o,i,c;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.uploadPhoto,a=e.props,o=a.client,i=a.t,t.next=4,_r(o,i);case 4:c=t.sent,e.dispatch(pe(n,(function(e){return r(e,c)})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),a()(D()(e),"downloadPhotos",(function(t){e.props.client.collection("io.cozy.files").downloadArchive(t.map((function(e){return e._id})),"selected")})),a()(D()(e),"closeModal",(function(){e.setState({displayModal:!1,selected:null,clearSelection:null})})),a()(D()(e),"showDeleteConfirm",(function(){var t=e.state,n=t.selected,r=t.clearSelection;return i.a.createElement(Ht,{t:e.props.t,count:n.length,related:pr(n),onClose:e.closeModal,confirm:O()(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.map((function(t){return e.props.deletePhoto(t)}))).then(r);case 2:e.closeModal();case 3:case"end":return t.stop()}}),t)})))})})),a()(D()(e),"deletePhotos",(function(t,n){e.setState({displayModal:!0,selected:t,clearSelection:n})})),e}return z()(n,[{key:"dispatch",value:function(e){return this.context.store.dispatch(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.lists,a=t.fetchStatus,o=t.hasMore,c=t.fetchMore,l=t.lastFetch;return i.a.createElement(On.a,{actions:function(t){return{"album-add":e.showAddAlbumModal,download:e.downloadPhotos,trash:function(n){return e.deletePhotos(n,t.clear)}}}},(function(t,s,u){return i.a.createElement("div",{"data-testid":"timeline-pho-content-wrapper",className:st.a["pho-content-wrapper"]},i.a.createElement(qt,{viewName:"photos"},i.a.createElement(Gt,{disabled:s,uploadPhotos:e.uploadPhotos,selectItems:u.show,t:n})),i.a.createElement(ke.a,null,e.state.displayModal&&e.showDeleteConfirm(),e.state.showAddAlbumModal&&i.a.createElement(lr,{onDismiss:e.hideAddAlbumModal,onSuccess:u.clear,photos:t}),i.a.createElement(Zt.a,{lists:r,selected:t,photosContext:"timeline",showSelection:s,onPhotoToggle:u.toggle,onPhotosSelect:u.select,onPhotosUnselect:u.unselect,fetchStatus:a,hasMore:o,fetchMore:c,lastFetch:l})),i.a.createElement(Oe.b,null))}))}}]),n}(o.Component);a()(Er,"contextTypes",{store:yt.a.object.isRequired});var wr=Object(b.translate)()(Object(p.withClient)(Er)),Or=n("NAv5"),jr=function(e,t,n){var r=t.substr(0,10).split("-"),a=St()(r,3),o=a[0],i=a[1],c=a[2],l=t.length>10?t.substr(11,8).split(":"):[0,0,0],s=St()(l,3),u=s[0],d=s[1],p=s[2];return e(new Date(o,i-1,c,u,d,p),n)},xr=function(e,t){return jr(e,t,"HH")},kr=function(e,t){return jr(e,t,"DD MMMM")+Cr(e,t)},Cr=function(e,t){return Object(Or.isThisYear)(t)?"":jr(e,t," YYYY")},Ar=function(e,t,n){var r=jr(e,t),a=jr(e,n);return 0===Object(Or.differenceInCalendarDays)(r,a)},Sr=["data"],Pr=["selection"],zr=["data"],Rr=function(e){return e.find("io.cozy.files").where({class:"image","metadata.datetime":{$gt:null}}).partialIndex({trashed:!1}).indexFields(["class","metadata.datetime"]).select(["dir_id","name","size","updated_at","metadata","metadata.datetime","trashed","class"]).sortBy([{class:"desc"},{"metadata.datetime":"desc"}]).include(["albums"])},Dr=function(e){return{uploadPhoto:(t=O()(E.a.mark((function t(n,r){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.mutate({mutationType:"UPLOAD_PHOTO",execute:function(){var t=O()(E.a.mark((function t(){var a,o,i;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.chrome){t.next=10;break}return t.next=3,e.getStackClient().fetchJSON("GET","/settings/disk-usage");case 3:if(a=t.sent,!(o=a.data).attributes.quota){t.next=10;break}if(!(parseInt(o.attributes.used)+parseInt(n.size)>parseInt(o.attributes.quota))){t.next=10;break}throw(i=new Error("Payload Too Large")).status=413,i;case 10:return t.abrupt("return",e.collection("io.cozy.files").createFile(n,{dirId:r}));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}));case 1:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)}),deletePhoto:function(t){return e.destroy(t)}};var t},Tr=function(e,t){if(e.period){var n=e.period.start,r=e.period.end;return function(e,t,n){var r=jr(e,t),a=jr(e,n);return 0===Object(Or.differenceInCalendarMonths)(r,a)}(t,r,n)?Ar(t,r,n)?kr(t,n):function(e,t){return jr(e,t,"DD")}(t,n)+"-"+kr(t,r):kr(t,n)+" - "+kr(t,r)}return kr(t,e.name)},Nr=function(e,t,n,r){if(n.album&&(t>0&&Ar(r,e[t-1],e[t])||t<e.length-1&&Ar(r,e[t],e[t+1]))){var a=n.album.period.start,o=n.album.period.end,i=n.title+" · "+xr(r,a)+"h";return function(e,t,n){var r=jr(e,t),a=jr(e,n);return 0===Object(Or.differenceInHours)(r,a)}(r,o,a)||(i+="-"+xr(r,o)+"h"),i}return n.title},qr=function(e,t,n){return Object.keys(e).find((function(r){if(e[r].album){var a=e[r].album.period.start,o=e[r].album.period.end;return(i=t,c=a,Object(Or.compareAsc)(i,c)>=0&&function(e,t){return Object(Or.compareAsc)(e,t)<=0}(t,o))||Ar(n,t,o)}return Ar(n,t,r);var i,c}))},Mr=function(e,t){var n={},r=[];e.forEach((function(e){var a=(e.albums?e.albums.data:[]).find((function(e){return e.auto}));if(a){var o=a.name;if(!n.hasOwnProperty(o)){var i=Tr(a,t);n[o]={photos:[],title:i,album:a}}n[o].photos.push(e)}else r.push(e)})),r.forEach((function(e){var r=e.metadata&&e.metadata.datetime?e.metadata.datetime:e.created_at,a=qr(n,r,t);if(a)n[a].photos.push(e);else{var o=function(e,t){return jr(e,t,"YYYY-MM-DD")}(t,r);n[o]={title:kr(t,r),photos:[e]}}}));var a=Object.keys(n);return a.sort((function(e,t){return new Date(t).getTime()-new Date(e).getTime()})),a.map((function(e,r){return{title:Nr(a,r,n[e],t),photos:n[e].photos}}))},Ir=Object(b.translate)()((function(e){return i.a.createElement(p.Query,{query:Rr,as:"timeline",mutations:Dr},(function(t,n){var r=t.data,a=ht()(t,Sr);return i.a.createElement(wr,mt()({lists:r?Mr(r,e.f):[],data:r},n,a,e))}))})),Ur=Object(b.translate)()((function(e){var t=e.selection,n=ht()(e,Pr);return i.a.createElement(p.Query,{query:Rr},(function(e){var r=e.data,a=ht()(e,zr);return i.a.createElement(Zt.a,mt()({lists:r?Mr(r,n.f):[],photosContext:"timeline",onPhotoToggle:t.toggle,onPhotosSelect:t.select,onPhotosUnselect:t.unselect},a,n))}))})),Lr=n("cwrA");function Fr(){return i.a.createElement(Oe.a,{to:"photos",replace:!0})}var Br=Object(je.d)([{element:i.a.createElement(dt,null),children:[{path:"/*",element:i.a.createElement(Oe.a,{to:"photos",replace:!0})},{path:"photos",element:i.a.createElement(Ir,null),children:[{path:":photoId",element:i.a.createElement(Lr.b,null),errorElement:i.a.createElement(Fr,null)}]},{path:"albums",children:[{path:"",element:i.a.createElement(cr,null)},{path:"new",element:i.a.createElement(dr,null)},{path:":albumId",element:i.a.createElement(sr,null),errorElement:i.a.createElement(Fr,null),children:[{path:"edit",element:i.a.createElement(dr,null)},{path:":photoId",element:i.a.createElement(Lr.a,null),errorElement:i.a.createElement(Fr,null)}]}]}]}]),Yr=function(){return i.a.createElement(Oe.e,{router:Br,fallbackElement:i.a.createElement(B.b,null)})},Gr=n("dBw4"),Wr=n("44Ds"),Vr=n.n(Wr),Qr=n("qxHO"),Hr=n("yZiV"),Zr=n("NqoY");function Jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jr(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xr=Object(d.createLogger)(),$r=Vr()((function(){var e=document.querySelector("[role=application]"),t=JSON.parse(e.dataset.cozy),n=document.documentElement.getAttribute("lang")||"en",r=window.location?window.location.protocol:"https:",a="".concat(r,"//").concat(t.domain),o=new m.a({uri:a,token:t.token,appMetadata:Hr.a,schema:Zr.a,store:!1});o.registerPlugin(f.RealtimePlugin),cozy.client.init({cozyURL:a,token:t.token}),Object(Qr.a)(),Object(Qr.b)(a);var i=[u.default,Xr],c=s.compose,l=Object(s.createStore)(Object(s.combineReducers)(Kr(Kr({},we),{},{cozy:o.reducer()})),c(s.applyMiddleware.apply(void 0,i)));o.setStore(l);var d=t.locale;return Ot.a.init({appName:t.app.name,appEditor:t.app.editor,cozyClient:o,iconPath:t.app.icon,lang:n,replaceTitleOnMobile:!0,appSlug:t.app.slug,appNamePrefix:t.app.prefix}),{store:l,locale:d,client:o,root:e}})),ea=function(e){return i.a.createElement(v.WebviewIntentProvider,{setBarContext:Ot.a.setWebviewContext},i.a.createElement(l.Provider,{store:e.store},i.a.createElement(b.I18n,{lang:e.locale,dictRequire:function(e){return n("Gofk")("./".concat(e))}},i.a.createElement(p.CozyProvider,{client:e.client},i.a.createElement(h.a,null,i.a.createElement(Gr.a,null,i.a.createElement(y.a,{doctype:g.a,documentType:"Albums"},e.children)))))))},ta=function(e){return i.a.createElement(ea,e,i.a.createElement(Yr,null))};document.addEventListener("DOMContentLoaded",(function(){var e,t,n,r,a;e=$r(),t=e.store,n=e.locale,r=e.client,a=e.root,Object(c.render)(i.a.createElement(ta,{store:t,locale:n,client:r}),a)}))},"q/Uw":function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var r=n("lwsE"),a=n.n(r),o=n("W8MJ"),i=n.n(o),c=n("PJYZ"),l=n.n(c),s=n("7W2i"),u=n.n(s),d=n("a1gu"),p=n.n(d),m=n("Nsbk"),f=n.n(m),h=n("lSNA"),b=n.n(h),y=n("RIqP"),v=n.n(y),g=n("q1tI"),_=n.n(g),E=n("+MCZ");function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var x=_.a.createContext([]),k=function(e,t){return{type:t?"UNSELECT_ITEM":"SELECT_ITEM",item:e}},C=function(e){return{type:"ADD_TO_SELECTION",items:e}},A=function(e){return{type:"REMOVE_FROM_SELECTION",items:e}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.meta&&t.meta.cancelSelection)return[];switch(t.type){case"SELECT_ITEM":return[].concat(v()(e),[t.item]);case"UNSELECT_ITEM":return e.filter((function(e){return e._id!==t.item.id}));case"ADD_TO_SELECTION":var n=e.map((function(e){return e._id})),r=t.items.filter((function(e){return-1===n.indexOf(e._id)}));return[].concat(v()(e),v()(r));case"REMOVE_FROM_SELECTION":var a=t.items.map((function(e){return e._id}));return e.filter((function(e){return-1===a.indexOf(e._id)}));case"HIDE_SELECTION_BAR":return[];default:return e}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(t.meta&&t.meta.cancelSelection)return!1;switch(t.type){case"TOGGLE_SELECTION_BAR":return!e;case"SHOW_SELECTION_BAR":return!0;case"HIDE_SELECTION_BAR":return!1;default:return e}},z=function(e){u()(n,e);var t=j(n);function n(){var e;a()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),b()(l()(e),"state",{selected:S(void 0,{}),opened:P(void 0,{})}),b()(l()(e),"toggle",(function(t,n){return e.dispatch(k(t,n))})),b()(l()(e),"select",(function(t){return e.dispatch(C(t))})),b()(l()(e),"unselect",(function(t){return e.dispatch(A(t))})),b()(l()(e),"clear",(function(){return e.dispatch({type:"HIDE_SELECTION_BAR"})})),b()(l()(e),"show",(function(){return e.dispatch({type:"SHOW_SELECTION_BAR"})})),e}return i()(n,[{key:"dispatch",value:function(e){this.setState((function(t){return O(O({},t),{},{selected:S(t.selected,e),opened:P(t.opened,e)})}))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.actions,r=void 0===n?{}:n,a=this.state,o=a.selected,i=a.opened,c=0!==o.length||i,l={toggle:this.toggle,select:this.select,unselect:this.unselect,clear:this.clear,show:this.show},s="function"==typeof r?r(l):r,u={};Object.keys(s).map((function(e){u[e]="function"==typeof s[e]?{action:s[e]}:s[e]}));var d=Object.keys(u).length>0;return _.a.createElement(x.Provider,{value:o},_.a.createElement("div",null,c&&d&&_.a.createElement(E.a,{selected:o,hideSelectionBar:this.clear,actions:u}),t(o,c,l)))}}]),n}(g.Component);x.Consumer},qxHO:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return b}));var r=n("lSNA"),a=n.n(r),o=n("NlKi"),i=n.n(o),c=n("XA+M"),l=n.n(c),s={slug:l.a.slug,version:l.a.version,name:l.a.name,prefix:l.a.name_prefix};n("OTOu");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p="undefined"==typeof __SENTRY_URL__?"":__SENTRY_URL__,m=function(e,t){return e.replace(/^file:\/\//,"app://").replace(t,"")},f=function(e){var t=/^.*\/[^.]+(\.app|CodePush|.*(?=\/))/;e.culprit&&(e.culprit=m(e.culprit,t));var n=e.stacktrace||e.exception&&e.exception.values&&e.exception.values[0]&&e.exception.values[0].stacktrace;return n&&(n.frames=n.frames.map((function(e){return"[native code]"!==e.filename?d(d({},e),{},{filename:m(e.filename,t)}):e}))),e},h=function(){i.a.config(p,{shouldSendCallback:!0,environment:"production",release:s.version,allowSecretKey:!0,dataCallback:f}).install()},b=function(e){i.a.setTagsContext({instance:e})}},swni:function(e,t,n){e.exports={"u-visuallyhidden":"u-visuallyhidden--1L4hk","dri-btn--more":"dri-btn--more--MNdqs"}},t0Aa:function(e,t,n){e.exports={"CozyTheme--inverted":"CozyTheme--inverted--1w1h7","CozyTheme--normal":"CozyTheme--normal--3wr-Z","c-btn":"c-btn--1VDiR","c-btn--regular":"c-btn--regular--1AoRN","c-btn--danger":"c-btn--danger--2NNcc","c-btn--secondary":"c-btn--secondary--3znY5","c-btn--danger-outline":"c-btn--danger-outline--mVde8","pho-toolbar":"pho-toolbar--28WqL","fil-toolbar-menu-recipients":"fil-toolbar-menu-recipients--3uaZB",spin:"spin--GHUiz",shake:"shake--3TZHV"}},u0ID:function(e,t){e.exports={name:"Photos",name_prefix:"Cozy",slug:"photos",version:"1.55.0",type:"webapp",licence:"AGPL-3.0",icon:"public/app-icon.svg",categories:["cozy"],source:"https://github.com/cozy/cozy-drive",editor:"Cozy",developer:{name:"Cozy Cloud",url:"https://cozy.io"},langs:["en","fr"],locales:{fr:{short_description:"Cozy Photos est l’application de visualisation et gestion de vos photos sur Cozy.",long_description:"Avec Cozy Photos vous pourrez :\n- Visualiser toutes les photos présentes dans votre Cozy, classées par date;\n- Organisez vos photos en albums;\n- Partager vos albums avec qui vous le souhaitez.",screenshots:["screenshots/fr/screenshot01.jpg","screenshots/fr/screenshot02.jpg","screenshots/fr/screenshot03.jpg"]},en:{short_description:"Cozy Photos allows you to view and manage your photos on your Cozy",long_description:"With Cozy Photos, you can:\n- Get a timeline of all your memories\n- Organize your photos through albums\n- Share albums with just a link",screenshots:["screenshots/en/screenshot01.jpg","screenshots/en/screenshot02.jpg","screenshots/en/screenshot03.jpg"]}},screenshots:["screenshots/fr/screenshot01.jpg","screenshots/fr/screenshot02.jpg","screenshots/fr/screenshot03.jpg"],routes:{"/":{folder:"/",index:"index.html",public:!1},"/public":{folder:"/public",index:"index.html",public:!0}},services:{onPhotoUpload:{type:"node",file:"services/onPhotoUpload/photos.js",trigger:"@event io.cozy.files:CREATED:image:class",debounce:"5m"}},permissions:{files:{description:"Required for photo access",type:"io.cozy.files",verbs:["GET","POST","PUT","PATCH"]},apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET","PUT"]},albums:{description:"Required to manage photos albums",type:"io.cozy.photos.albums",verbs:["GET","POST","PUT","DELETE","PATCH"]},photos_settings:{description:"Required to manage photos albums settings",type:"io.cozy.photos.settings",verbs:["GET","POST","PUT"]},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]},oauth:{description:"Required to display the cozy-desktop banner",type:"io.cozy.oauth.clients",verbs:["GET"]},errorsreporting:{description:"Allow to report unexpected errors to the support team",type:"cc.cozycloud.errors",verbs:["POST"]},triggers:{description:"Required to re-execute the clustering",type:"io.cozy.triggers",verbs:["POST"],selector:"worker",values:["service"]},triggersviewer:{description:"Required to display the konnector block status",type:"io.cozy.triggers",verbs:["GET"]},konnectors:{description:"Required to display the information of the konnector that retrieved the photos",type:"io.cozy.konnectors",verbs:["GET"]}}}},yZiV:function(e,t,n){"use strict";var r=n("u0ID"),a=n.n(r),o={slug:a.a.slug,version:a.a.version};t.a=o},z6Q1:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s}));var r=n("lSNA"),a=n.n(r),o=n("OjRq");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var c="io.cozy.files",l="io.cozy.photos.albums",s="io.cozy.apps";!function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}}({files:{doctype:c,relationships:{old_versions:{type:"has-many",doctype:"io.cozy.files.versions"},encryption:{type:"io.cozy.files:has-many",doctype:"io.cozy.files.encryption"}}},contacts:{doctype:o.a.doctype,doctypeVersion:2},groups:{doctype:o.c.doctype},versions:{doctype:"io.cozy.files.versions"}},{})},zB5G:function(e,t,n){"use strict";n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"b",(function(){return E})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return x})),n.d(t,"d",(function(){return k})),n.d(t,"a",(function(){return A})),n.d(t,"i",(function(){return z}));var r=n("pVnL"),a=n.n(r),o=n("q1tI"),i=n.n(o),c=n("buk/"),l=n("y6ex"),s=n("aN1g"),u=n("vEVt"),d=n("94Ho"),p=n("YJMV"),m=function(e){return function(){return{name:"newAlbum",action:function(){return e("/albums/new")},Component:Object(o.forwardRef)((function(e,t){var n=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},e,{ref:t}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:p.a})),i.a.createElement(u.default,{primary:n("Toolbar.album_new")}))}))}}},f=n("sbrb"),h=function(e,t){return function(){return{name:"download",action:e,Component:Object(o.forwardRef)((function(e,n){return i.a.createElement(d.a,a()({},e,{ref:n}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:f.a})),i.a.createElement(u.default,{primary:t}))}))}}},b=n("AJ6E"),y=n("fmf2"),v=n("lXO7"),g=function(e,t){return function(){return{name:"shareAlbum",action:function(){return e(t)},Component:Object(o.forwardRef)((function(e,n){var r=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},e,{ref:n}),i.a.createElement(b.a,{docId:t.id},(function(e){var t=e.isSharedWithMe,n=e.recipients,a=e.link;return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:v.a})),i.a.createElement(u.default,{primary:r(t?"Albums.share.sharedWithMe":"Albums.share.cta")}),i.a.createElement(s.a,null,i.a.createElement(y.a,{recipients:n,link:a,size:"small"})))})))}))}}},_=n("46CF"),E=function(e){return function(){return{name:"deleteAlbum",action:e,Component:Object(o.forwardRef)((function(e,t){var n=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},e,{ref:t,className:"u-pomegranate"}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:_.a,color:"var(--pomegranate)"})),i.a.createElement(u.default,{primary:n("Toolbar.menu.album_delete")}))}))}}},w=n("9gqn"),O=function(e){return function(){return{name:"selectItems",action:e,Component:Object(o.forwardRef)((function(e,t){var n=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},e,{ref:t}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:w.a})),i.a.createElement(u.default,{primary:n("Toolbar.menu.select_items")}))}))}}},j=n("Tgut"),x=function(e){return function(){return{name:"renameAlbum",action:e,Component:Object(o.forwardRef)((function(e,t){var n=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},e,{ref:t}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:j.a})),i.a.createElement(u.default,{primary:n("Toolbar.menu.rename_album")}))}))}}},k=function(e){return function(){return{name:"editAlbum",action:function(){return e("./edit")},Component:Object(o.forwardRef)((function(e,t){var n=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},e,{ref:t}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:p.a})),i.a.createElement(u.default,{primary:n("Toolbar.menu.add_photos")}))}))}}},C=n("g4Do"),A=function(){return{name:"createCozy",action:function(){return window.location="https://manager.cozycloud.cc/cozy/create"},Component:Object(o.forwardRef)((function(e,t){var n=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},e,{ref:t}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:C.a})),i.a.createElement(u.default,{primary:n("Share.create-cozy")}))}))}},S=n("1soK"),P=n("nEYx"),z=function(e,t){return function(){return{name:"upload",action:function(e){return e.stopPropagation()},Component:Object(o.forwardRef)((function(n,r){var o=Object(c.useI18n)().t;return i.a.createElement(d.a,a()({},n,{ref:r}),i.a.createElement(s.a,null,i.a.createElement(l.default,{icon:S.a})),i.a.createElement(P.a,{onUpload:e,disabled:t,label:o("Toolbar.menu.photo_upload"),inMenu:!0}))}))}}}}});